import{c as Ka,g as Ma,d as qa,e as nt,A as it,f as st}from"./index-PtYIsaun.js";var Rt,Tr;function fe(){return Tr||(Tr=1,Rt={options:{usePureJavaScript:!1}}),Rt}var wt={exports:{}},Lt,Ir;function Ha(){if(Ir)return Lt;Ir=1;var n={};Lt=n;var e={};n.encode=function(d,_,S){if(typeof _!="string")throw new TypeError('"alphabet" must be a string.');if(S!==void 0&&typeof S!="number")throw new TypeError('"maxline" must be a number.');var h="";if(!(d instanceof Uint8Array))h=a(d,_);else{var t=0,g=_.length,l=_.charAt(0),x=[0];for(t=0;t<d.length;++t){for(var k=0,E=d[t];k<x.length;++k)E+=x[k]<<8,x[k]=E%g,E=E/g|0;for(;E>0;)x.push(E%g),E=E/g|0}for(t=0;d[t]===0&&t<d.length-1;++t)h+=l;for(t=x.length-1;t>=0;--t)h+=_[x[t]]}if(S){var u=new RegExp(".{1,"+S+"}","g");h=h.match(u).join(`\r
`)}return h},n.decode=function(d,_){if(typeof d!="string")throw new TypeError('"input" must be a string.');if(typeof _!="string")throw new TypeError('"alphabet" must be a string.');var S=e[_];if(!S){S=e[_]=[];for(var h=0;h<_.length;++h)S[_.charCodeAt(h)]=h}d=d.replace(/\s/g,"");for(var t=_.length,g=_.charAt(0),l=[0],h=0;h<d.length;h++){var x=S[d.charCodeAt(h)];if(x===void 0)return;for(var k=0,E=x;k<l.length;++k)E+=l[k]*t,l[k]=E&255,E>>=8;for(;E>0;)l.push(E&255),E>>=8}for(var u=0;d[u]===g&&u<d.length-1;++u)l.push(0);return typeof Buffer<"u"?Buffer.from(l.reverse()):new Uint8Array(l.reverse())};function a(d,_){var S=0,h=_.length,t=_.charAt(0),g=[0];for(S=0;S<d.length();++S){for(var l=0,x=d.at(S);l<g.length;++l)x+=g[l]<<8,g[l]=x%h,x=x/h|0;for(;x>0;)g.push(x%h),x=x/h|0}var k="";for(S=0;d.at(S)===0&&S<d.length()-1;++S)k+=t;for(S=g.length-1;S>=0;--S)k+=_[g[S]];return k}return Lt}var Ar;function pe(){if(Ar)return wt.exports;Ar=1;var n=fe(),e=Ha(),a=wt.exports=n.util=n.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){a.nextTick=process.nextTick,typeof setImmediate=="function"?a.setImmediate=setImmediate:a.setImmediate=a.nextTick;return}if(typeof setImmediate=="function"){a.setImmediate=function(){return setImmediate.apply(void 0,arguments)},a.nextTick=function(i){return setImmediate(i)};return}if(a.setImmediate=function(i){setTimeout(i,0)},typeof window<"u"&&typeof window.postMessage=="function"){let i=function(r){if(r.source===window&&r.data===s){r.stopPropagation();var B=p.slice();p.length=0,B.forEach(function(D){D()})}};var s="forge.setImmediate",p=[];a.setImmediate=function(r){p.push(r),p.length===1&&window.postMessage(s,"*")},window.addEventListener("message",i,!0)}if(typeof MutationObserver<"u"){var v=Date.now(),I=!0,R=document.createElement("div"),p=[];new MutationObserver(function(){var r=p.slice();p.length=0,r.forEach(function(B){B()})}).observe(R,{attributes:!0});var c=a.setImmediate;a.setImmediate=function(r){Date.now()-v>15?(v=Date.now(),c(r)):(p.push(r),p.length===1&&R.setAttribute("a",I=!I))}}a.nextTick=a.setImmediate})(),a.isNodejs=typeof process<"u"&&process.versions&&process.versions.node,a.globalScope=function(){return a.isNodejs?Ka:typeof self>"u"?window:self}(),a.isArray=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"},a.isArrayBuffer=function(s){return typeof ArrayBuffer<"u"&&s instanceof ArrayBuffer},a.isArrayBufferView=function(s){return s&&a.isArrayBuffer(s.buffer)&&s.byteLength!==void 0};function d(s){if(!(s===8||s===16||s===24||s===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+s)}a.ByteBuffer=_;function _(s){if(this.data="",this.read=0,typeof s=="string")this.data=s;else if(a.isArrayBuffer(s)||a.isArrayBufferView(s))if(typeof Buffer<"u"&&s instanceof Buffer)this.data=s.toString("binary");else{var p=new Uint8Array(s);try{this.data=String.fromCharCode.apply(null,p)}catch{for(var v=0;v<p.length;++v)this.putByte(p[v])}}else(s instanceof _||typeof s=="object"&&typeof s.data=="string"&&typeof s.read=="number")&&(this.data=s.data,this.read=s.read);this._constructedStringLength=0}a.ByteStringBuffer=_;var S=4096;a.ByteStringBuffer.prototype._optimizeConstructedString=function(s){this._constructedStringLength+=s,this._constructedStringLength>S&&(this.data.substr(0,1),this._constructedStringLength=0)},a.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},a.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},a.ByteStringBuffer.prototype.putByte=function(s){return this.putBytes(String.fromCharCode(s))},a.ByteStringBuffer.prototype.fillWithByte=function(s,p){s=String.fromCharCode(s);for(var v=this.data;p>0;)p&1&&(v+=s),p>>>=1,p>0&&(s+=s);return this.data=v,this._optimizeConstructedString(p),this},a.ByteStringBuffer.prototype.putBytes=function(s){return this.data+=s,this._optimizeConstructedString(s.length),this},a.ByteStringBuffer.prototype.putString=function(s){return this.putBytes(a.encodeUtf8(s))},a.ByteStringBuffer.prototype.putInt16=function(s){return this.putBytes(String.fromCharCode(s>>8&255)+String.fromCharCode(s&255))},a.ByteStringBuffer.prototype.putInt24=function(s){return this.putBytes(String.fromCharCode(s>>16&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s&255))},a.ByteStringBuffer.prototype.putInt32=function(s){return this.putBytes(String.fromCharCode(s>>24&255)+String.fromCharCode(s>>16&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s&255))},a.ByteStringBuffer.prototype.putInt16Le=function(s){return this.putBytes(String.fromCharCode(s&255)+String.fromCharCode(s>>8&255))},a.ByteStringBuffer.prototype.putInt24Le=function(s){return this.putBytes(String.fromCharCode(s&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s>>16&255))},a.ByteStringBuffer.prototype.putInt32Le=function(s){return this.putBytes(String.fromCharCode(s&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s>>16&255)+String.fromCharCode(s>>24&255))},a.ByteStringBuffer.prototype.putInt=function(s,p){d(p);var v="";do p-=8,v+=String.fromCharCode(s>>p&255);while(p>0);return this.putBytes(v)},a.ByteStringBuffer.prototype.putSignedInt=function(s,p){return s<0&&(s+=2<<p-1),this.putInt(s,p)},a.ByteStringBuffer.prototype.putBuffer=function(s){return this.putBytes(s.getBytes())},a.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},a.ByteStringBuffer.prototype.getInt16=function(){var s=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,s},a.ByteStringBuffer.prototype.getInt24=function(){var s=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,s},a.ByteStringBuffer.prototype.getInt32=function(){var s=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,s},a.ByteStringBuffer.prototype.getInt16Le=function(){var s=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,s},a.ByteStringBuffer.prototype.getInt24Le=function(){var s=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,s},a.ByteStringBuffer.prototype.getInt32Le=function(){var s=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,s},a.ByteStringBuffer.prototype.getInt=function(s){d(s);var p=0;do p=(p<<8)+this.data.charCodeAt(this.read++),s-=8;while(s>0);return p},a.ByteStringBuffer.prototype.getSignedInt=function(s){var p=this.getInt(s),v=2<<s-2;return p>=v&&(p-=v<<1),p},a.ByteStringBuffer.prototype.getBytes=function(s){var p;return s?(s=Math.min(this.length(),s),p=this.data.slice(this.read,this.read+s),this.read+=s):s===0?p="":(p=this.read===0?this.data:this.data.slice(this.read),this.clear()),p},a.ByteStringBuffer.prototype.bytes=function(s){return typeof s>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+s)},a.ByteStringBuffer.prototype.at=function(s){return this.data.charCodeAt(this.read+s)},a.ByteStringBuffer.prototype.setAt=function(s,p){return this.data=this.data.substr(0,this.read+s)+String.fromCharCode(p)+this.data.substr(this.read+s+1),this},a.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},a.ByteStringBuffer.prototype.copy=function(){var s=a.createBuffer(this.data);return s.read=this.read,s},a.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},a.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},a.ByteStringBuffer.prototype.truncate=function(s){var p=Math.max(0,this.length()-s);return this.data=this.data.substr(this.read,p),this.read=0,this},a.ByteStringBuffer.prototype.toHex=function(){for(var s="",p=this.read;p<this.data.length;++p){var v=this.data.charCodeAt(p);v<16&&(s+="0"),s+=v.toString(16)}return s},a.ByteStringBuffer.prototype.toString=function(){return a.decodeUtf8(this.bytes())};function h(s,p){p=p||{},this.read=p.readOffset||0,this.growSize=p.growSize||1024;var v=a.isArrayBuffer(s),I=a.isArrayBufferView(s);if(v||I){v?this.data=new DataView(s):this.data=new DataView(s.buffer,s.byteOffset,s.byteLength),this.write="writeOffset"in p?p.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,s!=null&&this.putBytes(s),"writeOffset"in p&&(this.write=p.writeOffset)}a.DataBuffer=h,a.DataBuffer.prototype.length=function(){return this.write-this.read},a.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},a.DataBuffer.prototype.accommodate=function(s,p){if(this.length()>=s)return this;p=Math.max(p||this.growSize,s);var v=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),I=new Uint8Array(this.length()+p);return I.set(v),this.data=new DataView(I.buffer),this},a.DataBuffer.prototype.putByte=function(s){return this.accommodate(1),this.data.setUint8(this.write++,s),this},a.DataBuffer.prototype.fillWithByte=function(s,p){this.accommodate(p);for(var v=0;v<p;++v)this.data.setUint8(s);return this},a.DataBuffer.prototype.putBytes=function(s,p){if(a.isArrayBufferView(s)){var v=new Uint8Array(s.buffer,s.byteOffset,s.byteLength),I=v.byteLength-v.byteOffset;this.accommodate(I);var R=new Uint8Array(this.data.buffer,this.write);return R.set(v),this.write+=I,this}if(a.isArrayBuffer(s)){var v=new Uint8Array(s);this.accommodate(v.byteLength);var R=new Uint8Array(this.data.buffer);return R.set(v,this.write),this.write+=v.byteLength,this}if(s instanceof a.DataBuffer||typeof s=="object"&&typeof s.read=="number"&&typeof s.write=="number"&&a.isArrayBufferView(s.data)){var v=new Uint8Array(s.data.byteLength,s.read,s.length());this.accommodate(v.byteLength);var R=new Uint8Array(s.data.byteLength,this.write);return R.set(v),this.write+=v.byteLength,this}if(s instanceof a.ByteStringBuffer&&(s=s.data,p="binary"),p=p||"binary",typeof s=="string"){var c;if(p==="hex")return this.accommodate(Math.ceil(s.length/2)),c=new Uint8Array(this.data.buffer,this.write),this.write+=a.binary.hex.decode(s,c,this.write),this;if(p==="base64")return this.accommodate(Math.ceil(s.length/4)*3),c=new Uint8Array(this.data.buffer,this.write),this.write+=a.binary.base64.decode(s,c,this.write),this;if(p==="utf8"&&(s=a.encodeUtf8(s),p="binary"),p==="binary"||p==="raw")return this.accommodate(s.length),c=new Uint8Array(this.data.buffer,this.write),this.write+=a.binary.raw.decode(c),this;if(p==="utf16")return this.accommodate(s.length*2),c=new Uint16Array(this.data.buffer,this.write),this.write+=a.text.utf16.encode(c),this;throw new Error("Invalid encoding: "+p)}throw Error("Invalid parameter: "+s)},a.DataBuffer.prototype.putBuffer=function(s){return this.putBytes(s),s.clear(),this},a.DataBuffer.prototype.putString=function(s){return this.putBytes(s,"utf16")},a.DataBuffer.prototype.putInt16=function(s){return this.accommodate(2),this.data.setInt16(this.write,s),this.write+=2,this},a.DataBuffer.prototype.putInt24=function(s){return this.accommodate(3),this.data.setInt16(this.write,s>>8&65535),this.data.setInt8(this.write,s>>16&255),this.write+=3,this},a.DataBuffer.prototype.putInt32=function(s){return this.accommodate(4),this.data.setInt32(this.write,s),this.write+=4,this},a.DataBuffer.prototype.putInt16Le=function(s){return this.accommodate(2),this.data.setInt16(this.write,s,!0),this.write+=2,this},a.DataBuffer.prototype.putInt24Le=function(s){return this.accommodate(3),this.data.setInt8(this.write,s>>16&255),this.data.setInt16(this.write,s>>8&65535,!0),this.write+=3,this},a.DataBuffer.prototype.putInt32Le=function(s){return this.accommodate(4),this.data.setInt32(this.write,s,!0),this.write+=4,this},a.DataBuffer.prototype.putInt=function(s,p){d(p),this.accommodate(p/8);do p-=8,this.data.setInt8(this.write++,s>>p&255);while(p>0);return this},a.DataBuffer.prototype.putSignedInt=function(s,p){return d(p),this.accommodate(p/8),s<0&&(s+=2<<p-1),this.putInt(s,p)},a.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},a.DataBuffer.prototype.getInt16=function(){var s=this.data.getInt16(this.read);return this.read+=2,s},a.DataBuffer.prototype.getInt24=function(){var s=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,s},a.DataBuffer.prototype.getInt32=function(){var s=this.data.getInt32(this.read);return this.read+=4,s},a.DataBuffer.prototype.getInt16Le=function(){var s=this.data.getInt16(this.read,!0);return this.read+=2,s},a.DataBuffer.prototype.getInt24Le=function(){var s=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,s},a.DataBuffer.prototype.getInt32Le=function(){var s=this.data.getInt32(this.read,!0);return this.read+=4,s},a.DataBuffer.prototype.getInt=function(s){d(s);var p=0;do p=(p<<8)+this.data.getInt8(this.read++),s-=8;while(s>0);return p},a.DataBuffer.prototype.getSignedInt=function(s){var p=this.getInt(s),v=2<<s-2;return p>=v&&(p-=v<<1),p},a.DataBuffer.prototype.getBytes=function(s){var p;return s?(s=Math.min(this.length(),s),p=this.data.slice(this.read,this.read+s),this.read+=s):s===0?p="":(p=this.read===0?this.data:this.data.slice(this.read),this.clear()),p},a.DataBuffer.prototype.bytes=function(s){return typeof s>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+s)},a.DataBuffer.prototype.at=function(s){return this.data.getUint8(this.read+s)},a.DataBuffer.prototype.setAt=function(s,p){return this.data.setUint8(s,p),this},a.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},a.DataBuffer.prototype.copy=function(){return new a.DataBuffer(this)},a.DataBuffer.prototype.compact=function(){if(this.read>0){var s=new Uint8Array(this.data.buffer,this.read),p=new Uint8Array(s.byteLength);p.set(s),this.data=new DataView(p),this.write-=this.read,this.read=0}return this},a.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},a.DataBuffer.prototype.truncate=function(s){return this.write=Math.max(0,this.length()-s),this.read=Math.min(this.read,this.write),this},a.DataBuffer.prototype.toHex=function(){for(var s="",p=this.read;p<this.data.byteLength;++p){var v=this.data.getUint8(p);v<16&&(s+="0"),s+=v.toString(16)}return s},a.DataBuffer.prototype.toString=function(s){var p=new Uint8Array(this.data,this.read,this.length());if(s=s||"utf8",s==="binary"||s==="raw")return a.binary.raw.encode(p);if(s==="hex")return a.binary.hex.encode(p);if(s==="base64")return a.binary.base64.encode(p);if(s==="utf8")return a.text.utf8.decode(p);if(s==="utf16")return a.text.utf16.decode(p);throw new Error("Invalid encoding: "+s)},a.createBuffer=function(s,p){return p=p||"raw",s!==void 0&&p==="utf8"&&(s=a.encodeUtf8(s)),new a.ByteBuffer(s)},a.fillString=function(s,p){for(var v="";p>0;)p&1&&(v+=s),p>>>=1,p>0&&(s+=s);return v},a.xorBytes=function(s,p,v){for(var I="",R="",c="",i=0,r=0;v>0;--v,++i)R=s.charCodeAt(i)^p.charCodeAt(i),r>=10&&(I+=c,c="",r=0),c+=String.fromCharCode(R),++r;return I+=c,I},a.hexToBytes=function(s){var p="",v=0;for(s.length&!0&&(v=1,p+=String.fromCharCode(parseInt(s[0],16)));v<s.length;v+=2)p+=String.fromCharCode(parseInt(s.substr(v,2),16));return p},a.bytesToHex=function(s){return a.createBuffer(s).toHex()},a.int32ToBytes=function(s){return String.fromCharCode(s>>24&255)+String.fromCharCode(s>>16&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s&255)};var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",g=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],l="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";a.encode64=function(s,p){for(var v="",I="",R,c,i,r=0;r<s.length;)R=s.charCodeAt(r++),c=s.charCodeAt(r++),i=s.charCodeAt(r++),v+=t.charAt(R>>2),v+=t.charAt((R&3)<<4|c>>4),isNaN(c)?v+="==":(v+=t.charAt((c&15)<<2|i>>6),v+=isNaN(i)?"=":t.charAt(i&63)),p&&v.length>p&&(I+=v.substr(0,p)+`\r
`,v=v.substr(p));return I+=v,I},a.decode64=function(s){s=s.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var p="",v,I,R,c,i=0;i<s.length;)v=g[s.charCodeAt(i++)-43],I=g[s.charCodeAt(i++)-43],R=g[s.charCodeAt(i++)-43],c=g[s.charCodeAt(i++)-43],p+=String.fromCharCode(v<<2|I>>4),R!==64&&(p+=String.fromCharCode((I&15)<<4|R>>2),c!==64&&(p+=String.fromCharCode((R&3)<<6|c)));return p},a.encodeUtf8=function(s){return unescape(encodeURIComponent(s))},a.decodeUtf8=function(s){return decodeURIComponent(escape(s))},a.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:e.encode,decode:e.decode}},a.binary.raw.encode=function(s){return String.fromCharCode.apply(null,s)},a.binary.raw.decode=function(s,p,v){var I=p;I||(I=new Uint8Array(s.length)),v=v||0;for(var R=v,c=0;c<s.length;++c)I[R++]=s.charCodeAt(c);return p?R-v:I},a.binary.hex.encode=a.bytesToHex,a.binary.hex.decode=function(s,p,v){var I=p;I||(I=new Uint8Array(Math.ceil(s.length/2))),v=v||0;var R=0,c=v;for(s.length&1&&(R=1,I[c++]=parseInt(s[0],16));R<s.length;R+=2)I[c++]=parseInt(s.substr(R,2),16);return p?c-v:I},a.binary.base64.encode=function(s,p){for(var v="",I="",R,c,i,r=0;r<s.byteLength;)R=s[r++],c=s[r++],i=s[r++],v+=t.charAt(R>>2),v+=t.charAt((R&3)<<4|c>>4),isNaN(c)?v+="==":(v+=t.charAt((c&15)<<2|i>>6),v+=isNaN(i)?"=":t.charAt(i&63)),p&&v.length>p&&(I+=v.substr(0,p)+`\r
`,v=v.substr(p));return I+=v,I},a.binary.base64.decode=function(s,p,v){var I=p;I||(I=new Uint8Array(Math.ceil(s.length/4)*3)),s=s.replace(/[^A-Za-z0-9\+\/\=]/g,""),v=v||0;for(var R,c,i,r,B=0,D=v;B<s.length;)R=g[s.charCodeAt(B++)-43],c=g[s.charCodeAt(B++)-43],i=g[s.charCodeAt(B++)-43],r=g[s.charCodeAt(B++)-43],I[D++]=R<<2|c>>4,i!==64&&(I[D++]=(c&15)<<4|i>>2,r!==64&&(I[D++]=(i&3)<<6|r));return p?D-v:I.subarray(0,D)},a.binary.base58.encode=function(s,p){return a.binary.baseN.encode(s,l,p)},a.binary.base58.decode=function(s,p){return a.binary.baseN.decode(s,l,p)},a.text={utf8:{},utf16:{}},a.text.utf8.encode=function(s,p,v){s=a.encodeUtf8(s);var I=p;I||(I=new Uint8Array(s.length)),v=v||0;for(var R=v,c=0;c<s.length;++c)I[R++]=s.charCodeAt(c);return p?R-v:I},a.text.utf8.decode=function(s){return a.decodeUtf8(String.fromCharCode.apply(null,s))},a.text.utf16.encode=function(s,p,v){var I=p;I||(I=new Uint8Array(s.length*2));var R=new Uint16Array(I.buffer);v=v||0;for(var c=v,i=v,r=0;r<s.length;++r)R[i++]=s.charCodeAt(r),c+=2;return p?c-v:I},a.text.utf16.decode=function(s){return String.fromCharCode.apply(null,new Uint16Array(s.buffer))},a.deflate=function(s,p,v){if(p=a.decode64(s.deflate(a.encode64(p)).rval),v){var I=2,R=p.charCodeAt(1);R&32&&(I=6),p=p.substring(I,p.length-4)}return p},a.inflate=function(s,p,v){var I=s.inflate(a.encode64(p)).rval;return I===null?null:a.decode64(I)};var x=function(s,p,v){if(!s)throw new Error("WebStorage not available.");var I;if(v===null?I=s.removeItem(p):(v=a.encode64(JSON.stringify(v)),I=s.setItem(p,v)),typeof I<"u"&&I.rval!==!0){var R=new Error(I.error.message);throw R.id=I.error.id,R.name=I.error.name,R}},k=function(s,p){if(!s)throw new Error("WebStorage not available.");var v=s.getItem(p);if(s.init)if(v.rval===null){if(v.error){var I=new Error(v.error.message);throw I.id=v.error.id,I.name=v.error.name,I}v=null}else v=v.rval;return v!==null&&(v=JSON.parse(a.decode64(v))),v},E=function(s,p,v,I){var R=k(s,p);R===null&&(R={}),R[v]=I,x(s,p,R)},u=function(s,p,v){var I=k(s,p);return I!==null&&(I=v in I?I[v]:null),I},y=function(s,p,v){var I=k(s,p);if(I!==null&&v in I){delete I[v];var R=!0;for(var c in I){R=!1;break}R&&(I=null),x(s,p,I)}},C=function(s,p){x(s,p,null)},m=function(s,p,v){var I=null;typeof v>"u"&&(v=["web","flash"]);var R,c=!1,i=null;for(var r in v){R=v[r];try{if(R==="flash"||R==="both"){if(p[0]===null)throw new Error("Flash local storage not available.");I=s.apply(this,p),c=R==="flash"}(R==="web"||R==="both")&&(p[0]=localStorage,I=s.apply(this,p),c=!0)}catch(B){i=B}if(c)break}if(!c)throw i;return I};return a.setItem=function(s,p,v,I,R){m(E,arguments,R)},a.getItem=function(s,p,v,I){return m(u,arguments,I)},a.removeItem=function(s,p,v,I){m(y,arguments,I)},a.clearItems=function(s,p,v){m(C,arguments,v)},a.isEmpty=function(s){for(var p in s)if(s.hasOwnProperty(p))return!1;return!0},a.format=function(s){for(var p=/%./g,v,I,R=0,c=[],i=0;v=p.exec(s);){I=s.substring(i,p.lastIndex-2),I.length>0&&c.push(I),i=p.lastIndex;var r=v[0][1];switch(r){case"s":case"o":R<arguments.length?c.push(arguments[R+++1]):c.push("<?>");break;case"%":c.push("%");break;default:c.push("<%"+r+"?>")}}return c.push(s.substring(i)),c.join("")},a.formatNumber=function(s,p,v,I){var R=s,c=isNaN(p=Math.abs(p))?2:p,i=v===void 0?",":v,r=I===void 0?".":I,B=R<0?"-":"",D=parseInt(R=Math.abs(+R||0).toFixed(c),10)+"",V=D.length>3?D.length%3:0;return B+(V?D.substr(0,V)+r:"")+D.substr(V).replace(/(\d{3})(?=\d)/g,"$1"+r)+(c?i+Math.abs(R-D).toFixed(c).slice(2):"")},a.formatSize=function(s){return s>=1073741824?s=a.formatNumber(s/1073741824,2,".","")+" GiB":s>=1048576?s=a.formatNumber(s/1048576,2,".","")+" MiB":s>=1024?s=a.formatNumber(s/1024,0)+" KiB":s=a.formatNumber(s,0)+" bytes",s},a.bytesFromIP=function(s){return s.indexOf(".")!==-1?a.bytesFromIPv4(s):s.indexOf(":")!==-1?a.bytesFromIPv6(s):null},a.bytesFromIPv4=function(s){if(s=s.split("."),s.length!==4)return null;for(var p=a.createBuffer(),v=0;v<s.length;++v){var I=parseInt(s[v],10);if(isNaN(I))return null;p.putByte(I)}return p.getBytes()},a.bytesFromIPv6=function(s){var p=0;s=s.split(":").filter(function(i){return i.length===0&&++p,!0});for(var v=(8-s.length+p)*2,I=a.createBuffer(),R=0;R<8;++R){if(!s[R]||s[R].length===0){I.fillWithByte(0,v),v=0;continue}var c=a.hexToBytes(s[R]);c.length<2&&I.putByte(0),I.putBytes(c)}return I.getBytes()},a.bytesToIP=function(s){return s.length===4?a.bytesToIPv4(s):s.length===16?a.bytesToIPv6(s):null},a.bytesToIPv4=function(s){if(s.length!==4)return null;for(var p=[],v=0;v<s.length;++v)p.push(s.charCodeAt(v));return p.join(".")},a.bytesToIPv6=function(s){if(s.length!==16)return null;for(var p=[],v=[],I=0,R=0;R<s.length;R+=2){for(var c=a.bytesToHex(s[R]+s[R+1]);c[0]==="0"&&c!=="0";)c=c.substr(1);if(c==="0"){var i=v[v.length-1],r=p.length;!i||r!==i.end+1?v.push({start:r,end:r}):(i.end=r,i.end-i.start>v[I].end-v[I].start&&(I=v.length-1))}p.push(c)}if(v.length>0){var B=v[I];B.end-B.start>0&&(p.splice(B.start,B.end-B.start+1,""),B.start===0&&p.unshift(""),B.end===7&&p.push(""))}return p.join(":")},a.estimateCores=function(s,p){if(typeof s=="function"&&(p=s,s={}),s=s||{},"cores"in a&&!s.update)return p(null,a.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return a.cores=navigator.hardwareConcurrency,p(null,a.cores);if(typeof Worker>"u")return a.cores=1,p(null,a.cores);if(typeof Blob>"u")return a.cores=2,p(null,a.cores);var v=URL.createObjectURL(new Blob(["(",(function(){self.addEventListener("message",function(i){var r=Date.now(),B=r+4;self.postMessage({st:r,et:B})})}).toString(),")()"],{type:"application/javascript"}));I([],5,16);function I(i,r,B){if(r===0){var D=Math.floor(i.reduce(function(V,L){return V+L},0)/i.length);return a.cores=Math.max(1,D),URL.revokeObjectURL(v),p(null,a.cores)}R(B,function(V,L){i.push(c(B,L)),I(i,r-1,B)})}function R(i,r){for(var B=[],D=[],V=0;V<i;++V){var L=new Worker(v);L.addEventListener("message",function(O){if(D.push(O.data),D.length===i){for(var q=0;q<i;++q)B[q].terminate();r(null,D)}}),B.push(L)}for(var V=0;V<i;++V)B[V].postMessage(V)}function c(i,r){for(var B=[],D=0;D<i;++D)for(var V=r[D],L=B[D]=[],O=0;O<i;++O)if(D!==O){var q=r[O];(V.st>q.st&&V.st<q.et||q.st>V.st&&q.st<V.et)&&L.push(O)}return B.reduce(function(M,H){return Math.max(M,H.length)},0)}},wt.exports}var Dt,Br;function gr(){if(Br)return Dt;Br=1;var n=fe();pe(),Dt=n.cipher=n.cipher||{},n.cipher.algorithms=n.cipher.algorithms||{},n.cipher.createCipher=function(a,d){var _=a;if(typeof _=="string"&&(_=n.cipher.getAlgorithm(_),_&&(_=_())),!_)throw new Error("Unsupported algorithm: "+a);return new n.cipher.BlockCipher({algorithm:_,key:d,decrypt:!1})},n.cipher.createDecipher=function(a,d){var _=a;if(typeof _=="string"&&(_=n.cipher.getAlgorithm(_),_&&(_=_())),!_)throw new Error("Unsupported algorithm: "+a);return new n.cipher.BlockCipher({algorithm:_,key:d,decrypt:!0})},n.cipher.registerAlgorithm=function(a,d){a=a.toUpperCase(),n.cipher.algorithms[a]=d},n.cipher.getAlgorithm=function(a){return a=a.toUpperCase(),a in n.cipher.algorithms?n.cipher.algorithms[a]:null};var e=n.cipher.BlockCipher=function(a){this.algorithm=a.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=a.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=a.decrypt,this.algorithm.initialize(a)};return e.prototype.start=function(a){a=a||{};var d={};for(var _ in a)d[_]=a[_];d.decrypt=this._decrypt,this._finish=!1,this._input=n.util.createBuffer(),this.output=a.output||n.util.createBuffer(),this.mode.start(d)},e.prototype.update=function(a){for(a&&this._input.putBuffer(a);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},e.prototype.finish=function(a){a&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(_){return a(this.blockSize,_,!1)},this.mode.unpad=function(_){return a(this.blockSize,_,!0)});var d={};return d.decrypt=this._decrypt,d.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,d)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,d))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,d))},Dt}var kt={exports:{}},br;function ca(){if(br)return kt.exports;br=1;var n=fe();pe(),n.cipher=n.cipher||{};var e=kt.exports=n.cipher.modes=n.cipher.modes||{};e.ecb=function(S){S=S||{},this.name="ECB",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.ecb.prototype.start=function(S){},e.ecb.prototype.encrypt=function(S,h,t){if(S.length()<this.blockSize&&!(t&&S.length()>0))return!0;for(var g=0;g<this._ints;++g)this._inBlock[g]=S.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var g=0;g<this._ints;++g)h.putInt32(this._outBlock[g])},e.ecb.prototype.decrypt=function(S,h,t){if(S.length()<this.blockSize&&!(t&&S.length()>0))return!0;for(var g=0;g<this._ints;++g)this._inBlock[g]=S.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var g=0;g<this._ints;++g)h.putInt32(this._outBlock[g])},e.ecb.prototype.pad=function(S,h){var t=S.length()===this.blockSize?this.blockSize:this.blockSize-S.length();return S.fillWithByte(t,t),!0},e.ecb.prototype.unpad=function(S,h){if(h.overflow>0)return!1;var t=S.length(),g=S.at(t-1);return g>this.blockSize<<2?!1:(S.truncate(g),!0)},e.cbc=function(S){S=S||{},this.name="CBC",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.cbc.prototype.start=function(S){if(S.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in S)this._iv=a(S.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},e.cbc.prototype.encrypt=function(S,h,t){if(S.length()<this.blockSize&&!(t&&S.length()>0))return!0;for(var g=0;g<this._ints;++g)this._inBlock[g]=this._prev[g]^S.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var g=0;g<this._ints;++g)h.putInt32(this._outBlock[g]);this._prev=this._outBlock},e.cbc.prototype.decrypt=function(S,h,t){if(S.length()<this.blockSize&&!(t&&S.length()>0))return!0;for(var g=0;g<this._ints;++g)this._inBlock[g]=S.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var g=0;g<this._ints;++g)h.putInt32(this._prev[g]^this._outBlock[g]);this._prev=this._inBlock.slice(0)},e.cbc.prototype.pad=function(S,h){var t=S.length()===this.blockSize?this.blockSize:this.blockSize-S.length();return S.fillWithByte(t,t),!0},e.cbc.prototype.unpad=function(S,h){if(h.overflow>0)return!1;var t=S.length(),g=S.at(t-1);return g>this.blockSize<<2?!1:(S.truncate(g),!0)},e.cfb=function(S){S=S||{},this.name="CFB",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},e.cfb.prototype.start=function(S){if(!("iv"in S))throw new Error("Invalid IV parameter.");this._iv=a(S.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.cfb.prototype.encrypt=function(S,h,t){var g=S.length();if(g===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&g>=this.blockSize){for(var l=0;l<this._ints;++l)this._inBlock[l]=S.getInt32()^this._outBlock[l],h.putInt32(this._inBlock[l]);return}var x=(this.blockSize-g)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var l=0;l<this._ints;++l)this._partialBlock[l]=S.getInt32()^this._outBlock[l],this._partialOutput.putInt32(this._partialBlock[l]);if(x>0)S.read-=this.blockSize;else for(var l=0;l<this._ints;++l)this._inBlock[l]=this._partialBlock[l];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!t)return h.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;h.putBytes(this._partialOutput.getBytes(g-this._partialBytes)),this._partialBytes=0},e.cfb.prototype.decrypt=function(S,h,t){var g=S.length();if(g===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&g>=this.blockSize){for(var l=0;l<this._ints;++l)this._inBlock[l]=S.getInt32(),h.putInt32(this._inBlock[l]^this._outBlock[l]);return}var x=(this.blockSize-g)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var l=0;l<this._ints;++l)this._partialBlock[l]=S.getInt32(),this._partialOutput.putInt32(this._partialBlock[l]^this._outBlock[l]);if(x>0)S.read-=this.blockSize;else for(var l=0;l<this._ints;++l)this._inBlock[l]=this._partialBlock[l];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!t)return h.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;h.putBytes(this._partialOutput.getBytes(g-this._partialBytes)),this._partialBytes=0},e.ofb=function(S){S=S||{},this.name="OFB",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},e.ofb.prototype.start=function(S){if(!("iv"in S))throw new Error("Invalid IV parameter.");this._iv=a(S.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ofb.prototype.encrypt=function(S,h,t){var g=S.length();if(S.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&g>=this.blockSize){for(var l=0;l<this._ints;++l)h.putInt32(S.getInt32()^this._outBlock[l]),this._inBlock[l]=this._outBlock[l];return}var x=(this.blockSize-g)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var l=0;l<this._ints;++l)this._partialOutput.putInt32(S.getInt32()^this._outBlock[l]);if(x>0)S.read-=this.blockSize;else for(var l=0;l<this._ints;++l)this._inBlock[l]=this._outBlock[l];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!t)return h.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;h.putBytes(this._partialOutput.getBytes(g-this._partialBytes)),this._partialBytes=0},e.ofb.prototype.decrypt=e.ofb.prototype.encrypt,e.ctr=function(S){S=S||{},this.name="CTR",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},e.ctr.prototype.start=function(S){if(!("iv"in S))throw new Error("Invalid IV parameter.");this._iv=a(S.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ctr.prototype.encrypt=function(S,h,t){var g=S.length();if(g===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&g>=this.blockSize)for(var l=0;l<this._ints;++l)h.putInt32(S.getInt32()^this._outBlock[l]);else{var x=(this.blockSize-g)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var l=0;l<this._ints;++l)this._partialOutput.putInt32(S.getInt32()^this._outBlock[l]);if(x>0&&(S.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!t)return h.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;h.putBytes(this._partialOutput.getBytes(g-this._partialBytes)),this._partialBytes=0}d(this._inBlock)},e.ctr.prototype.decrypt=e.ctr.prototype.encrypt,e.gcm=function(S){S=S||{},this.name="GCM",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0,this._R=3774873600},e.gcm.prototype.start=function(S){if(!("iv"in S))throw new Error("Invalid IV parameter.");var h=n.util.createBuffer(S.iv);this._cipherLength=0;var t;if("additionalData"in S?t=n.util.createBuffer(S.additionalData):t=n.util.createBuffer(),"tagLength"in S?this._tagLength=S.tagLength:this._tagLength=128,this._tag=null,S.decrypt&&(this._tag=n.util.createBuffer(S.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var g=h.length();if(g===12)this._j0=[h.getInt32(),h.getInt32(),h.getInt32(),1];else{for(this._j0=[0,0,0,0];h.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[h.getInt32(),h.getInt32(),h.getInt32(),h.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(_(g*8)))}this._inBlock=this._j0.slice(0),d(this._inBlock),this._partialBytes=0,t=n.util.createBuffer(t),this._aDataLength=_(t.length()*8);var l=t.length()%this.blockSize;for(l&&t.fillWithByte(0,this.blockSize-l),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},e.gcm.prototype.encrypt=function(S,h,t){var g=S.length();if(g===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&g>=this.blockSize){for(var l=0;l<this._ints;++l)h.putInt32(this._outBlock[l]^=S.getInt32());this._cipherLength+=this.blockSize}else{var x=(this.blockSize-g)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var l=0;l<this._ints;++l)this._partialOutput.putInt32(S.getInt32()^this._outBlock[l]);if(x<=0||t){if(t){var k=g%this.blockSize;this._cipherLength+=k,this._partialOutput.truncate(this.blockSize-k)}else this._cipherLength+=this.blockSize;for(var l=0;l<this._ints;++l)this._outBlock[l]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!t)return S.read-=this.blockSize,h.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;h.putBytes(this._partialOutput.getBytes(g-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),d(this._inBlock)},e.gcm.prototype.decrypt=function(S,h,t){var g=S.length();if(g<this.blockSize&&!(t&&g>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),d(this._inBlock),this._hashBlock[0]=S.getInt32(),this._hashBlock[1]=S.getInt32(),this._hashBlock[2]=S.getInt32(),this._hashBlock[3]=S.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var l=0;l<this._ints;++l)h.putInt32(this._outBlock[l]^this._hashBlock[l]);g<this.blockSize?this._cipherLength+=g%this.blockSize:this._cipherLength+=this.blockSize},e.gcm.prototype.afterFinish=function(S,h){var t=!0;h.decrypt&&h.overflow&&S.truncate(this.blockSize-h.overflow),this.tag=n.util.createBuffer();var g=this._aDataLength.concat(_(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,g);var l=[];this.cipher.encrypt(this._j0,l);for(var x=0;x<this._ints;++x)this.tag.putInt32(this._s[x]^l[x]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),h.decrypt&&this.tag.bytes()!==this._tag&&(t=!1),t},e.gcm.prototype.multiply=function(S,h){for(var t=[0,0,0,0],g=h.slice(0),l=0;l<128;++l){var x=S[l/32|0]&1<<31-l%32;x&&(t[0]^=g[0],t[1]^=g[1],t[2]^=g[2],t[3]^=g[3]),this.pow(g,g)}return t},e.gcm.prototype.pow=function(S,h){for(var t=S[3]&1,g=3;g>0;--g)h[g]=S[g]>>>1|(S[g-1]&1)<<31;h[0]=S[0]>>>1,t&&(h[0]^=this._R)},e.gcm.prototype.tableMultiply=function(S){for(var h=[0,0,0,0],t=0;t<32;++t){var g=t/8|0,l=S[g]>>>(7-t%8)*4&15,x=this._m[t][l];h[0]^=x[0],h[1]^=x[1],h[2]^=x[2],h[3]^=x[3]}return h},e.gcm.prototype.ghash=function(S,h,t){return h[0]^=t[0],h[1]^=t[1],h[2]^=t[2],h[3]^=t[3],this.tableMultiply(h)},e.gcm.prototype.generateHashTable=function(S,h){for(var t=8/h,g=4*t,l=16*t,x=new Array(l),k=0;k<l;++k){var E=[0,0,0,0],u=k/g|0,y=(g-1-k%g)*h;E[u]=1<<h-1<<y,x[k]=this.generateSubHashTable(this.multiply(E,S),h)}return x},e.gcm.prototype.generateSubHashTable=function(S,h){var t=1<<h,g=t>>>1,l=new Array(t);l[g]=S.slice(0);for(var x=g>>>1;x>0;)this.pow(l[2*x],l[x]=[]),x>>=1;for(x=2;x<g;){for(var k=1;k<x;++k){var E=l[x],u=l[k];l[x+k]=[E[0]^u[0],E[1]^u[1],E[2]^u[2],E[3]^u[3]]}x*=2}for(l[0]=[0,0,0,0],x=g+1;x<t;++x){var y=l[x^g];l[x]=[S[0]^y[0],S[1]^y[1],S[2]^y[2],S[3]^y[3]]}return l};function a(S,h){if(typeof S=="string"&&(S=n.util.createBuffer(S)),n.util.isArray(S)&&S.length>4){var t=S;S=n.util.createBuffer();for(var g=0;g<t.length;++g)S.putByte(t[g])}if(S.length()<h)throw new Error("Invalid IV length; got "+S.length()+" bytes and expected "+h+" bytes.");if(!n.util.isArray(S)){for(var l=[],x=h/4,g=0;g<x;++g)l.push(S.getInt32());S=l}return S}function d(S){S[S.length-1]=S[S.length-1]+1&4294967295}function _(S){return[S/4294967296|0,S&4294967295]}return kt.exports}var Ut,_r;function ht(){if(_r)return Ut;_r=1;var n=fe();gr(),ca(),pe(),Ut=n.aes=n.aes||{},n.aes.startEncrypting=function(u,y,C,m){var s=E({key:u,output:C,decrypt:!1,mode:m});return s.start(y),s},n.aes.createEncryptionCipher=function(u,y){return E({key:u,output:null,decrypt:!1,mode:y})},n.aes.startDecrypting=function(u,y,C,m){var s=E({key:u,output:C,decrypt:!0,mode:m});return s.start(y),s},n.aes.createDecryptionCipher=function(u,y){return E({key:u,output:null,decrypt:!0,mode:y})},n.aes.Algorithm=function(u,y){a||l();var C=this;C.name=u,C.mode=new y({blockSize:16,cipher:{encrypt:function(m,s){return k(C._w,m,s,!1)},decrypt:function(m,s){return k(C._w,m,s,!0)}}}),C._init=!1},n.aes.Algorithm.prototype.initialize=function(u){if(!this._init){var y=u.key,C;if(typeof y=="string"&&(y.length===16||y.length===24||y.length===32))y=n.util.createBuffer(y);else if(n.util.isArray(y)&&(y.length===16||y.length===24||y.length===32)){C=y,y=n.util.createBuffer();for(var m=0;m<C.length;++m)y.putByte(C[m])}if(!n.util.isArray(y)){C=y,y=[];var s=C.length();if(s===16||s===24||s===32){s=s>>>2;for(var m=0;m<s;++m)y.push(C.getInt32())}}if(!n.util.isArray(y)||!(y.length===4||y.length===6||y.length===8))throw new Error("Invalid key parameter.");var p=this.mode.name,v=["CFB","OFB","CTR","GCM"].indexOf(p)!==-1;this._w=x(y,u.decrypt&&!v),this._init=!0}},n.aes._expandKey=function(u,y){return a||l(),x(u,y)},n.aes._updateBlock=k,e("AES-ECB",n.cipher.modes.ecb),e("AES-CBC",n.cipher.modes.cbc),e("AES-CFB",n.cipher.modes.cfb),e("AES-OFB",n.cipher.modes.ofb),e("AES-CTR",n.cipher.modes.ctr),e("AES-GCM",n.cipher.modes.gcm);function e(u,y){var C=function(){return new n.aes.Algorithm(u,y)};n.cipher.registerAlgorithm(u,C)}var a=!1,d=4,_,S,h,t,g;function l(){a=!0,h=[0,1,2,4,8,16,32,64,128,27,54];for(var u=new Array(256),y=0;y<128;++y)u[y]=y<<1,u[y+128]=y+128<<1^283;_=new Array(256),S=new Array(256),t=new Array(4),g=new Array(4);for(var y=0;y<4;++y)t[y]=new Array(256),g[y]=new Array(256);for(var C=0,m=0,s,p,v,I,R,c,i,y=0;y<256;++y){I=m^m<<1^m<<2^m<<3^m<<4,I=I>>8^I&255^99,_[C]=I,S[I]=C,R=u[I],s=u[C],p=u[s],v=u[p],c=R<<24^I<<16^I<<8^(I^R),i=(s^p^v)<<24^(C^v)<<16^(C^p^v)<<8^(C^s^v);for(var r=0;r<4;++r)t[r][C]=c,g[r][I]=i,c=c<<24|c>>>8,i=i<<24|i>>>8;C===0?C=m=1:(C=s^u[u[u[s^v]]],m^=u[u[m]])}}function x(u,y){for(var C=u.slice(0),m,s=1,p=C.length,v=p+6+1,I=d*v,R=p;R<I;++R)m=C[R-1],R%p===0?(m=_[m>>>16&255]<<24^_[m>>>8&255]<<16^_[m&255]<<8^_[m>>>24]^h[s]<<24,s++):p>6&&R%p===4&&(m=_[m>>>24]<<24^_[m>>>16&255]<<16^_[m>>>8&255]<<8^_[m&255]),C[R]=C[R-p]^m;if(y){var c,i=g[0],r=g[1],B=g[2],D=g[3],V=C.slice(0);I=C.length;for(var R=0,L=I-d;R<I;R+=d,L-=d)if(R===0||R===I-d)V[R]=C[L],V[R+1]=C[L+3],V[R+2]=C[L+2],V[R+3]=C[L+1];else for(var O=0;O<d;++O)c=C[L+O],V[R+(3&-O)]=i[_[c>>>24]]^r[_[c>>>16&255]]^B[_[c>>>8&255]]^D[_[c&255]];C=V}return C}function k(u,y,C,m){var s=u.length/4-1,p,v,I,R,c;m?(p=g[0],v=g[1],I=g[2],R=g[3],c=S):(p=t[0],v=t[1],I=t[2],R=t[3],c=_);var i,r,B,D,V,L,O;i=y[0]^u[0],r=y[m?3:1]^u[1],B=y[2]^u[2],D=y[m?1:3]^u[3];for(var q=3,M=1;M<s;++M)V=p[i>>>24]^v[r>>>16&255]^I[B>>>8&255]^R[D&255]^u[++q],L=p[r>>>24]^v[B>>>16&255]^I[D>>>8&255]^R[i&255]^u[++q],O=p[B>>>24]^v[D>>>16&255]^I[i>>>8&255]^R[r&255]^u[++q],D=p[D>>>24]^v[i>>>16&255]^I[r>>>8&255]^R[B&255]^u[++q],i=V,r=L,B=O;C[0]=c[i>>>24]<<24^c[r>>>16&255]<<16^c[B>>>8&255]<<8^c[D&255]^u[++q],C[m?3:1]=c[r>>>24]<<24^c[B>>>16&255]<<16^c[D>>>8&255]<<8^c[i&255]^u[++q],C[2]=c[B>>>24]<<24^c[D>>>16&255]<<16^c[i>>>8&255]<<8^c[r&255]^u[++q],C[m?1:3]=c[D>>>24]<<24^c[i>>>16&255]<<16^c[r>>>8&255]<<8^c[B&255]^u[++q]}function E(u){u=u||{};var y=(u.mode||"CBC").toUpperCase(),C="AES-"+y,m;u.decrypt?m=n.cipher.createDecipher(C,u.key):m=n.cipher.createCipher(C,u.key);var s=m.start;return m.start=function(p,v){var I=null;v instanceof n.util.ByteBuffer&&(I=v,v={}),v=v||{},v.output=I,v.iv=p,s.call(m,v)},m}return Ut}var Pt={exports:{}},Vt={exports:{}},Ot={exports:{}},Nr;function pt(){if(Nr)return Ot.exports;Nr=1;var n=fe();n.pki=n.pki||{};var e=Ot.exports=n.pki.oids=n.oids=n.oids||{};function a(_,S){e[_]=S,e[S]=_}function d(_,S){e[_]=S}return a("1.2.840.113549.1.1.1","rsaEncryption"),a("1.2.840.113549.1.1.4","md5WithRSAEncryption"),a("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),a("1.2.840.113549.1.1.7","RSAES-OAEP"),a("1.2.840.113549.1.1.8","mgf1"),a("1.2.840.113549.1.1.9","pSpecified"),a("1.2.840.113549.1.1.10","RSASSA-PSS"),a("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),a("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),a("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),a("1.3.101.112","EdDSA25519"),a("1.2.840.10040.4.3","dsa-with-sha1"),a("1.3.14.3.2.7","desCBC"),a("1.3.14.3.2.26","sha1"),a("1.3.14.3.2.29","sha1WithRSASignature"),a("2.16.840.1.101.3.4.2.1","sha256"),a("2.16.840.1.101.3.4.2.2","sha384"),a("2.16.840.1.101.3.4.2.3","sha512"),a("2.16.840.1.101.3.4.2.4","sha224"),a("2.16.840.1.101.3.4.2.5","sha512-224"),a("2.16.840.1.101.3.4.2.6","sha512-256"),a("1.2.840.113549.2.2","md2"),a("1.2.840.113549.2.5","md5"),a("1.2.840.113549.1.7.1","data"),a("1.2.840.113549.1.7.2","signedData"),a("1.2.840.113549.1.7.3","envelopedData"),a("1.2.840.113549.1.7.4","signedAndEnvelopedData"),a("1.2.840.113549.1.7.5","digestedData"),a("1.2.840.113549.1.7.6","encryptedData"),a("1.2.840.113549.1.9.1","emailAddress"),a("1.2.840.113549.1.9.2","unstructuredName"),a("1.2.840.113549.1.9.3","contentType"),a("1.2.840.113549.1.9.4","messageDigest"),a("1.2.840.113549.1.9.5","signingTime"),a("1.2.840.113549.1.9.6","counterSignature"),a("1.2.840.113549.1.9.7","challengePassword"),a("1.2.840.113549.1.9.8","unstructuredAddress"),a("1.2.840.113549.1.9.14","extensionRequest"),a("1.2.840.113549.1.9.20","friendlyName"),a("1.2.840.113549.1.9.21","localKeyId"),a("1.2.840.113549.1.9.22.1","x509Certificate"),a("1.2.840.113549.1.12.10.1.1","keyBag"),a("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),a("1.2.840.113549.1.12.10.1.3","certBag"),a("1.2.840.113549.1.12.10.1.4","crlBag"),a("1.2.840.113549.1.12.10.1.5","secretBag"),a("1.2.840.113549.1.12.10.1.6","safeContentsBag"),a("1.2.840.113549.1.5.13","pkcs5PBES2"),a("1.2.840.113549.1.5.12","pkcs5PBKDF2"),a("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),a("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),a("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),a("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),a("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),a("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),a("1.2.840.113549.2.7","hmacWithSHA1"),a("1.2.840.113549.2.8","hmacWithSHA224"),a("1.2.840.113549.2.9","hmacWithSHA256"),a("1.2.840.113549.2.10","hmacWithSHA384"),a("1.2.840.113549.2.11","hmacWithSHA512"),a("1.2.840.113549.3.7","des-EDE3-CBC"),a("2.16.840.1.101.3.4.1.2","aes128-CBC"),a("2.16.840.1.101.3.4.1.22","aes192-CBC"),a("2.16.840.1.101.3.4.1.42","aes256-CBC"),a("2.5.4.3","commonName"),a("2.5.4.4","surname"),a("2.5.4.5","serialNumber"),a("2.5.4.6","countryName"),a("2.5.4.7","localityName"),a("2.5.4.8","stateOrProvinceName"),a("2.5.4.9","streetAddress"),a("2.5.4.10","organizationName"),a("2.5.4.11","organizationalUnitName"),a("2.5.4.12","title"),a("2.5.4.13","description"),a("2.5.4.15","businessCategory"),a("2.5.4.17","postalCode"),a("2.5.4.42","givenName"),a("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),a("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),a("2.16.840.1.113730.1.1","nsCertType"),a("2.16.840.1.113730.1.13","nsComment"),d("2.5.29.1","authorityKeyIdentifier"),d("2.5.29.2","keyAttributes"),d("2.5.29.3","certificatePolicies"),d("2.5.29.4","keyUsageRestriction"),d("2.5.29.5","policyMapping"),d("2.5.29.6","subtreesConstraint"),d("2.5.29.7","subjectAltName"),d("2.5.29.8","issuerAltName"),d("2.5.29.9","subjectDirectoryAttributes"),d("2.5.29.10","basicConstraints"),d("2.5.29.11","nameConstraints"),d("2.5.29.12","policyConstraints"),d("2.5.29.13","basicConstraints"),a("2.5.29.14","subjectKeyIdentifier"),a("2.5.29.15","keyUsage"),d("2.5.29.16","privateKeyUsagePeriod"),a("2.5.29.17","subjectAltName"),a("2.5.29.18","issuerAltName"),a("2.5.29.19","basicConstraints"),d("2.5.29.20","cRLNumber"),d("2.5.29.21","cRLReason"),d("2.5.29.22","expirationDate"),d("2.5.29.23","instructionCode"),d("2.5.29.24","invalidityDate"),d("2.5.29.25","cRLDistributionPoints"),d("2.5.29.26","issuingDistributionPoint"),d("2.5.29.27","deltaCRLIndicator"),d("2.5.29.28","issuingDistributionPoint"),d("2.5.29.29","certificateIssuer"),d("2.5.29.30","nameConstraints"),a("2.5.29.31","cRLDistributionPoints"),a("2.5.29.32","certificatePolicies"),d("2.5.29.33","policyMappings"),d("2.5.29.34","policyConstraints"),a("2.5.29.35","authorityKeyIdentifier"),d("2.5.29.36","policyConstraints"),a("2.5.29.37","extKeyUsage"),d("2.5.29.46","freshestCRL"),d("2.5.29.54","inhibitAnyPolicy"),a("1.3.6.1.4.1.11129.2.4.2","timestampList"),a("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),a("1.3.6.1.5.5.7.3.1","serverAuth"),a("1.3.6.1.5.5.7.3.2","clientAuth"),a("1.3.6.1.5.5.7.3.3","codeSigning"),a("1.3.6.1.5.5.7.3.4","emailProtection"),a("1.3.6.1.5.5.7.3.8","timeStamping"),Ot.exports}var Rr;function tt(){if(Rr)return Vt.exports;Rr=1;var n=fe();pe(),pt();var e=Vt.exports=n.asn1=n.asn1||{};e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},e.create=function(h,t,g,l,x){if(n.util.isArray(l)){for(var k=[],E=0;E<l.length;++E)l[E]!==void 0&&k.push(l[E]);l=k}var u={tagClass:h,type:t,constructed:g,composed:g||n.util.isArray(l),value:l};return x&&"bitStringContents"in x&&(u.bitStringContents=x.bitStringContents,u.original=e.copy(u)),u},e.copy=function(h,t){var g;if(n.util.isArray(h)){g=[];for(var l=0;l<h.length;++l)g.push(e.copy(h[l],t));return g}return typeof h=="string"?h:(g={tagClass:h.tagClass,type:h.type,constructed:h.constructed,composed:h.composed,value:e.copy(h.value,t)},t&&!t.excludeBitStringContents&&(g.bitStringContents=h.bitStringContents),g)},e.equals=function(h,t,g){if(n.util.isArray(h)){if(!n.util.isArray(t)||h.length!==t.length)return!1;for(var l=0;l<h.length;++l)if(!e.equals(h[l],t[l]))return!1;return!0}if(typeof h!=typeof t)return!1;if(typeof h=="string")return h===t;var x=h.tagClass===t.tagClass&&h.type===t.type&&h.constructed===t.constructed&&h.composed===t.composed&&e.equals(h.value,t.value);return g&&g.includeBitStringContents&&(x=x&&h.bitStringContents===t.bitStringContents),x},e.getBerValueLength=function(h){var t=h.getByte();if(t!==128){var g,l=t&128;return l?g=h.getInt((t&127)<<3):g=t,g}};function a(h,t,g){if(g>t){var l=new Error("Too few bytes to parse DER.");throw l.available=h.length(),l.remaining=t,l.requested=g,l}}var d=function(h,t){var g=h.getByte();if(t--,g!==128){var l,x=g&128;if(!x)l=g;else{var k=g&127;a(h,t,k),l=h.getInt(k<<3)}if(l<0)throw new Error("Negative length: "+l);return l}};e.fromDer=function(h,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof h=="string"&&(h=n.util.createBuffer(h));var g=h.length(),l=_(h,h.length(),0,t);if(t.parseAllBytes&&h.length()!==0){var x=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw x.byteCount=g,x.remaining=h.length(),x}return l};function _(h,t,g,l){var x;a(h,t,2);var k=h.getByte();t--;var E=k&192,u=k&31;x=h.length();var y=d(h,t);if(t-=x-h.length(),y!==void 0&&y>t){if(l.strict){var C=new Error("Too few bytes to read ASN.1 value.");throw C.available=h.length(),C.remaining=t,C.requested=y,C}y=t}var m,s,p=(k&32)===32;if(p)if(m=[],y===void 0)for(;;){if(a(h,t,2),h.bytes(2)==="\0\0"){h.getBytes(2),t-=2;break}x=h.length(),m.push(_(h,t,g+1,l)),t-=x-h.length()}else for(;y>0;)x=h.length(),m.push(_(h,y,g+1,l)),t-=x-h.length(),y-=x-h.length();if(m===void 0&&E===e.Class.UNIVERSAL&&u===e.Type.BITSTRING&&(s=h.bytes(y)),m===void 0&&l.decodeBitStrings&&E===e.Class.UNIVERSAL&&u===e.Type.BITSTRING&&y>1){var v=h.read,I=t,R=0;if(u===e.Type.BITSTRING&&(a(h,t,1),R=h.getByte(),t--),R===0)try{x=h.length();var c={strict:!0,decodeBitStrings:!0},i=_(h,t,g+1,c),r=x-h.length();t-=r,u==e.Type.BITSTRING&&r++;var B=i.tagClass;r===y&&(B===e.Class.UNIVERSAL||B===e.Class.CONTEXT_SPECIFIC)&&(m=[i])}catch{}m===void 0&&(h.read=v,t=I)}if(m===void 0){if(y===void 0){if(l.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");y=t}if(u===e.Type.BMPSTRING)for(m="";y>0;y-=2)a(h,t,2),m+=String.fromCharCode(h.getInt16()),t-=2;else m=h.getBytes(y),t-=y}var D=s===void 0?null:{bitStringContents:s};return e.create(E,u,p,m,D)}e.toDer=function(h){var t=n.util.createBuffer(),g=h.tagClass|h.type,l=n.util.createBuffer(),x=!1;if("bitStringContents"in h&&(x=!0,h.original&&(x=e.equals(h,h.original))),x)l.putBytes(h.bitStringContents);else if(h.composed){h.constructed?g|=32:l.putByte(0);for(var k=0;k<h.value.length;++k)h.value[k]!==void 0&&l.putBuffer(e.toDer(h.value[k]))}else if(h.type===e.Type.BMPSTRING)for(var k=0;k<h.value.length;++k)l.putInt16(h.value.charCodeAt(k));else h.type===e.Type.INTEGER&&h.value.length>1&&(h.value.charCodeAt(0)===0&&!(h.value.charCodeAt(1)&128)||h.value.charCodeAt(0)===255&&(h.value.charCodeAt(1)&128)===128)?l.putBytes(h.value.substr(1)):l.putBytes(h.value);if(t.putByte(g),l.length()<=127)t.putByte(l.length()&127);else{var E=l.length(),u="";do u+=String.fromCharCode(E&255),E=E>>>8;while(E>0);t.putByte(u.length|128);for(var k=u.length-1;k>=0;--k)t.putByte(u.charCodeAt(k))}return t.putBuffer(l),t},e.oidToDer=function(h){var t=h.split("."),g=n.util.createBuffer();g.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var l,x,k,E,u=2;u<t.length;++u){l=!0,x=[],k=parseInt(t[u],10);do E=k&127,k=k>>>7,l||(E|=128),x.push(E),l=!1;while(k>0);for(var y=x.length-1;y>=0;--y)g.putByte(x[y])}return g},e.derToOid=function(h){var t;typeof h=="string"&&(h=n.util.createBuffer(h));var g=h.getByte();t=Math.floor(g/40)+"."+g%40;for(var l=0;h.length()>0;)g=h.getByte(),l=l<<7,g&128?l+=g&127:(t+="."+(l+g),l=0);return t},e.utcTimeToDate=function(h){var t=new Date,g=parseInt(h.substr(0,2),10);g=g>=50?1900+g:2e3+g;var l=parseInt(h.substr(2,2),10)-1,x=parseInt(h.substr(4,2),10),k=parseInt(h.substr(6,2),10),E=parseInt(h.substr(8,2),10),u=0;if(h.length>11){var y=h.charAt(10),C=10;y!=="+"&&y!=="-"&&(u=parseInt(h.substr(10,2),10),C+=2)}if(t.setUTCFullYear(g,l,x),t.setUTCHours(k,E,u,0),C&&(y=h.charAt(C),y==="+"||y==="-")){var m=parseInt(h.substr(C+1,2),10),s=parseInt(h.substr(C+4,2),10),p=m*60+s;p*=6e4,y==="+"?t.setTime(+t-p):t.setTime(+t+p)}return t},e.generalizedTimeToDate=function(h){var t=new Date,g=parseInt(h.substr(0,4),10),l=parseInt(h.substr(4,2),10)-1,x=parseInt(h.substr(6,2),10),k=parseInt(h.substr(8,2),10),E=parseInt(h.substr(10,2),10),u=parseInt(h.substr(12,2),10),y=0,C=0,m=!1;h.charAt(h.length-1)==="Z"&&(m=!0);var s=h.length-5,p=h.charAt(s);if(p==="+"||p==="-"){var v=parseInt(h.substr(s+1,2),10),I=parseInt(h.substr(s+4,2),10);C=v*60+I,C*=6e4,p==="+"&&(C*=-1),m=!0}return h.charAt(14)==="."&&(y=parseFloat(h.substr(14),10)*1e3),m?(t.setUTCFullYear(g,l,x),t.setUTCHours(k,E,u,y),t.setTime(+t+C)):(t.setFullYear(g,l,x),t.setHours(k,E,u,y)),t},e.dateToUtcTime=function(h){if(typeof h=="string")return h;var t="",g=[];g.push((""+h.getUTCFullYear()).substr(2)),g.push(""+(h.getUTCMonth()+1)),g.push(""+h.getUTCDate()),g.push(""+h.getUTCHours()),g.push(""+h.getUTCMinutes()),g.push(""+h.getUTCSeconds());for(var l=0;l<g.length;++l)g[l].length<2&&(t+="0"),t+=g[l];return t+="Z",t},e.dateToGeneralizedTime=function(h){if(typeof h=="string")return h;var t="",g=[];g.push(""+h.getUTCFullYear()),g.push(""+(h.getUTCMonth()+1)),g.push(""+h.getUTCDate()),g.push(""+h.getUTCHours()),g.push(""+h.getUTCMinutes()),g.push(""+h.getUTCSeconds());for(var l=0;l<g.length;++l)g[l].length<2&&(t+="0"),t+=g[l];return t+="Z",t},e.integerToDer=function(h){var t=n.util.createBuffer();if(h>=-128&&h<128)return t.putSignedInt(h,8);if(h>=-32768&&h<32768)return t.putSignedInt(h,16);if(h>=-8388608&&h<8388608)return t.putSignedInt(h,24);if(h>=-2147483648&&h<2147483648)return t.putSignedInt(h,32);var g=new Error("Integer too large; max is 32-bits.");throw g.integer=h,g},e.derToInteger=function(h){typeof h=="string"&&(h=n.util.createBuffer(h));var t=h.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return h.getSignedInt(t)},e.validate=function(h,t,g,l){var x=!1;if((h.tagClass===t.tagClass||typeof t.tagClass>"u")&&(h.type===t.type||typeof t.type>"u"))if(h.constructed===t.constructed||typeof t.constructed>"u"){if(x=!0,t.value&&n.util.isArray(t.value))for(var k=0,E=0;x&&E<t.value.length;++E)x=t.value[E].optional||!1,h.value[k]&&(x=e.validate(h.value[k],t.value[E],g,l),x?++k:t.value[E].optional&&(x=!0)),!x&&l&&l.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+h.value.length+'"');if(x&&g&&(t.capture&&(g[t.capture]=h.value),t.captureAsn1&&(g[t.captureAsn1]=h),t.captureBitStringContents&&"bitStringContents"in h&&(g[t.captureBitStringContents]=h.bitStringContents),t.captureBitStringValue&&"bitStringContents"in h))if(h.bitStringContents.length<2)g[t.captureBitStringValue]="";else{var u=h.bitStringContents.charCodeAt(0);if(u!==0)throw new Error("captureBitStringValue only supported for zero unused bits");g[t.captureBitStringValue]=h.bitStringContents.slice(1)}}else l&&l.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+h.constructed+'"');else l&&(h.tagClass!==t.tagClass&&l.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+h.tagClass+'"'),h.type!==t.type&&l.push("["+t.name+'] Expected type "'+t.type+'", got "'+h.type+'"'));return x};var S=/[^\\u0000-\\u00ff]/;return e.prettyPrint=function(h,t,g){var l="";t=t||0,g=g||2,t>0&&(l+=`
`);for(var x="",k=0;k<t*g;++k)x+=" ";switch(l+=x+"Tag: ",h.tagClass){case e.Class.UNIVERSAL:l+="Universal:";break;case e.Class.APPLICATION:l+="Application:";break;case e.Class.CONTEXT_SPECIFIC:l+="Context-Specific:";break;case e.Class.PRIVATE:l+="Private:";break}if(h.tagClass===e.Class.UNIVERSAL)switch(l+=h.type,h.type){case e.Type.NONE:l+=" (None)";break;case e.Type.BOOLEAN:l+=" (Boolean)";break;case e.Type.INTEGER:l+=" (Integer)";break;case e.Type.BITSTRING:l+=" (Bit string)";break;case e.Type.OCTETSTRING:l+=" (Octet string)";break;case e.Type.NULL:l+=" (Null)";break;case e.Type.OID:l+=" (Object Identifier)";break;case e.Type.ODESC:l+=" (Object Descriptor)";break;case e.Type.EXTERNAL:l+=" (External or Instance of)";break;case e.Type.REAL:l+=" (Real)";break;case e.Type.ENUMERATED:l+=" (Enumerated)";break;case e.Type.EMBEDDED:l+=" (Embedded PDV)";break;case e.Type.UTF8:l+=" (UTF8)";break;case e.Type.ROID:l+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:l+=" (Sequence)";break;case e.Type.SET:l+=" (Set)";break;case e.Type.PRINTABLESTRING:l+=" (Printable String)";break;case e.Type.IA5String:l+=" (IA5String (ASCII))";break;case e.Type.UTCTIME:l+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:l+=" (Generalized time)";break;case e.Type.BMPSTRING:l+=" (BMP String)";break}else l+=h.type;if(l+=`
`,l+=x+"Constructed: "+h.constructed+`
`,h.composed){for(var E=0,u="",k=0;k<h.value.length;++k)h.value[k]!==void 0&&(E+=1,u+=e.prettyPrint(h.value[k],t+1,g),k+1<h.value.length&&(u+=","));l+=x+"Sub values: "+E+u}else{if(l+=x+"Value: ",h.type===e.Type.OID){var y=e.derToOid(h.value);l+=y,n.pki&&n.pki.oids&&y in n.pki.oids&&(l+=" ("+n.pki.oids[y]+") ")}if(h.type===e.Type.INTEGER)try{l+=e.derToInteger(h.value)}catch{l+="0x"+n.util.bytesToHex(h.value)}else if(h.type===e.Type.BITSTRING){if(h.value.length>1?l+="0x"+n.util.bytesToHex(h.value.slice(1)):l+="(none)",h.value.length>0){var C=h.value.charCodeAt(0);C==1?l+=" (1 unused bit shown)":C>1&&(l+=" ("+C+" unused bits shown)")}}else if(h.type===e.Type.OCTETSTRING)S.test(h.value)||(l+="("+h.value+") "),l+="0x"+n.util.bytesToHex(h.value);else if(h.type===e.Type.UTF8)try{l+=n.util.decodeUtf8(h.value)}catch(m){if(m.message==="URI malformed")l+="0x"+n.util.bytesToHex(h.value)+" (malformed UTF8)";else throw m}else h.type===e.Type.PRINTABLESTRING||h.type===e.Type.IA5String?l+=h.value:S.test(h.value)?l+="0x"+n.util.bytesToHex(h.value):h.value.length===0?l+="[null]":l+=h.value}return l},Vt.exports}var Ft={exports:{}},Kt,wr;function ot(){if(wr)return Kt;wr=1;var n=fe();return Kt=n.md=n.md||{},n.md.algorithms=n.md.algorithms||{},Kt}var Lr;function mt(){if(Lr)return Ft.exports;Lr=1;var n=fe();ot(),pe();var e=Ft.exports=n.hmac=n.hmac||{};return e.create=function(){var a=null,d=null,_=null,S=null,h={};return h.start=function(t,g){if(t!==null)if(typeof t=="string")if(t=t.toLowerCase(),t in n.md.algorithms)d=n.md.algorithms[t].create();else throw new Error('Unknown hash algorithm "'+t+'"');else d=t;if(g===null)g=a;else{if(typeof g=="string")g=n.util.createBuffer(g);else if(n.util.isArray(g)){var l=g;g=n.util.createBuffer();for(var x=0;x<l.length;++x)g.putByte(l[x])}var k=g.length();k>d.blockLength&&(d.start(),d.update(g.bytes()),g=d.digest()),_=n.util.createBuffer(),S=n.util.createBuffer(),k=g.length();for(var x=0;x<k;++x){var l=g.at(x);_.putByte(54^l),S.putByte(92^l)}if(k<d.blockLength)for(var l=d.blockLength-k,x=0;x<l;++x)_.putByte(54),S.putByte(92);a=g,_=_.bytes(),S=S.bytes()}d.start(),d.update(_)},h.update=function(t){d.update(t)},h.getMac=function(){var t=d.digest().bytes();return d.start(),d.update(S),d.update(t),d.digest()},h.digest=h.getMac,h},Ft.exports}var Mt={exports:{}},Dr;function mr(){if(Dr)return Mt.exports;Dr=1;var n=fe();ot(),pe();var e=Mt.exports=n.md5=n.md5||{};n.md.md5=n.md.algorithms.md5=e,e.create=function(){h||t();var l=null,x=n.util.createBuffer(),k=new Array(16),E={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return E.start=function(){E.messageLength=0,E.fullMessageLength=E.messageLength64=[];for(var u=E.messageLengthSize/4,y=0;y<u;++y)E.fullMessageLength.push(0);return x=n.util.createBuffer(),l={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},E},E.start(),E.update=function(u,y){y==="utf8"&&(u=n.util.encodeUtf8(u));var C=u.length;E.messageLength+=C,C=[C/4294967296>>>0,C>>>0];for(var m=E.fullMessageLength.length-1;m>=0;--m)E.fullMessageLength[m]+=C[1],C[1]=C[0]+(E.fullMessageLength[m]/4294967296>>>0),E.fullMessageLength[m]=E.fullMessageLength[m]>>>0,C[0]=C[1]/4294967296>>>0;return x.putBytes(u),g(l,k,x),(x.read>2048||x.length()===0)&&x.compact(),E},E.digest=function(){var u=n.util.createBuffer();u.putBytes(x.bytes());var y=E.fullMessageLength[E.fullMessageLength.length-1]+E.messageLengthSize,C=y&E.blockLength-1;u.putBytes(a.substr(0,E.blockLength-C));for(var m,s=0,p=E.fullMessageLength.length-1;p>=0;--p)m=E.fullMessageLength[p]*8+s,s=m/4294967296>>>0,u.putInt32Le(m>>>0);var v={h0:l.h0,h1:l.h1,h2:l.h2,h3:l.h3};g(v,k,u);var I=n.util.createBuffer();return I.putInt32Le(v.h0),I.putInt32Le(v.h1),I.putInt32Le(v.h2),I.putInt32Le(v.h3),I},E};var a=null,d=null,_=null,S=null,h=!1;function t(){a="",a+=n.util.fillString("\0",64),d=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],_=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],S=new Array(64);for(var l=0;l<64;++l)S[l]=Math.floor(Math.abs(Math.sin(l+1))*4294967296);h=!0}function g(l,x,k){for(var E,u,y,C,m,s,p,v,I=k.length();I>=64;){for(u=l.h0,y=l.h1,C=l.h2,m=l.h3,v=0;v<16;++v)x[v]=k.getInt32Le(),s=m^y&(C^m),E=u+s+S[v]+x[v],p=_[v],u=m,m=C,C=y,y+=E<<p|E>>>32-p;for(;v<32;++v)s=C^m&(y^C),E=u+s+S[v]+x[d[v]],p=_[v],u=m,m=C,C=y,y+=E<<p|E>>>32-p;for(;v<48;++v)s=y^C^m,E=u+s+S[v]+x[d[v]],p=_[v],u=m,m=C,C=y,y+=E<<p|E>>>32-p;for(;v<64;++v)s=C^(y|~m),E=u+s+S[v]+x[d[v]],p=_[v],u=m,m=C,C=y,y+=E<<p|E>>>32-p;l.h0=l.h0+u|0,l.h1=l.h1+y|0,l.h2=l.h2+C|0,l.h3=l.h3+m|0,I-=64}}return Mt.exports}var qt={exports:{}},kr;function yt(){if(kr)return qt.exports;kr=1;var n=fe();pe();var e=qt.exports=n.pem=n.pem||{};e.encode=function(_,S){S=S||{};var h="-----BEGIN "+_.type+`-----\r
`,t;if(_.procType&&(t={name:"Proc-Type",values:[String(_.procType.version),_.procType.type]},h+=a(t)),_.contentDomain&&(t={name:"Content-Domain",values:[_.contentDomain]},h+=a(t)),_.dekInfo&&(t={name:"DEK-Info",values:[_.dekInfo.algorithm]},_.dekInfo.parameters&&t.values.push(_.dekInfo.parameters),h+=a(t)),_.headers)for(var g=0;g<_.headers.length;++g)h+=a(_.headers[g]);return _.procType&&(h+=`\r
`),h+=n.util.encode64(_.body,S.maxline||64)+`\r
`,h+="-----END "+_.type+`-----\r
`,h},e.decode=function(_){for(var S=[],h=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,t=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,g=/\r?\n/,l;l=h.exec(_),!!l;){var x=l[1];x==="NEW CERTIFICATE REQUEST"&&(x="CERTIFICATE REQUEST");var k={type:x,procType:null,contentDomain:null,dekInfo:null,headers:[],body:n.util.decode64(l[3])};if(S.push(k),!!l[2]){for(var E=l[2].split(g),u=0;l&&u<E.length;){for(var y=E[u].replace(/\s+$/,""),C=u+1;C<E.length;++C){var m=E[C];if(!/\s/.test(m[0]))break;y+=m,u=C}if(l=y.match(t),l){for(var s={name:l[1],values:[]},p=l[2].split(","),v=0;v<p.length;++v)s.values.push(d(p[v]));if(k.procType)if(!k.contentDomain&&s.name==="Content-Domain")k.contentDomain=p[0]||"";else if(!k.dekInfo&&s.name==="DEK-Info"){if(s.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');k.dekInfo={algorithm:p[0],parameters:p[1]||null}}else k.headers.push(s);else{if(s.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(s.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');k.procType={version:p[0],type:p[1]}}}++u}if(k.procType==="ENCRYPTED"&&!k.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(S.length===0)throw new Error("Invalid PEM formatted message.");return S};function a(_){for(var S=_.name+": ",h=[],t=function(E,u){return" "+u},g=0;g<_.values.length;++g)h.push(_.values[g].replace(/^(\S+\r\n)/,t));S+=h.join(",")+`\r
`;for(var l=0,x=-1,g=0;g<S.length;++g,++l)if(l>65&&x!==-1){var k=S[x];k===","?(++x,S=S.substr(0,x)+`\r
 `+S.substr(x)):S=S.substr(0,x)+`\r
`+k+S.substr(x+1),l=g-x-1,x=-1,++g}else(S[g]===" "||S[g]==="	"||S[g]===",")&&(x=g);return S}function d(_){return _.replace(/^\s+/,"")}return qt.exports}var Ht={exports:{}},Gt,Ur;function Bt(){if(Ur)return Gt;Ur=1;var n=fe();gr(),ca(),pe(),Gt=n.des=n.des||{},n.des.startEncrypting=function(u,y,C,m){var s=E({key:u,output:C,decrypt:!1,mode:m||(y===null?"ECB":"CBC")});return s.start(y),s},n.des.createEncryptionCipher=function(u,y){return E({key:u,output:null,decrypt:!1,mode:y})},n.des.startDecrypting=function(u,y,C,m){var s=E({key:u,output:C,decrypt:!0,mode:m||(y===null?"ECB":"CBC")});return s.start(y),s},n.des.createDecryptionCipher=function(u,y){return E({key:u,output:null,decrypt:!0,mode:y})},n.des.Algorithm=function(u,y){var C=this;C.name=u,C.mode=new y({blockSize:8,cipher:{encrypt:function(m,s){return k(C._keys,m,s,!1)},decrypt:function(m,s){return k(C._keys,m,s,!0)}}}),C._init=!1},n.des.Algorithm.prototype.initialize=function(u){if(!this._init){var y=n.util.createBuffer(u.key);if(this.name.indexOf("3DES")===0&&y.length()!==24)throw new Error("Invalid Triple-DES key size: "+y.length()*8);this._keys=x(y),this._init=!0}},e("DES-ECB",n.cipher.modes.ecb),e("DES-CBC",n.cipher.modes.cbc),e("DES-CFB",n.cipher.modes.cfb),e("DES-OFB",n.cipher.modes.ofb),e("DES-CTR",n.cipher.modes.ctr),e("3DES-ECB",n.cipher.modes.ecb),e("3DES-CBC",n.cipher.modes.cbc),e("3DES-CFB",n.cipher.modes.cfb),e("3DES-OFB",n.cipher.modes.ofb),e("3DES-CTR",n.cipher.modes.ctr);function e(u,y){var C=function(){return new n.des.Algorithm(u,y)};n.cipher.registerAlgorithm(u,C)}var a=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],d=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],_=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],S=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],h=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],t=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],g=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],l=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function x(u){for(var y=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],C=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],m=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],s=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],p=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],v=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],I=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],R=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],i=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],r=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],B=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],D=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],V=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],L=u.length()>8?3:1,O=[],q=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],M=0,H,Y=0;Y<L;Y++){var W=u.getInt32(),Z=u.getInt32();H=(W>>>4^Z)&252645135,Z^=H,W^=H<<4,H=(Z>>>-16^W)&65535,W^=H,Z^=H<<-16,H=(W>>>2^Z)&858993459,Z^=H,W^=H<<2,H=(Z>>>-16^W)&65535,W^=H,Z^=H<<-16,H=(W>>>1^Z)&1431655765,Z^=H,W^=H<<1,H=(Z>>>8^W)&16711935,W^=H,Z^=H<<8,H=(W>>>1^Z)&1431655765,Z^=H,W^=H<<1,H=W<<8|Z>>>20&240,W=Z<<24|Z<<8&16711680|Z>>>8&65280|Z>>>24&240,Z=H;for(var ne=0;ne<q.length;++ne){q[ne]?(W=W<<2|W>>>26,Z=Z<<2|Z>>>26):(W=W<<1|W>>>27,Z=Z<<1|Z>>>27),W&=-15,Z&=-15;var se=y[W>>>28]|C[W>>>24&15]|m[W>>>20&15]|s[W>>>16&15]|p[W>>>12&15]|v[W>>>8&15]|I[W>>>4&15],he=R[Z>>>28]|c[Z>>>24&15]|i[Z>>>20&15]|r[Z>>>16&15]|B[Z>>>12&15]|D[Z>>>8&15]|V[Z>>>4&15];H=(he>>>16^se)&65535,O[M++]=se^H,O[M++]=he^H<<16}}return O}function k(u,y,C,m){var s=u.length===32?3:9,p;s===3?p=m?[30,-2,-2]:[0,32,2]:p=m?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var v,I=y[0],R=y[1];v=(I>>>4^R)&252645135,R^=v,I^=v<<4,v=(I>>>16^R)&65535,R^=v,I^=v<<16,v=(R>>>2^I)&858993459,I^=v,R^=v<<2,v=(R>>>8^I)&16711935,I^=v,R^=v<<8,v=(I>>>1^R)&1431655765,R^=v,I^=v<<1,I=I<<1|I>>>31,R=R<<1|R>>>31;for(var c=0;c<s;c+=3){for(var i=p[c+1],r=p[c+2],B=p[c];B!=i;B+=r){var D=R^u[B],V=(R>>>4|R<<28)^u[B+1];v=I,I=R,R=v^(d[D>>>24&63]|S[D>>>16&63]|t[D>>>8&63]|l[D&63]|a[V>>>24&63]|_[V>>>16&63]|h[V>>>8&63]|g[V&63])}v=I,I=R,R=v}I=I>>>1|I<<31,R=R>>>1|R<<31,v=(I>>>1^R)&1431655765,R^=v,I^=v<<1,v=(R>>>8^I)&16711935,I^=v,R^=v<<8,v=(R>>>2^I)&858993459,I^=v,R^=v<<2,v=(I>>>16^R)&65535,R^=v,I^=v<<16,v=(I>>>4^R)&252645135,R^=v,I^=v<<4,C[0]=I,C[1]=R}function E(u){u=u||{};var y=(u.mode||"CBC").toUpperCase(),C="DES-"+y,m;u.decrypt?m=n.cipher.createDecipher(C,u.key):m=n.cipher.createCipher(C,u.key);var s=m.start;return m.start=function(p,v){var I=null;v instanceof n.util.ByteBuffer&&(I=v,v={}),v=v||{},v.output=I,v.iv=p,s.call(m,v)},m}return Gt}const Ga={},Qa=Object.freeze(Object.defineProperty({__proto__:null,default:Ga},Symbol.toStringTag,{value:"Module"})),Cr=Ma(Qa);var Qt,Pr;function Er(){if(Pr)return Qt;Pr=1;var n=fe();mt(),ot(),pe();var e=n.pkcs5=n.pkcs5||{},a;return n.util.isNodejs&&!n.options.usePureJavaScript&&(a=Cr),Qt=n.pbkdf2=e.pbkdf2=function(d,_,S,h,t,g){if(typeof t=="function"&&(g=t,t=null),n.util.isNodejs&&!n.options.usePureJavaScript&&a.pbkdf2&&(t===null||typeof t!="object")&&(a.pbkdf2Sync.length>4||!t||t==="sha1"))return typeof t!="string"&&(t="sha1"),d=Buffer.from(d,"binary"),_=Buffer.from(_,"binary"),g?a.pbkdf2Sync.length===4?a.pbkdf2(d,_,S,h,function(c,i){if(c)return g(c);g(null,i.toString("binary"))}):a.pbkdf2(d,_,S,h,t,function(c,i){if(c)return g(c);g(null,i.toString("binary"))}):a.pbkdf2Sync.length===4?a.pbkdf2Sync(d,_,S,h).toString("binary"):a.pbkdf2Sync(d,_,S,h,t).toString("binary");if((typeof t>"u"||t===null)&&(t="sha1"),typeof t=="string"){if(!(t in n.md.algorithms))throw new Error("Unknown hash algorithm: "+t);t=n.md[t].create()}var l=t.digestLength;if(h>4294967295*l){var x=new Error("Derived key is too long.");if(g)return g(x);throw x}var k=Math.ceil(h/l),E=h-(k-1)*l,u=n.hmac.create();u.start(t,d);var y="",C,m,s;if(!g){for(var p=1;p<=k;++p){u.start(null,null),u.update(_),u.update(n.util.int32ToBytes(p)),C=s=u.digest().getBytes();for(var v=2;v<=S;++v)u.start(null,null),u.update(s),m=u.digest().getBytes(),C=n.util.xorBytes(C,m,l),s=m;y+=p<k?C:C.substr(0,E)}return y}var p=1,v;function I(){if(p>k)return g(null,y);u.start(null,null),u.update(_),u.update(n.util.int32ToBytes(p)),C=s=u.digest().getBytes(),v=2,R()}function R(){if(v<=S)return u.start(null,null),u.update(s),m=u.digest().getBytes(),C=n.util.xorBytes(C,m,l),s=m,++v,n.util.setImmediate(R);y+=p<k?C:C.substr(0,E),++p,I()}I()},Qt}var Tt={exports:{}},zt={exports:{}},Vr;function ha(){if(Vr)return zt.exports;Vr=1;var n=fe();ot(),pe();var e=zt.exports=n.sha256=n.sha256||{};n.md.sha256=n.md.algorithms.sha256=e,e.create=function(){d||S();var t=null,g=n.util.createBuffer(),l=new Array(64),x={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return x.start=function(){x.messageLength=0,x.fullMessageLength=x.messageLength64=[];for(var k=x.messageLengthSize/4,E=0;E<k;++E)x.fullMessageLength.push(0);return g=n.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},x},x.start(),x.update=function(k,E){E==="utf8"&&(k=n.util.encodeUtf8(k));var u=k.length;x.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var y=x.fullMessageLength.length-1;y>=0;--y)x.fullMessageLength[y]+=u[1],u[1]=u[0]+(x.fullMessageLength[y]/4294967296>>>0),x.fullMessageLength[y]=x.fullMessageLength[y]>>>0,u[0]=u[1]/4294967296>>>0;return g.putBytes(k),h(t,l,g),(g.read>2048||g.length()===0)&&g.compact(),x},x.digest=function(){var k=n.util.createBuffer();k.putBytes(g.bytes());var E=x.fullMessageLength[x.fullMessageLength.length-1]+x.messageLengthSize,u=E&x.blockLength-1;k.putBytes(a.substr(0,x.blockLength-u));for(var y,C,m=x.fullMessageLength[0]*8,s=0;s<x.fullMessageLength.length-1;++s)y=x.fullMessageLength[s+1]*8,C=y/4294967296>>>0,m+=C,k.putInt32(m>>>0),m=y>>>0;k.putInt32(m);var p={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};h(p,l,k);var v=n.util.createBuffer();return v.putInt32(p.h0),v.putInt32(p.h1),v.putInt32(p.h2),v.putInt32(p.h3),v.putInt32(p.h4),v.putInt32(p.h5),v.putInt32(p.h6),v.putInt32(p.h7),v},x};var a=null,d=!1,_=null;function S(){a="",a+=n.util.fillString("\0",64),_=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],d=!0}function h(t,g,l){for(var x,k,E,u,y,C,m,s,p,v,I,R,c,i,r,B=l.length();B>=64;){for(m=0;m<16;++m)g[m]=l.getInt32();for(;m<64;++m)x=g[m-2],x=(x>>>17|x<<15)^(x>>>19|x<<13)^x>>>10,k=g[m-15],k=(k>>>7|k<<25)^(k>>>18|k<<14)^k>>>3,g[m]=x+g[m-7]+k+g[m-16]|0;for(s=t.h0,p=t.h1,v=t.h2,I=t.h3,R=t.h4,c=t.h5,i=t.h6,r=t.h7,m=0;m<64;++m)u=(R>>>6|R<<26)^(R>>>11|R<<21)^(R>>>25|R<<7),y=i^R&(c^i),E=(s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10),C=s&p|v&(s^p),x=r+u+y+_[m]+g[m],k=E+C,r=i,i=c,c=R,R=I+x>>>0,I=v,v=p,p=s,s=x+k>>>0;t.h0=t.h0+s|0,t.h1=t.h1+p|0,t.h2=t.h2+v|0,t.h3=t.h3+I|0,t.h4=t.h4+R|0,t.h5=t.h5+c|0,t.h6=t.h6+i|0,t.h7=t.h7+r|0,B-=64}}return zt.exports}var Yt={exports:{}},Or;function pa(){if(Or)return Yt.exports;Or=1;var n=fe();pe();var e=null;n.util.isNodejs&&!n.options.usePureJavaScript&&!process.versions["node-webkit"]&&(e=Cr);var a=Yt.exports=n.prng=n.prng||{};return a.create=function(d){for(var _={plugin:d,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},S=d.md,h=new Array(32),t=0;t<32;++t)h[t]=S.create();_.pools=h,_.pool=0,_.generate=function(E,u){if(!u)return _.generateSync(E);var y=_.plugin.cipher,C=_.plugin.increment,m=_.plugin.formatKey,s=_.plugin.formatSeed,p=n.util.createBuffer();_.key=null,v();function v(I){if(I)return u(I);if(p.length()>=E)return u(null,p.getBytes(E));if(_.generated>1048575&&(_.key=null),_.key===null)return n.util.nextTick(function(){g(v)});var R=y(_.key,_.seed);_.generated+=R.length,p.putBytes(R),_.key=m(y(_.key,C(_.seed))),_.seed=s(y(_.key,_.seed)),n.util.setImmediate(v)}},_.generateSync=function(E){var u=_.plugin.cipher,y=_.plugin.increment,C=_.plugin.formatKey,m=_.plugin.formatSeed;_.key=null;for(var s=n.util.createBuffer();s.length()<E;){_.generated>1048575&&(_.key=null),_.key===null&&l();var p=u(_.key,_.seed);_.generated+=p.length,s.putBytes(p),_.key=C(u(_.key,y(_.seed))),_.seed=m(u(_.key,_.seed))}return s.getBytes(E)};function g(E){if(_.pools[0].messageLength>=32)return x(),E();var u=32-_.pools[0].messageLength<<5;_.seedFile(u,function(y,C){if(y)return E(y);_.collect(C),x(),E()})}function l(){if(_.pools[0].messageLength>=32)return x();var E=32-_.pools[0].messageLength<<5;_.collect(_.seedFileSync(E)),x()}function x(){_.reseeds=_.reseeds===4294967295?0:_.reseeds+1;var E=_.plugin.md.create();E.update(_.keyBytes);for(var u=1,y=0;y<32;++y)_.reseeds%u===0&&(E.update(_.pools[y].digest().getBytes()),_.pools[y].start()),u=u<<1;_.keyBytes=E.digest().getBytes(),E.start(),E.update(_.keyBytes);var C=E.digest().getBytes();_.key=_.plugin.formatKey(_.keyBytes),_.seed=_.plugin.formatSeed(C),_.generated=0}function k(E){var u=null,y=n.util.globalScope,C=y.crypto||y.msCrypto;C&&C.getRandomValues&&(u=function(r){return C.getRandomValues(r)});var m=n.util.createBuffer();if(u)for(;m.length()<E;){var s=Math.max(1,Math.min(E-m.length(),65536)/4),p=new Uint32Array(Math.floor(s));try{u(p);for(var v=0;v<p.length;++v)m.putInt32(p[v])}catch(r){if(!(typeof QuotaExceededError<"u"&&r instanceof QuotaExceededError))throw r}}if(m.length()<E)for(var I,R,c,i=Math.floor(Math.random()*65536);m.length()<E;){R=16807*(i&65535),I=16807*(i>>16),R+=(I&32767)<<16,R+=I>>15,R=(R&2147483647)+(R>>31),i=R&4294967295;for(var v=0;v<3;++v)c=i>>>(v<<3),c^=Math.floor(Math.random()*256),m.putByte(c&255)}return m.getBytes(E)}return e?(_.seedFile=function(E,u){e.randomBytes(E,function(y,C){if(y)return u(y);u(null,C.toString())})},_.seedFileSync=function(E){return e.randomBytes(E).toString()}):(_.seedFile=function(E,u){try{u(null,k(E))}catch(y){u(y)}},_.seedFileSync=k),_.collect=function(E){for(var u=E.length,y=0;y<u;++y)_.pools[_.pool].update(E.substr(y,1)),_.pool=_.pool===31?0:_.pool+1},_.collectInt=function(E,u){for(var y="",C=0;C<u;C+=8)y+=String.fromCharCode(E>>C&255);_.collect(y)},_.registerWorker=function(E){if(E===self)_.seedFile=function(y,C){function m(s){var p=s.data;p.forge&&p.forge.prng&&(self.removeEventListener("message",m),C(p.forge.prng.err,p.forge.prng.bytes))}self.addEventListener("message",m),self.postMessage({forge:{prng:{needed:y}}})};else{var u=function(y){var C=y.data;C.forge&&C.forge.prng&&_.seedFile(C.forge.prng.needed,function(m,s){E.postMessage({forge:{prng:{err:m,bytes:s}}})})};E.addEventListener("message",u)}},_},Yt.exports}var Fr;function Je(){if(Fr)return Tt.exports;Fr=1;var n=fe();return ht(),ha(),pa(),pe(),function(){if(n.random&&n.random.getBytes){Tt.exports=n.random;return}(function(e){var a={},d=new Array(4),_=n.util.createBuffer();a.formatKey=function(E){var u=n.util.createBuffer(E);return E=new Array(4),E[0]=u.getInt32(),E[1]=u.getInt32(),E[2]=u.getInt32(),E[3]=u.getInt32(),n.aes._expandKey(E,!1)},a.formatSeed=function(E){var u=n.util.createBuffer(E);return E=new Array(4),E[0]=u.getInt32(),E[1]=u.getInt32(),E[2]=u.getInt32(),E[3]=u.getInt32(),E},a.cipher=function(E,u){return n.aes._updateBlock(E,u,d,!1),_.putInt32(d[0]),_.putInt32(d[1]),_.putInt32(d[2]),_.putInt32(d[3]),_.getBytes()},a.increment=function(E){return++E[3],E},a.md=n.md.sha256;function S(){var E=n.prng.create(a);return E.getBytes=function(u,y){return E.generate(u,y)},E.getBytesSync=function(u){return E.generate(u)},E}var h=S(),t=null,g=n.util.globalScope,l=g.crypto||g.msCrypto;if(l&&l.getRandomValues&&(t=function(E){return l.getRandomValues(E)}),n.options.usePureJavaScript||!n.util.isNodejs&&!t){if(h.collectInt(+new Date,32),typeof navigator<"u"){var x="";for(var k in navigator)try{typeof navigator[k]=="string"&&(x+=navigator[k])}catch{}h.collect(x),x=null}e&&(e().mousemove(function(E){h.collectInt(E.clientX,16),h.collectInt(E.clientY,16)}),e().keypress(function(E){h.collectInt(E.charCode,8)}))}if(!n.random)n.random=h;else for(var k in h)n.random[k]=h[k];n.random.createInstance=S,Tt.exports=n.random})(typeof jQuery<"u"?jQuery:null)}(),Tt.exports}var Xt,Kr;function da(){if(Kr)return Xt;Kr=1;var n=fe();pe();var e=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],a=[1,2,3,5],d=function(h,t){return h<<t&65535|(h&65535)>>16-t},_=function(h,t){return(h&65535)>>t|h<<16-t&65535};Xt=n.rc2=n.rc2||{},n.rc2.expandKey=function(h,t){typeof h=="string"&&(h=n.util.createBuffer(h)),t=t||128;var g=h,l=h.length(),x=t,k=Math.ceil(x/8),E=255>>(x&7),u;for(u=l;u<128;u++)g.putByte(e[g.at(u-1)+g.at(u-l)&255]);for(g.setAt(128-k,e[g.at(128-k)&E]),u=127-k;u>=0;u--)g.setAt(u,e[g.at(u+1)^g.at(u+k)]);return g};var S=function(h,t,g){var l=!1,x=null,k=null,E=null,u,y,C,m,s=[];for(h=n.rc2.expandKey(h,t),C=0;C<64;C++)s.push(h.getInt16Le());g?(u=function(I){for(C=0;C<4;C++)I[C]+=s[m]+(I[(C+3)%4]&I[(C+2)%4])+(~I[(C+3)%4]&I[(C+1)%4]),I[C]=d(I[C],a[C]),m++},y=function(I){for(C=0;C<4;C++)I[C]+=s[I[(C+3)%4]&63]}):(u=function(I){for(C=3;C>=0;C--)I[C]=_(I[C],a[C]),I[C]-=s[m]+(I[(C+3)%4]&I[(C+2)%4])+(~I[(C+3)%4]&I[(C+1)%4]),m--},y=function(I){for(C=3;C>=0;C--)I[C]-=s[I[(C+3)%4]&63]});var p=function(I){var R=[];for(C=0;C<4;C++){var c=x.getInt16Le();E!==null&&(g?c^=E.getInt16Le():E.putInt16Le(c)),R.push(c&65535)}m=g?0:63;for(var i=0;i<I.length;i++)for(var r=0;r<I[i][0];r++)I[i][1](R);for(C=0;C<4;C++)E!==null&&(g?E.putInt16Le(R[C]):R[C]^=E.getInt16Le()),k.putInt16Le(R[C])},v=null;return v={start:function(I,R){I&&typeof I=="string"&&(I=n.util.createBuffer(I)),l=!1,x=n.util.createBuffer(),k=R||new n.util.createBuffer,E=I,v.output=k},update:function(I){for(l||x.putBuffer(I);x.length()>=8;)p([[5,u],[1,y],[6,u],[1,y],[5,u]])},finish:function(I){var R=!0;if(g)if(I)R=I(8,x,!g);else{var c=x.length()===8?8:8-x.length();x.fillWithByte(c,c)}if(R&&(l=!0,v.update()),!g&&(R=x.length()===0,R))if(I)R=I(8,k,!g);else{var i=k.length(),r=k.at(i-1);r>i?R=!1:k.truncate(r)}return R}},v};return n.rc2.startEncrypting=function(h,t,g){var l=n.rc2.createEncryptionCipher(h,128);return l.start(t,g),l},n.rc2.createEncryptionCipher=function(h,t){return S(h,t,!0)},n.rc2.startDecrypting=function(h,t,g){var l=n.rc2.createDecryptionCipher(h,128);return l.start(t,g),l},n.rc2.createDecryptionCipher=function(h,t){return S(h,t,!1)},Xt}var Wt,Mr;function bt(){if(Mr)return Wt;Mr=1;var n=fe();Wt=n.jsbn=n.jsbn||{};var e;function a(T,b,U){this.data=[],T!=null&&(typeof T=="number"?this.fromNumber(T,b,U):b==null&&typeof T!="string"?this.fromString(T,256):this.fromString(T,b))}n.jsbn.BigInteger=a;function d(){return new a(null)}function _(T,b,U,K,Q,X){for(;--X>=0;){var re=b*this.data[T++]+U.data[K]+Q;Q=Math.floor(re/67108864),U.data[K++]=re&67108863}return Q}function S(T,b,U,K,Q,X){for(var re=b&32767,J=b>>15;--X>=0;){var de=this.data[T]&32767,Fe=this.data[T++]>>15,Xe=J*de+Fe*re;de=re*de+((Xe&32767)<<15)+U.data[K]+(Q&1073741823),Q=(de>>>30)+(Xe>>>15)+J*Fe+(Q>>>30),U.data[K++]=de&1073741823}return Q}function h(T,b,U,K,Q,X){for(var re=b&16383,J=b>>14;--X>=0;){var de=this.data[T]&16383,Fe=this.data[T++]>>14,Xe=J*de+Fe*re;de=re*de+((Xe&16383)<<14)+U.data[K]+Q,Q=(de>>28)+(Xe>>14)+J*Fe,U.data[K++]=de&268435455}return Q}typeof navigator>"u"?(a.prototype.am=h,e=28):navigator.appName=="Microsoft Internet Explorer"?(a.prototype.am=S,e=30):navigator.appName!="Netscape"?(a.prototype.am=_,e=26):(a.prototype.am=h,e=28),a.prototype.DB=e,a.prototype.DM=(1<<e)-1,a.prototype.DV=1<<e;var t=52;a.prototype.FV=Math.pow(2,t),a.prototype.F1=t-e,a.prototype.F2=2*e-t;var g="0123456789abcdefghijklmnopqrstuvwxyz",l=new Array,x,k;for(x=48,k=0;k<=9;++k)l[x++]=k;for(x=97,k=10;k<36;++k)l[x++]=k;for(x=65,k=10;k<36;++k)l[x++]=k;function E(T){return g.charAt(T)}function u(T,b){var U=l[T.charCodeAt(b)];return U??-1}function y(T){for(var b=this.t-1;b>=0;--b)T.data[b]=this.data[b];T.t=this.t,T.s=this.s}function C(T){this.t=1,this.s=T<0?-1:0,T>0?this.data[0]=T:T<-1?this.data[0]=T+this.DV:this.t=0}function m(T){var b=d();return b.fromInt(T),b}function s(T,b){var U;if(b==16)U=4;else if(b==8)U=3;else if(b==256)U=8;else if(b==2)U=1;else if(b==32)U=5;else if(b==4)U=2;else{this.fromRadix(T,b);return}this.t=0,this.s=0;for(var K=T.length,Q=!1,X=0;--K>=0;){var re=U==8?T[K]&255:u(T,K);if(re<0){T.charAt(K)=="-"&&(Q=!0);continue}Q=!1,X==0?this.data[this.t++]=re:X+U>this.DB?(this.data[this.t-1]|=(re&(1<<this.DB-X)-1)<<X,this.data[this.t++]=re>>this.DB-X):this.data[this.t-1]|=re<<X,X+=U,X>=this.DB&&(X-=this.DB)}U==8&&T[0]&128&&(this.s=-1,X>0&&(this.data[this.t-1]|=(1<<this.DB-X)-1<<X)),this.clamp(),Q&&a.ZERO.subTo(this,this)}function p(){for(var T=this.s&this.DM;this.t>0&&this.data[this.t-1]==T;)--this.t}function v(T){if(this.s<0)return"-"+this.negate().toString(T);var b;if(T==16)b=4;else if(T==8)b=3;else if(T==2)b=1;else if(T==32)b=5;else if(T==4)b=2;else return this.toRadix(T);var U=(1<<b)-1,K,Q=!1,X="",re=this.t,J=this.DB-re*this.DB%b;if(re-- >0)for(J<this.DB&&(K=this.data[re]>>J)>0&&(Q=!0,X=E(K));re>=0;)J<b?(K=(this.data[re]&(1<<J)-1)<<b-J,K|=this.data[--re]>>(J+=this.DB-b)):(K=this.data[re]>>(J-=b)&U,J<=0&&(J+=this.DB,--re)),K>0&&(Q=!0),Q&&(X+=E(K));return Q?X:"0"}function I(){var T=d();return a.ZERO.subTo(this,T),T}function R(){return this.s<0?this.negate():this}function c(T){var b=this.s-T.s;if(b!=0)return b;var U=this.t;if(b=U-T.t,b!=0)return this.s<0?-b:b;for(;--U>=0;)if((b=this.data[U]-T.data[U])!=0)return b;return 0}function i(T){var b=1,U;return(U=T>>>16)!=0&&(T=U,b+=16),(U=T>>8)!=0&&(T=U,b+=8),(U=T>>4)!=0&&(T=U,b+=4),(U=T>>2)!=0&&(T=U,b+=2),(U=T>>1)!=0&&(T=U,b+=1),b}function r(){return this.t<=0?0:this.DB*(this.t-1)+i(this.data[this.t-1]^this.s&this.DM)}function B(T,b){var U;for(U=this.t-1;U>=0;--U)b.data[U+T]=this.data[U];for(U=T-1;U>=0;--U)b.data[U]=0;b.t=this.t+T,b.s=this.s}function D(T,b){for(var U=T;U<this.t;++U)b.data[U-T]=this.data[U];b.t=Math.max(this.t-T,0),b.s=this.s}function V(T,b){var U=T%this.DB,K=this.DB-U,Q=(1<<K)-1,X=Math.floor(T/this.DB),re=this.s<<U&this.DM,J;for(J=this.t-1;J>=0;--J)b.data[J+X+1]=this.data[J]>>K|re,re=(this.data[J]&Q)<<U;for(J=X-1;J>=0;--J)b.data[J]=0;b.data[X]=re,b.t=this.t+X+1,b.s=this.s,b.clamp()}function L(T,b){b.s=this.s;var U=Math.floor(T/this.DB);if(U>=this.t){b.t=0;return}var K=T%this.DB,Q=this.DB-K,X=(1<<K)-1;b.data[0]=this.data[U]>>K;for(var re=U+1;re<this.t;++re)b.data[re-U-1]|=(this.data[re]&X)<<Q,b.data[re-U]=this.data[re]>>K;K>0&&(b.data[this.t-U-1]|=(this.s&X)<<Q),b.t=this.t-U,b.clamp()}function O(T,b){for(var U=0,K=0,Q=Math.min(T.t,this.t);U<Q;)K+=this.data[U]-T.data[U],b.data[U++]=K&this.DM,K>>=this.DB;if(T.t<this.t){for(K-=T.s;U<this.t;)K+=this.data[U],b.data[U++]=K&this.DM,K>>=this.DB;K+=this.s}else{for(K+=this.s;U<T.t;)K-=T.data[U],b.data[U++]=K&this.DM,K>>=this.DB;K-=T.s}b.s=K<0?-1:0,K<-1?b.data[U++]=this.DV+K:K>0&&(b.data[U++]=K),b.t=U,b.clamp()}function q(T,b){var U=this.abs(),K=T.abs(),Q=U.t;for(b.t=Q+K.t;--Q>=0;)b.data[Q]=0;for(Q=0;Q<K.t;++Q)b.data[Q+U.t]=U.am(0,K.data[Q],b,Q,0,U.t);b.s=0,b.clamp(),this.s!=T.s&&a.ZERO.subTo(b,b)}function M(T){for(var b=this.abs(),U=T.t=2*b.t;--U>=0;)T.data[U]=0;for(U=0;U<b.t-1;++U){var K=b.am(U,b.data[U],T,2*U,0,1);(T.data[U+b.t]+=b.am(U+1,2*b.data[U],T,2*U+1,K,b.t-U-1))>=b.DV&&(T.data[U+b.t]-=b.DV,T.data[U+b.t+1]=1)}T.t>0&&(T.data[T.t-1]+=b.am(U,b.data[U],T,2*U,0,1)),T.s=0,T.clamp()}function H(T,b,U){var K=T.abs();if(!(K.t<=0)){var Q=this.abs();if(Q.t<K.t){b!=null&&b.fromInt(0),U!=null&&this.copyTo(U);return}U==null&&(U=d());var X=d(),re=this.s,J=T.s,de=this.DB-i(K.data[K.t-1]);de>0?(K.lShiftTo(de,X),Q.lShiftTo(de,U)):(K.copyTo(X),Q.copyTo(U));var Fe=X.t,Xe=X.data[Fe-1];if(Xe!=0){var ze=Xe*(1<<this.F1)+(Fe>1?X.data[Fe-2]>>this.F2:0),at=this.FV/ze,xt=(1<<this.F1)/ze,$e=1<<this.F2,Ze=U.t,St=Ze-Fe,ft=b??d();for(X.dlShiftTo(St,ft),U.compareTo(ft)>=0&&(U.data[U.t++]=1,U.subTo(ft,U)),a.ONE.dlShiftTo(Fe,ft),ft.subTo(X,X);X.t<Fe;)X.data[X.t++]=0;for(;--St>=0;){var Nt=U.data[--Ze]==Xe?this.DM:Math.floor(U.data[Ze]*at+(U.data[Ze-1]+$e)*xt);if((U.data[Ze]+=X.am(0,Nt,U,St,0,Fe))<Nt)for(X.dlShiftTo(St,ft),U.subTo(ft,U);U.data[Ze]<--Nt;)U.subTo(ft,U)}b!=null&&(U.drShiftTo(Fe,b),re!=J&&a.ZERO.subTo(b,b)),U.t=Fe,U.clamp(),de>0&&U.rShiftTo(de,U),re<0&&a.ZERO.subTo(U,U)}}}function Y(T){var b=d();return this.abs().divRemTo(T,null,b),this.s<0&&b.compareTo(a.ZERO)>0&&T.subTo(b,b),b}function W(T){this.m=T}function Z(T){return T.s<0||T.compareTo(this.m)>=0?T.mod(this.m):T}function ne(T){return T}function se(T){T.divRemTo(this.m,null,T)}function he(T,b,U){T.multiplyTo(b,U),this.reduce(U)}function ge(T,b){T.squareTo(b),this.reduce(b)}W.prototype.convert=Z,W.prototype.revert=ne,W.prototype.reduce=se,W.prototype.mulTo=he,W.prototype.sqrTo=ge;function j(){if(this.t<1)return 0;var T=this.data[0];if(!(T&1))return 0;var b=T&3;return b=b*(2-(T&15)*b)&15,b=b*(2-(T&255)*b)&255,b=b*(2-((T&65535)*b&65535))&65535,b=b*(2-T*b%this.DV)%this.DV,b>0?this.DV-b:-b}function ue(T){this.m=T,this.mp=T.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<T.DB-15)-1,this.mt2=2*T.t}function $(T){var b=d();return T.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),T.s<0&&b.compareTo(a.ZERO)>0&&this.m.subTo(b,b),b}function qe(T){var b=d();return T.copyTo(b),this.reduce(b),b}function le(T){for(;T.t<=this.mt2;)T.data[T.t++]=0;for(var b=0;b<this.m.t;++b){var U=T.data[b]&32767,K=U*this.mpl+((U*this.mph+(T.data[b]>>15)*this.mpl&this.um)<<15)&T.DM;for(U=b+this.m.t,T.data[U]+=this.m.am(0,K,T,b,0,this.m.t);T.data[U]>=T.DV;)T.data[U]-=T.DV,T.data[++U]++}T.clamp(),T.drShiftTo(this.m.t,T),T.compareTo(this.m)>=0&&T.subTo(this.m,T)}function f(T,b){T.squareTo(b),this.reduce(b)}function w(T,b,U){T.multiplyTo(b,U),this.reduce(U)}ue.prototype.convert=$,ue.prototype.revert=qe,ue.prototype.reduce=le,ue.prototype.mulTo=w,ue.prototype.sqrTo=f;function N(){return(this.t>0?this.data[0]&1:this.s)==0}function o(T,b){if(T>4294967295||T<1)return a.ONE;var U=d(),K=d(),Q=b.convert(this),X=i(T)-1;for(Q.copyTo(U);--X>=0;)if(b.sqrTo(U,K),(T&1<<X)>0)b.mulTo(K,Q,U);else{var re=U;U=K,K=re}return b.revert(U)}function A(T,b){var U;return T<256||b.isEven()?U=new W(b):U=new ue(b),this.exp(T,U)}a.prototype.copyTo=y,a.prototype.fromInt=C,a.prototype.fromString=s,a.prototype.clamp=p,a.prototype.dlShiftTo=B,a.prototype.drShiftTo=D,a.prototype.lShiftTo=V,a.prototype.rShiftTo=L,a.prototype.subTo=O,a.prototype.multiplyTo=q,a.prototype.squareTo=M,a.prototype.divRemTo=H,a.prototype.invDigit=j,a.prototype.isEven=N,a.prototype.exp=o,a.prototype.toString=v,a.prototype.negate=I,a.prototype.abs=R,a.prototype.compareTo=c,a.prototype.bitLength=r,a.prototype.mod=Y,a.prototype.modPowInt=A,a.ZERO=m(0),a.ONE=m(1);function F(){var T=d();return this.copyTo(T),T}function P(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function z(){return this.t==0?this.s:this.data[0]<<24>>24}function ee(){return this.t==0?this.s:this.data[0]<<16>>16}function ae(T){return Math.floor(Math.LN2*this.DB/Math.log(T))}function G(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function te(T){if(T==null&&(T=10),this.signum()==0||T<2||T>36)return"0";var b=this.chunkSize(T),U=Math.pow(T,b),K=m(U),Q=d(),X=d(),re="";for(this.divRemTo(K,Q,X);Q.signum()>0;)re=(U+X.intValue()).toString(T).substr(1)+re,Q.divRemTo(K,Q,X);return X.intValue().toString(T)+re}function ie(T,b){this.fromInt(0),b==null&&(b=10);for(var U=this.chunkSize(b),K=Math.pow(b,U),Q=!1,X=0,re=0,J=0;J<T.length;++J){var de=u(T,J);if(de<0){T.charAt(J)=="-"&&this.signum()==0&&(Q=!0);continue}re=b*re+de,++X>=U&&(this.dMultiply(K),this.dAddOffset(re,0),X=0,re=0)}X>0&&(this.dMultiply(Math.pow(b,X)),this.dAddOffset(re,0)),Q&&a.ZERO.subTo(this,this)}function ce(T,b,U){if(typeof b=="number")if(T<2)this.fromInt(1);else for(this.fromNumber(T,U),this.testBit(T-1)||this.bitwiseTo(a.ONE.shiftLeft(T-1),Te,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>T&&this.subTo(a.ONE.shiftLeft(T-1),this);else{var K=new Array,Q=T&7;K.length=(T>>3)+1,b.nextBytes(K),Q>0?K[0]&=(1<<Q)-1:K[0]=0,this.fromString(K,256)}}function oe(){var T=this.t,b=new Array;b[0]=this.s;var U=this.DB-T*this.DB%8,K,Q=0;if(T-- >0)for(U<this.DB&&(K=this.data[T]>>U)!=(this.s&this.DM)>>U&&(b[Q++]=K|this.s<<this.DB-U);T>=0;)U<8?(K=(this.data[T]&(1<<U)-1)<<8-U,K|=this.data[--T]>>(U+=this.DB-8)):(K=this.data[T]>>(U-=8)&255,U<=0&&(U+=this.DB,--T)),K&128&&(K|=-256),Q==0&&(this.s&128)!=(K&128)&&++Q,(Q>0||K!=this.s)&&(b[Q++]=K);return b}function me(T){return this.compareTo(T)==0}function Se(T){return this.compareTo(T)<0?this:T}function xe(T){return this.compareTo(T)>0?this:T}function Ce(T,b,U){var K,Q,X=Math.min(T.t,this.t);for(K=0;K<X;++K)U.data[K]=b(this.data[K],T.data[K]);if(T.t<this.t){for(Q=T.s&this.DM,K=X;K<this.t;++K)U.data[K]=b(this.data[K],Q);U.t=this.t}else{for(Q=this.s&this.DM,K=X;K<T.t;++K)U.data[K]=b(Q,T.data[K]);U.t=T.t}U.s=b(this.s,T.s),U.clamp()}function ve(T,b){return T&b}function ye(T){var b=d();return this.bitwiseTo(T,ve,b),b}function Te(T,b){return T|b}function Ke(T){var b=d();return this.bitwiseTo(T,Te,b),b}function Me(T,b){return T^b}function He(T){var b=d();return this.bitwiseTo(T,Me,b),b}function Ge(T,b){return T&~b}function Qe(T){var b=d();return this.bitwiseTo(T,Ge,b),b}function Ye(){for(var T=d(),b=0;b<this.t;++b)T.data[b]=this.DM&~this.data[b];return T.t=this.t,T.s=~this.s,T}function We(T){var b=d();return T<0?this.rShiftTo(-T,b):this.lShiftTo(T,b),b}function et(T){var b=d();return T<0?this.lShiftTo(-T,b):this.rShiftTo(T,b),b}function rt(T){if(T==0)return-1;var b=0;return T&65535||(T>>=16,b+=16),T&255||(T>>=8,b+=8),T&15||(T>>=4,b+=4),T&3||(T>>=2,b+=2),T&1||++b,b}function ut(){for(var T=0;T<this.t;++T)if(this.data[T]!=0)return T*this.DB+rt(this.data[T]);return this.s<0?this.t*this.DB:-1}function ct(T){for(var b=0;T!=0;)T&=T-1,++b;return b}function dt(){for(var T=0,b=this.s&this.DM,U=0;U<this.t;++U)T+=ct(this.data[U]^b);return T}function gt(T){var b=Math.floor(T/this.DB);return b>=this.t?this.s!=0:(this.data[b]&1<<T%this.DB)!=0}function Et(T,b){var U=a.ONE.shiftLeft(T);return this.bitwiseTo(U,b,U),U}function Ae(T){return this.changeBit(T,Te)}function Be(T){return this.changeBit(T,Ge)}function be(T){return this.changeBit(T,Me)}function _e(T,b){for(var U=0,K=0,Q=Math.min(T.t,this.t);U<Q;)K+=this.data[U]+T.data[U],b.data[U++]=K&this.DM,K>>=this.DB;if(T.t<this.t){for(K+=T.s;U<this.t;)K+=this.data[U],b.data[U++]=K&this.DM,K>>=this.DB;K+=this.s}else{for(K+=this.s;U<T.t;)K+=T.data[U],b.data[U++]=K&this.DM,K>>=this.DB;K+=T.s}b.s=K<0?-1:0,K>0?b.data[U++]=K:K<-1&&(b.data[U++]=this.DV+K),b.t=U,b.clamp()}function Ne(T){var b=d();return this.addTo(T,b),b}function Re(T){var b=d();return this.subTo(T,b),b}function we(T){var b=d();return this.multiplyTo(T,b),b}function Le(T){var b=d();return this.divRemTo(T,b,null),b}function De(T){var b=d();return this.divRemTo(T,null,b),b}function ke(T){var b=d(),U=d();return this.divRemTo(T,b,U),new Array(b,U)}function Ue(T){this.data[this.t]=this.am(0,T-1,this,0,0,this.t),++this.t,this.clamp()}function Pe(T,b){if(T!=0){for(;this.t<=b;)this.data[this.t++]=0;for(this.data[b]+=T;this.data[b]>=this.DV;)this.data[b]-=this.DV,++b>=this.t&&(this.data[this.t++]=0),++this.data[b]}}function Ee(){}function Ie(T){return T}function Ve(T,b,U){T.multiplyTo(b,U)}function Oe(T,b){T.squareTo(b)}Ee.prototype.convert=Ie,Ee.prototype.revert=Ie,Ee.prototype.mulTo=Ve,Ee.prototype.sqrTo=Oe;function Ia(T){return this.exp(T,new Ee)}function Aa(T,b,U){var K=Math.min(this.t+T.t,b);for(U.s=0,U.t=K;K>0;)U.data[--K]=0;var Q;for(Q=U.t-this.t;K<Q;++K)U.data[K+this.t]=this.am(0,T.data[K],U,K,0,this.t);for(Q=Math.min(T.t,b);K<Q;++K)this.am(0,T.data[K],U,K,0,b-K);U.clamp()}function Ba(T,b,U){--b;var K=U.t=this.t+T.t-b;for(U.s=0;--K>=0;)U.data[K]=0;for(K=Math.max(b-this.t,0);K<T.t;++K)U.data[this.t+K-b]=this.am(b-K,T.data[K],U,0,0,this.t+K-b);U.clamp(),U.drShiftTo(1,U)}function vt(T){this.r2=d(),this.q3=d(),a.ONE.dlShiftTo(2*T.t,this.r2),this.mu=this.r2.divide(T),this.m=T}function ba(T){if(T.s<0||T.t>2*this.m.t)return T.mod(this.m);if(T.compareTo(this.m)<0)return T;var b=d();return T.copyTo(b),this.reduce(b),b}function _a(T){return T}function Na(T){for(T.drShiftTo(this.m.t-1,this.r2),T.t>this.m.t+1&&(T.t=this.m.t+1,T.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);T.compareTo(this.r2)<0;)T.dAddOffset(1,this.m.t+1);for(T.subTo(this.r2,T);T.compareTo(this.m)>=0;)T.subTo(this.m,T)}function Ra(T,b){T.squareTo(b),this.reduce(b)}function wa(T,b,U){T.multiplyTo(b,U),this.reduce(U)}vt.prototype.convert=ba,vt.prototype.revert=_a,vt.prototype.reduce=Na,vt.prototype.mulTo=wa,vt.prototype.sqrTo=Ra;function La(T,b){var U=T.bitLength(),K,Q=m(1),X;if(U<=0)return Q;U<18?K=1:U<48?K=3:U<144?K=4:U<768?K=5:K=6,U<8?X=new W(b):b.isEven()?X=new vt(b):X=new ue(b);var re=new Array,J=3,de=K-1,Fe=(1<<K)-1;if(re[1]=X.convert(this),K>1){var Xe=d();for(X.sqrTo(re[1],Xe);J<=Fe;)re[J]=d(),X.mulTo(Xe,re[J-2],re[J]),J+=2}var ze=T.t-1,at,xt=!0,$e=d(),Ze;for(U=i(T.data[ze])-1;ze>=0;){for(U>=de?at=T.data[ze]>>U-de&Fe:(at=(T.data[ze]&(1<<U+1)-1)<<de-U,ze>0&&(at|=T.data[ze-1]>>this.DB+U-de)),J=K;!(at&1);)at>>=1,--J;if((U-=J)<0&&(U+=this.DB,--ze),xt)re[at].copyTo(Q),xt=!1;else{for(;J>1;)X.sqrTo(Q,$e),X.sqrTo($e,Q),J-=2;J>0?X.sqrTo(Q,$e):(Ze=Q,Q=$e,$e=Ze),X.mulTo($e,re[at],Q)}for(;ze>=0&&!(T.data[ze]&1<<U);)X.sqrTo(Q,$e),Ze=Q,Q=$e,$e=Ze,--U<0&&(U=this.DB-1,--ze)}return X.revert(Q)}function Da(T){var b=this.s<0?this.negate():this.clone(),U=T.s<0?T.negate():T.clone();if(b.compareTo(U)<0){var K=b;b=U,U=K}var Q=b.getLowestSetBit(),X=U.getLowestSetBit();if(X<0)return b;for(Q<X&&(X=Q),X>0&&(b.rShiftTo(X,b),U.rShiftTo(X,U));b.signum()>0;)(Q=b.getLowestSetBit())>0&&b.rShiftTo(Q,b),(Q=U.getLowestSetBit())>0&&U.rShiftTo(Q,U),b.compareTo(U)>=0?(b.subTo(U,b),b.rShiftTo(1,b)):(U.subTo(b,U),U.rShiftTo(1,U));return X>0&&U.lShiftTo(X,U),U}function ka(T){if(T<=0)return 0;var b=this.DV%T,U=this.s<0?T-1:0;if(this.t>0)if(b==0)U=this.data[0]%T;else for(var K=this.t-1;K>=0;--K)U=(b*U+this.data[K])%T;return U}function Ua(T){var b=T.isEven();if(this.isEven()&&b||T.signum()==0)return a.ZERO;for(var U=T.clone(),K=this.clone(),Q=m(1),X=m(0),re=m(0),J=m(1);U.signum()!=0;){for(;U.isEven();)U.rShiftTo(1,U),b?((!Q.isEven()||!X.isEven())&&(Q.addTo(this,Q),X.subTo(T,X)),Q.rShiftTo(1,Q)):X.isEven()||X.subTo(T,X),X.rShiftTo(1,X);for(;K.isEven();)K.rShiftTo(1,K),b?((!re.isEven()||!J.isEven())&&(re.addTo(this,re),J.subTo(T,J)),re.rShiftTo(1,re)):J.isEven()||J.subTo(T,J),J.rShiftTo(1,J);U.compareTo(K)>=0?(U.subTo(K,U),b&&Q.subTo(re,Q),X.subTo(J,X)):(K.subTo(U,K),b&&re.subTo(Q,re),J.subTo(X,J))}if(K.compareTo(a.ONE)!=0)return a.ZERO;if(J.compareTo(T)>=0)return J.subtract(T);if(J.signum()<0)J.addTo(T,J);else return J;return J.signum()<0?J.add(T):J}var je=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Pa=(1<<26)/je[je.length-1];function Va(T){var b,U=this.abs();if(U.t==1&&U.data[0]<=je[je.length-1]){for(b=0;b<je.length;++b)if(U.data[0]==je[b])return!0;return!1}if(U.isEven())return!1;for(b=1;b<je.length;){for(var K=je[b],Q=b+1;Q<je.length&&K<Pa;)K*=je[Q++];for(K=U.modInt(K);b<Q;)if(K%je[b++]==0)return!1}return U.millerRabin(T)}function Oa(T){var b=this.subtract(a.ONE),U=b.getLowestSetBit();if(U<=0)return!1;for(var K=b.shiftRight(U),Q=Fa(),X,re=0;re<T;++re){do X=new a(this.bitLength(),Q);while(X.compareTo(a.ONE)<=0||X.compareTo(b)>=0);var J=X.modPow(K,this);if(J.compareTo(a.ONE)!=0&&J.compareTo(b)!=0){for(var de=1;de++<U&&J.compareTo(b)!=0;)if(J=J.modPowInt(2,this),J.compareTo(a.ONE)==0)return!1;if(J.compareTo(b)!=0)return!1}}return!0}function Fa(){return{nextBytes:function(T){for(var b=0;b<T.length;++b)T[b]=Math.floor(Math.random()*256)}}}return a.prototype.chunkSize=ae,a.prototype.toRadix=te,a.prototype.fromRadix=ie,a.prototype.fromNumber=ce,a.prototype.bitwiseTo=Ce,a.prototype.changeBit=Et,a.prototype.addTo=_e,a.prototype.dMultiply=Ue,a.prototype.dAddOffset=Pe,a.prototype.multiplyLowerTo=Aa,a.prototype.multiplyUpperTo=Ba,a.prototype.modInt=ka,a.prototype.millerRabin=Oa,a.prototype.clone=F,a.prototype.intValue=P,a.prototype.byteValue=z,a.prototype.shortValue=ee,a.prototype.signum=G,a.prototype.toByteArray=oe,a.prototype.equals=me,a.prototype.min=Se,a.prototype.max=xe,a.prototype.and=ye,a.prototype.or=Ke,a.prototype.xor=He,a.prototype.andNot=Qe,a.prototype.not=Ye,a.prototype.shiftLeft=We,a.prototype.shiftRight=et,a.prototype.getLowestSetBit=ut,a.prototype.bitCount=dt,a.prototype.testBit=gt,a.prototype.setBit=Ae,a.prototype.clearBit=Be,a.prototype.flipBit=be,a.prototype.add=Ne,a.prototype.subtract=Re,a.prototype.multiply=we,a.prototype.divide=Le,a.prototype.remainder=De,a.prototype.divideAndRemainder=ke,a.prototype.modPow=La,a.prototype.modInverse=Ua,a.prototype.pow=Ia,a.prototype.gcd=Da,a.prototype.isProbablePrime=Va,Wt}var jt={exports:{}},$t={exports:{}},qr;function Ct(){if(qr)return $t.exports;qr=1;var n=fe();ot(),pe();var e=$t.exports=n.sha1=n.sha1||{};n.md.sha1=n.md.algorithms.sha1=e,e.create=function(){d||_();var h=null,t=n.util.createBuffer(),g=new Array(80),l={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return l.start=function(){l.messageLength=0,l.fullMessageLength=l.messageLength64=[];for(var x=l.messageLengthSize/4,k=0;k<x;++k)l.fullMessageLength.push(0);return t=n.util.createBuffer(),h={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},l},l.start(),l.update=function(x,k){k==="utf8"&&(x=n.util.encodeUtf8(x));var E=x.length;l.messageLength+=E,E=[E/4294967296>>>0,E>>>0];for(var u=l.fullMessageLength.length-1;u>=0;--u)l.fullMessageLength[u]+=E[1],E[1]=E[0]+(l.fullMessageLength[u]/4294967296>>>0),l.fullMessageLength[u]=l.fullMessageLength[u]>>>0,E[0]=E[1]/4294967296>>>0;return t.putBytes(x),S(h,g,t),(t.read>2048||t.length()===0)&&t.compact(),l},l.digest=function(){var x=n.util.createBuffer();x.putBytes(t.bytes());var k=l.fullMessageLength[l.fullMessageLength.length-1]+l.messageLengthSize,E=k&l.blockLength-1;x.putBytes(a.substr(0,l.blockLength-E));for(var u,y,C=l.fullMessageLength[0]*8,m=0;m<l.fullMessageLength.length-1;++m)u=l.fullMessageLength[m+1]*8,y=u/4294967296>>>0,C+=y,x.putInt32(C>>>0),C=u>>>0;x.putInt32(C);var s={h0:h.h0,h1:h.h1,h2:h.h2,h3:h.h3,h4:h.h4};S(s,g,x);var p=n.util.createBuffer();return p.putInt32(s.h0),p.putInt32(s.h1),p.putInt32(s.h2),p.putInt32(s.h3),p.putInt32(s.h4),p},l};var a=null,d=!1;function _(){a="",a+=n.util.fillString("\0",64),d=!0}function S(h,t,g){for(var l,x,k,E,u,y,C,m,s=g.length();s>=64;){for(x=h.h0,k=h.h1,E=h.h2,u=h.h3,y=h.h4,m=0;m<16;++m)l=g.getInt32(),t[m]=l,C=u^k&(E^u),l=(x<<5|x>>>27)+C+y+1518500249+l,y=u,u=E,E=(k<<30|k>>>2)>>>0,k=x,x=l;for(;m<20;++m)l=t[m-3]^t[m-8]^t[m-14]^t[m-16],l=l<<1|l>>>31,t[m]=l,C=u^k&(E^u),l=(x<<5|x>>>27)+C+y+1518500249+l,y=u,u=E,E=(k<<30|k>>>2)>>>0,k=x,x=l;for(;m<32;++m)l=t[m-3]^t[m-8]^t[m-14]^t[m-16],l=l<<1|l>>>31,t[m]=l,C=k^E^u,l=(x<<5|x>>>27)+C+y+1859775393+l,y=u,u=E,E=(k<<30|k>>>2)>>>0,k=x,x=l;for(;m<40;++m)l=t[m-6]^t[m-16]^t[m-28]^t[m-32],l=l<<2|l>>>30,t[m]=l,C=k^E^u,l=(x<<5|x>>>27)+C+y+1859775393+l,y=u,u=E,E=(k<<30|k>>>2)>>>0,k=x,x=l;for(;m<60;++m)l=t[m-6]^t[m-16]^t[m-28]^t[m-32],l=l<<2|l>>>30,t[m]=l,C=k&E|u&(k^E),l=(x<<5|x>>>27)+C+y+2400959708+l,y=u,u=E,E=(k<<30|k>>>2)>>>0,k=x,x=l;for(;m<80;++m)l=t[m-6]^t[m-16]^t[m-28]^t[m-32],l=l<<2|l>>>30,t[m]=l,C=k^E^u,l=(x<<5|x>>>27)+C+y+3395469782+l,y=u,u=E,E=(k<<30|k>>>2)>>>0,k=x,x=l;h.h0=h.h0+x|0,h.h1=h.h1+k|0,h.h2=h.h2+E|0,h.h3=h.h3+u|0,h.h4=h.h4+y|0,s-=64}}return $t.exports}var Hr;function va(){if(Hr)return jt.exports;Hr=1;var n=fe();pe(),Je(),Ct();var e=jt.exports=n.pkcs1=n.pkcs1||{};e.encode_rsa_oaep=function(d,_,S){var h,t,g,l;typeof S=="string"?(h=S,t=arguments[3]||void 0,g=arguments[4]||void 0):S&&(h=S.label||void 0,t=S.seed||void 0,g=S.md||void 0,S.mgf1&&S.mgf1.md&&(l=S.mgf1.md)),g?g.start():g=n.md.sha1.create(),l||(l=g);var x=Math.ceil(d.n.bitLength()/8),k=x-2*g.digestLength-2;if(_.length>k){var E=new Error("RSAES-OAEP input message length is too long.");throw E.length=_.length,E.maxLength=k,E}h||(h=""),g.update(h,"raw");for(var u=g.digest(),y="",C=k-_.length,m=0;m<C;m++)y+="\0";var s=u.getBytes()+y+""+_;if(!t)t=n.random.getBytes(g.digestLength);else if(t.length!==g.digestLength){var E=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw E.seedLength=t.length,E.digestLength=g.digestLength,E}var p=a(t,x-g.digestLength-1,l),v=n.util.xorBytes(s,p,s.length),I=a(v,g.digestLength,l),R=n.util.xorBytes(t,I,t.length);return"\0"+R+v},e.decode_rsa_oaep=function(d,_,S){var h,t,g;typeof S=="string"?(h=S,t=arguments[3]||void 0):S&&(h=S.label||void 0,t=S.md||void 0,S.mgf1&&S.mgf1.md&&(g=S.mgf1.md));var l=Math.ceil(d.n.bitLength()/8);if(_.length!==l){var v=new Error("RSAES-OAEP encoded message length is invalid.");throw v.length=_.length,v.expectedLength=l,v}if(t===void 0?t=n.md.sha1.create():t.start(),g||(g=t),l<2*t.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");h||(h=""),t.update(h,"raw");for(var x=t.digest().getBytes(),k=_.charAt(0),E=_.substring(1,t.digestLength+1),u=_.substring(1+t.digestLength),y=a(u,t.digestLength,g),C=n.util.xorBytes(E,y,E.length),m=a(C,l-t.digestLength-1,g),s=n.util.xorBytes(u,m,u.length),p=s.substring(0,t.digestLength),v=k!=="\0",I=0;I<t.digestLength;++I)v|=x.charAt(I)!==p.charAt(I);for(var R=1,c=t.digestLength,i=t.digestLength;i<s.length;i++){var r=s.charCodeAt(i),B=r&1^1,D=R?65534:0;v|=r&D,R=R&B,c+=R}if(v||s.charCodeAt(c)!==1)throw new Error("Invalid RSAES-OAEP padding.");return s.substring(c+1)};function a(d,_,S){S||(S=n.md.sha1.create());for(var h="",t=Math.ceil(_/S.digestLength),g=0;g<t;++g){var l=String.fromCharCode(g>>24&255,g>>16&255,g>>8&255,g&255);S.start(),S.update(d+l),h+=S.digest().getBytes()}return h.substring(0,_)}return jt.exports}var It={exports:{}},Gr;function ya(){if(Gr)return It.exports;Gr=1;var n=fe();return pe(),bt(),Je(),function(){if(n.prime){It.exports=n.prime;return}var e=It.exports=n.prime=n.prime||{},a=n.jsbn.BigInteger,d=[6,4,2,4,2,4,6,2],_=new a(null);_.fromInt(30);var S=function(E,u){return E|u};e.generateProbablePrime=function(E,u,y){typeof u=="function"&&(y=u,u={}),u=u||{};var C=u.algorithm||"PRIMEINC";typeof C=="string"&&(C={name:C}),C.options=C.options||{};var m=u.prng||n.random,s={nextBytes:function(p){for(var v=m.getBytesSync(p.length),I=0;I<p.length;++I)p[I]=v.charCodeAt(I)}};if(C.name==="PRIMEINC")return h(E,s,C.options,y);throw new Error("Invalid prime generation algorithm: "+C.name)};function h(E,u,y,C){return"workers"in y?l(E,u,y,C):t(E,u,y,C)}function t(E,u,y,C){var m=x(E,u),s=0,p=k(m.bitLength());"millerRabinTests"in y&&(p=y.millerRabinTests);var v=10;"maxBlockTime"in y&&(v=y.maxBlockTime),g(m,E,u,s,p,v,C)}function g(E,u,y,C,m,s,p){var v=+new Date;do{if(E.bitLength()>u&&(E=x(u,y)),E.isProbablePrime(m))return p(null,E);E.dAddOffset(d[C++%8],0)}while(s<0||+new Date-v<s);n.util.setImmediate(function(){g(E,u,y,C,m,s,p)})}function l(E,u,y,C){if(typeof Worker>"u")return t(E,u,y,C);var m=x(E,u),s=y.workers,p=y.workLoad||100,v=p*30/8,I=y.workerScript||"forge/prime.worker.js";if(s===-1)return n.util.estimateCores(function(c,i){c&&(i=2),s=i-1,R()});R();function R(){s=Math.max(1,s);for(var c=[],i=0;i<s;++i)c[i]=new Worker(I);for(var i=0;i<s;++i)c[i].addEventListener("message",B);var r=!1;function B(D){if(!r){var V=D.data;if(V.found){for(var L=0;L<c.length;++L)c[L].terminate();return r=!0,C(null,new a(V.prime,16))}m.bitLength()>E&&(m=x(E,u));var O=m.toString(16);D.target.postMessage({hex:O,workLoad:p}),m.dAddOffset(v,0)}}}}function x(E,u){var y=new a(E,u),C=E-1;return y.testBit(C)||y.bitwiseTo(a.ONE.shiftLeft(C),S,y),y.dAddOffset(31-y.mod(_).byteValue(),0),y}function k(E){return E<=100?27:E<=150?18:E<=200?15:E<=250?12:E<=300?9:E<=350?8:E<=400?7:E<=500?6:E<=600?5:E<=800?4:E<=1250?3:2}}(),It.exports}var Zt,Qr;function _t(){if(Qr)return Zt;Qr=1;var n=fe();if(tt(),bt(),pt(),va(),ya(),Je(),pe(),typeof e>"u")var e=n.jsbn.BigInteger;var a=n.util.isNodejs?Cr:null,d=n.asn1,_=n.util;n.pki=n.pki||{},Zt=n.pki.rsa=n.rsa=n.rsa||{};var S=n.pki,h=[6,4,2,4,2,4,6,2],t={name:"PrivateKeyInfo",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},g={name:"RSAPrivateKey",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},l={name:"RSAPublicKey",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},x=n.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:d.Class.UNIVERSAL,type:d.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},k={name:"DigestInfo",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:d.Class.UNIVERSAL,type:d.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},E=function(i){var r;if(i.algorithm in S.oids)r=S.oids[i.algorithm];else{var B=new Error("Unknown message digest algorithm.");throw B.algorithm=i.algorithm,B}var D=d.oidToDer(r).getBytes(),V=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]),L=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]);L.value.push(d.create(d.Class.UNIVERSAL,d.Type.OID,!1,D)),L.value.push(d.create(d.Class.UNIVERSAL,d.Type.NULL,!1,""));var O=d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,i.digest().getBytes());return V.value.push(L),V.value.push(O),d.toDer(V).getBytes()},u=function(i,r,B){if(B)return i.modPow(r.e,r.n);if(!r.p||!r.q)return i.modPow(r.d,r.n);r.dP||(r.dP=r.d.mod(r.p.subtract(e.ONE))),r.dQ||(r.dQ=r.d.mod(r.q.subtract(e.ONE))),r.qInv||(r.qInv=r.q.modInverse(r.p));var D;do D=new e(n.util.bytesToHex(n.random.getBytes(r.n.bitLength()/8)),16);while(D.compareTo(r.n)>=0||!D.gcd(r.n).equals(e.ONE));i=i.multiply(D.modPow(r.e,r.n)).mod(r.n);for(var V=i.mod(r.p).modPow(r.dP,r.p),L=i.mod(r.q).modPow(r.dQ,r.q);V.compareTo(L)<0;)V=V.add(r.p);var O=V.subtract(L).multiply(r.qInv).mod(r.p).multiply(r.q).add(L);return O=O.multiply(D.modInverse(r.n)).mod(r.n),O};S.rsa.encrypt=function(i,r,B){var D=B,V,L=Math.ceil(r.n.bitLength()/8);B!==!1&&B!==!0?(D=B===2,V=y(i,r,B)):(V=n.util.createBuffer(),V.putBytes(i));for(var O=new e(V.toHex(),16),q=u(O,r,D),M=q.toString(16),H=n.util.createBuffer(),Y=L-Math.ceil(M.length/2);Y>0;)H.putByte(0),--Y;return H.putBytes(n.util.hexToBytes(M)),H.getBytes()},S.rsa.decrypt=function(i,r,B,D){var V=Math.ceil(r.n.bitLength()/8);if(i.length!==V){var L=new Error("Encrypted message length is invalid.");throw L.length=i.length,L.expected=V,L}var O=new e(n.util.createBuffer(i).toHex(),16);if(O.compareTo(r.n)>=0)throw new Error("Encrypted message is invalid.");for(var q=u(O,r,B),M=q.toString(16),H=n.util.createBuffer(),Y=V-Math.ceil(M.length/2);Y>0;)H.putByte(0),--Y;return H.putBytes(n.util.hexToBytes(M)),D!==!1?C(H.getBytes(),r,B):H.getBytes()},S.rsa.createKeyPairGenerationState=function(i,r,B){typeof i=="string"&&(i=parseInt(i,10)),i=i||2048,B=B||{};var D=B.prng||n.random,V={nextBytes:function(q){for(var M=D.getBytesSync(q.length),H=0;H<q.length;++H)q[H]=M.charCodeAt(H)}},L=B.algorithm||"PRIMEINC",O;if(L==="PRIMEINC")O={algorithm:L,state:0,bits:i,rng:V,eInt:r||65537,e:new e(null),p:null,q:null,qBits:i>>1,pBits:i-(i>>1),pqState:0,num:null,keys:null},O.e.fromInt(O.eInt);else throw new Error("Invalid key generation algorithm: "+L);return O},S.rsa.stepKeyPairGenerationState=function(i,r){"algorithm"in i||(i.algorithm="PRIMEINC");var B=new e(null);B.fromInt(30);for(var D=0,V=function(W,Z){return W|Z},L=+new Date,O,q=0;i.keys===null&&(r<=0||q<r);){if(i.state===0){var M=i.p===null?i.pBits:i.qBits,H=M-1;i.pqState===0?(i.num=new e(M,i.rng),i.num.testBit(H)||i.num.bitwiseTo(e.ONE.shiftLeft(H),V,i.num),i.num.dAddOffset(31-i.num.mod(B).byteValue(),0),D=0,++i.pqState):i.pqState===1?i.num.bitLength()>M?i.pqState=0:i.num.isProbablePrime(p(i.num.bitLength()))?++i.pqState:i.num.dAddOffset(h[D++%8],0):i.pqState===2?i.pqState=i.num.subtract(e.ONE).gcd(i.e).compareTo(e.ONE)===0?3:0:i.pqState===3&&(i.pqState=0,i.p===null?i.p=i.num:i.q=i.num,i.p!==null&&i.q!==null&&++i.state,i.num=null)}else if(i.state===1)i.p.compareTo(i.q)<0&&(i.num=i.p,i.p=i.q,i.q=i.num),++i.state;else if(i.state===2)i.p1=i.p.subtract(e.ONE),i.q1=i.q.subtract(e.ONE),i.phi=i.p1.multiply(i.q1),++i.state;else if(i.state===3)i.phi.gcd(i.e).compareTo(e.ONE)===0?++i.state:(i.p=null,i.q=null,i.state=0);else if(i.state===4)i.n=i.p.multiply(i.q),i.n.bitLength()===i.bits?++i.state:(i.q=null,i.state=0);else if(i.state===5){var Y=i.e.modInverse(i.phi);i.keys={privateKey:S.rsa.setPrivateKey(i.n,i.e,Y,i.p,i.q,Y.mod(i.p1),Y.mod(i.q1),i.q.modInverse(i.p)),publicKey:S.rsa.setPublicKey(i.n,i.e)}}O=+new Date,q+=O-L,L=O}return i.keys!==null},S.rsa.generateKeyPair=function(i,r,B,D){if(arguments.length===1?typeof i=="object"?(B=i,i=void 0):typeof i=="function"&&(D=i,i=void 0):arguments.length===2?typeof i=="number"?typeof r=="function"?(D=r,r=void 0):typeof r!="number"&&(B=r,r=void 0):(B=i,D=r,i=void 0,r=void 0):arguments.length===3&&(typeof r=="number"?typeof B=="function"&&(D=B,B=void 0):(D=B,B=r,r=void 0)),B=B||{},i===void 0&&(i=B.bits||2048),r===void 0&&(r=B.e||65537),!n.options.usePureJavaScript&&!B.prng&&i>=256&&i<=16384&&(r===65537||r===3)){if(D){if(v("generateKeyPair"))return a.generateKeyPair("rsa",{modulusLength:i,publicExponent:r,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(q,M,H){if(q)return D(q);D(null,{privateKey:S.privateKeyFromPem(H),publicKey:S.publicKeyFromPem(M)})});if(I("generateKey")&&I("exportKey"))return _.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:i,publicExponent:c(r),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(q){return _.globalScope.crypto.subtle.exportKey("pkcs8",q.privateKey)}).then(void 0,function(q){D(q)}).then(function(q){if(q){var M=S.privateKeyFromAsn1(d.fromDer(n.util.createBuffer(q)));D(null,{privateKey:M,publicKey:S.setRsaPublicKey(M.n,M.e)})}});if(R("generateKey")&&R("exportKey")){var V=_.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:i,publicExponent:c(r),hash:{name:"SHA-256"}},!0,["sign","verify"]);V.oncomplete=function(q){var M=q.target.result,H=_.globalScope.msCrypto.subtle.exportKey("pkcs8",M.privateKey);H.oncomplete=function(Y){var W=Y.target.result,Z=S.privateKeyFromAsn1(d.fromDer(n.util.createBuffer(W)));D(null,{privateKey:Z,publicKey:S.setRsaPublicKey(Z.n,Z.e)})},H.onerror=function(Y){D(Y)}},V.onerror=function(q){D(q)};return}}else if(v("generateKeyPairSync")){var L=a.generateKeyPairSync("rsa",{modulusLength:i,publicExponent:r,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:S.privateKeyFromPem(L.privateKey),publicKey:S.publicKeyFromPem(L.publicKey)}}}var O=S.rsa.createKeyPairGenerationState(i,r,B);if(!D)return S.rsa.stepKeyPairGenerationState(O,0),O.keys;m(O,B,D)},S.setRsaPublicKey=S.rsa.setPublicKey=function(i,r){var B={n:i,e:r};return B.encrypt=function(D,V,L){if(typeof V=="string"?V=V.toUpperCase():V===void 0&&(V="RSAES-PKCS1-V1_5"),V==="RSAES-PKCS1-V1_5")V={encode:function(q,M,H){return y(q,M,2).getBytes()}};else if(V==="RSA-OAEP"||V==="RSAES-OAEP")V={encode:function(q,M){return n.pkcs1.encode_rsa_oaep(M,q,L)}};else if(["RAW","NONE","NULL",null].indexOf(V)!==-1)V={encode:function(q){return q}};else if(typeof V=="string")throw new Error('Unsupported encryption scheme: "'+V+'".');var O=V.encode(D,B,!0);return S.rsa.encrypt(O,B,!0)},B.verify=function(D,V,L,O){typeof L=="string"?L=L.toUpperCase():L===void 0&&(L="RSASSA-PKCS1-V1_5"),O===void 0&&(O={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in O||(O._parseAllDigestBytes=!0),L==="RSASSA-PKCS1-V1_5"?L={verify:function(M,H){H=C(H,B,!0);var Y=d.fromDer(H,{parseAllBytes:O._parseAllDigestBytes}),W={},Z=[];if(!d.validate(Y,k,W,Z)){var ne=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw ne.errors=Z,ne}var se=d.derToOid(W.algorithmIdentifier);if(!(se===n.oids.md2||se===n.oids.md5||se===n.oids.sha1||se===n.oids.sha224||se===n.oids.sha256||se===n.oids.sha384||se===n.oids.sha512||se===n.oids["sha512-224"]||se===n.oids["sha512-256"])){var ne=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw ne.oid=se,ne}if((se===n.oids.md2||se===n.oids.md5)&&!("parameters"in W))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return M===W.digest}}:(L==="NONE"||L==="NULL"||L===null)&&(L={verify:function(M,H){return H=C(H,B,!0),M===H}});var q=S.rsa.decrypt(V,B,!0,!1);return L.verify(D,q,B.n.bitLength())},B},S.setRsaPrivateKey=S.rsa.setPrivateKey=function(i,r,B,D,V,L,O,q){var M={n:i,e:r,d:B,p:D,q:V,dP:L,dQ:O,qInv:q};return M.decrypt=function(H,Y,W){typeof Y=="string"?Y=Y.toUpperCase():Y===void 0&&(Y="RSAES-PKCS1-V1_5");var Z=S.rsa.decrypt(H,M,!1,!1);if(Y==="RSAES-PKCS1-V1_5")Y={decode:C};else if(Y==="RSA-OAEP"||Y==="RSAES-OAEP")Y={decode:function(ne,se){return n.pkcs1.decode_rsa_oaep(se,ne,W)}};else if(["RAW","NONE","NULL",null].indexOf(Y)!==-1)Y={decode:function(ne){return ne}};else throw new Error('Unsupported encryption scheme: "'+Y+'".');return Y.decode(Z,M,!1)},M.sign=function(H,Y){var W=!1;typeof Y=="string"&&(Y=Y.toUpperCase()),Y===void 0||Y==="RSASSA-PKCS1-V1_5"?(Y={encode:E},W=1):(Y==="NONE"||Y==="NULL"||Y===null)&&(Y={encode:function(){return H}},W=1);var Z=Y.encode(H,M.n.bitLength());return S.rsa.encrypt(Z,M,W)},M},S.wrapRsaPrivateKey=function(i){return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,d.integerToDer(0).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(S.oids.rsaEncryption).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.NULL,!1,"")]),d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,d.toDer(i).getBytes())])},S.privateKeyFromAsn1=function(i){var r={},B=[];if(d.validate(i,t,r,B)&&(i=d.fromDer(n.util.createBuffer(r.privateKey))),r={},B=[],!d.validate(i,g,r,B)){var D=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw D.errors=B,D}var V,L,O,q,M,H,Y,W;return V=n.util.createBuffer(r.privateKeyModulus).toHex(),L=n.util.createBuffer(r.privateKeyPublicExponent).toHex(),O=n.util.createBuffer(r.privateKeyPrivateExponent).toHex(),q=n.util.createBuffer(r.privateKeyPrime1).toHex(),M=n.util.createBuffer(r.privateKeyPrime2).toHex(),H=n.util.createBuffer(r.privateKeyExponent1).toHex(),Y=n.util.createBuffer(r.privateKeyExponent2).toHex(),W=n.util.createBuffer(r.privateKeyCoefficient).toHex(),S.setRsaPrivateKey(new e(V,16),new e(L,16),new e(O,16),new e(q,16),new e(M,16),new e(H,16),new e(Y,16),new e(W,16))},S.privateKeyToAsn1=S.privateKeyToRSAPrivateKey=function(i){return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,d.integerToDer(0).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,s(i.n)),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,s(i.e)),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,s(i.d)),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,s(i.p)),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,s(i.q)),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,s(i.dP)),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,s(i.dQ)),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,s(i.qInv))])},S.publicKeyFromAsn1=function(i){var r={},B=[];if(d.validate(i,x,r,B)){var D=d.derToOid(r.publicKeyOid);if(D!==S.oids.rsaEncryption){var V=new Error("Cannot read public key. Unknown OID.");throw V.oid=D,V}i=r.rsaPublicKey}if(B=[],!d.validate(i,l,r,B)){var V=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw V.errors=B,V}var L=n.util.createBuffer(r.publicKeyModulus).toHex(),O=n.util.createBuffer(r.publicKeyExponent).toHex();return S.setRsaPublicKey(new e(L,16),new e(O,16))},S.publicKeyToAsn1=S.publicKeyToSubjectPublicKeyInfo=function(i){return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(S.oids.rsaEncryption).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.NULL,!1,"")]),d.create(d.Class.UNIVERSAL,d.Type.BITSTRING,!1,[S.publicKeyToRSAPublicKey(i)])])},S.publicKeyToRSAPublicKey=function(i){return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,s(i.n)),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,s(i.e))])};function y(i,r,B){var D=n.util.createBuffer(),V=Math.ceil(r.n.bitLength()/8);if(i.length>V-11){var L=new Error("Message is too long for PKCS#1 v1.5 padding.");throw L.length=i.length,L.max=V-11,L}D.putByte(0),D.putByte(B);var O=V-3-i.length,q;if(B===0||B===1){q=B===0?0:255;for(var M=0;M<O;++M)D.putByte(q)}else for(;O>0;){for(var H=0,Y=n.random.getBytes(O),M=0;M<O;++M)q=Y.charCodeAt(M),q===0?++H:D.putByte(q);O=H}return D.putByte(0),D.putBytes(i),D}function C(i,r,B,D){var V=Math.ceil(r.n.bitLength()/8),L=n.util.createBuffer(i),O=L.getByte(),q=L.getByte();if(O!==0||B&&q!==0&&q!==1||!B&&q!=2||B&&q===0&&typeof D>"u")throw new Error("Encryption block is invalid.");var M=0;if(q===0){M=V-3-D;for(var H=0;H<M;++H)if(L.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(q===1)for(M=0;L.length()>1;){if(L.getByte()!==255){--L.read;break}++M}else if(q===2)for(M=0;L.length()>1;){if(L.getByte()===0){--L.read;break}++M}var Y=L.getByte();if(Y!==0||M!==V-3-L.length())throw new Error("Encryption block is invalid.");return L.getBytes()}function m(i,r,B){typeof r=="function"&&(B=r,r={}),r=r||{};var D={algorithm:{name:r.algorithm||"PRIMEINC",options:{workers:r.workers||2,workLoad:r.workLoad||100,workerScript:r.workerScript}}};"prng"in r&&(D.prng=r.prng),V();function V(){L(i.pBits,function(q,M){if(q)return B(q);if(i.p=M,i.q!==null)return O(q,i.q);L(i.qBits,O)})}function L(q,M){n.prime.generateProbablePrime(q,D,M)}function O(q,M){if(q)return B(q);if(i.q=M,i.p.compareTo(i.q)<0){var H=i.p;i.p=i.q,i.q=H}if(i.p.subtract(e.ONE).gcd(i.e).compareTo(e.ONE)!==0){i.p=null,V();return}if(i.q.subtract(e.ONE).gcd(i.e).compareTo(e.ONE)!==0){i.q=null,L(i.qBits,O);return}if(i.p1=i.p.subtract(e.ONE),i.q1=i.q.subtract(e.ONE),i.phi=i.p1.multiply(i.q1),i.phi.gcd(i.e).compareTo(e.ONE)!==0){i.p=i.q=null,V();return}if(i.n=i.p.multiply(i.q),i.n.bitLength()!==i.bits){i.q=null,L(i.qBits,O);return}var Y=i.e.modInverse(i.phi);i.keys={privateKey:S.rsa.setPrivateKey(i.n,i.e,Y,i.p,i.q,Y.mod(i.p1),Y.mod(i.q1),i.q.modInverse(i.p)),publicKey:S.rsa.setPublicKey(i.n,i.e)},B(null,i.keys)}}function s(i){var r=i.toString(16);r[0]>="8"&&(r="00"+r);var B=n.util.hexToBytes(r);return B.length>1&&(B.charCodeAt(0)===0&&!(B.charCodeAt(1)&128)||B.charCodeAt(0)===255&&(B.charCodeAt(1)&128)===128)?B.substr(1):B}function p(i){return i<=100?27:i<=150?18:i<=200?15:i<=250?12:i<=300?9:i<=350?8:i<=400?7:i<=500?6:i<=600?5:i<=800?4:i<=1250?3:2}function v(i){return n.util.isNodejs&&typeof a[i]=="function"}function I(i){return typeof _.globalScope<"u"&&typeof _.globalScope.crypto=="object"&&typeof _.globalScope.crypto.subtle=="object"&&typeof _.globalScope.crypto.subtle[i]=="function"}function R(i){return typeof _.globalScope<"u"&&typeof _.globalScope.msCrypto=="object"&&typeof _.globalScope.msCrypto.subtle=="object"&&typeof _.globalScope.msCrypto.subtle[i]=="function"}function c(i){for(var r=n.util.hexToBytes(i.toString(16)),B=new Uint8Array(r.length),D=0;D<r.length;++D)B[D]=r.charCodeAt(D);return B}return Zt}var Jt,zr;function ga(){if(zr)return Jt;zr=1;var n=fe();if(ht(),tt(),Bt(),ot(),pt(),Er(),yt(),Je(),da(),_t(),pe(),typeof e>"u")var e=n.jsbn.BigInteger;var a=n.asn1,d=n.pki=n.pki||{};Jt=d.pbe=n.pbe=n.pbe||{};var _=d.oids,S={name:"EncryptedPrivateKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},h={name:"PBES2Algorithms",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},t={name:"pkcs-12PbeParams",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"iterations"}]};d.encryptPrivateKeyInfo=function(E,u,y){y=y||{},y.saltSize=y.saltSize||8,y.count=y.count||2048,y.algorithm=y.algorithm||"aes128",y.prfAlgorithm=y.prfAlgorithm||"sha1";var C=n.random.getBytesSync(y.saltSize),m=y.count,s=a.integerToDer(m),p,v,I;if(y.algorithm.indexOf("aes")===0||y.algorithm==="des"){var R,c,i;switch(y.algorithm){case"aes128":p=16,R=16,c=_["aes128-CBC"],i=n.aes.createEncryptionCipher;break;case"aes192":p=24,R=16,c=_["aes192-CBC"],i=n.aes.createEncryptionCipher;break;case"aes256":p=32,R=16,c=_["aes256-CBC"],i=n.aes.createEncryptionCipher;break;case"des":p=8,R=8,c=_.desCBC,i=n.des.createEncryptionCipher;break;default:var r=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw r.algorithm=y.algorithm,r}var B="hmacWith"+y.prfAlgorithm.toUpperCase(),D=x(B),V=n.pkcs5.pbkdf2(u,C,m,p,D),L=n.random.getBytesSync(R),O=i(V);O.start(L),O.update(a.toDer(E)),O.finish(),I=O.output.getBytes();var q=k(C,s,p,B);v=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(_.pkcs5PBES2).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(_.pkcs5PBKDF2).getBytes()),q]),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(c).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,L)])])])}else if(y.algorithm==="3des"){p=24;var M=new n.util.ByteBuffer(C),V=d.pbe.generatePkcs12Key(u,M,1,m,p),L=d.pbe.generatePkcs12Key(u,M,2,m,p),O=n.des.createEncryptionCipher(V);O.start(L),O.update(a.toDer(E)),O.finish(),I=O.output.getBytes(),v=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(_["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,C),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,s.getBytes())])])}else{var r=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw r.algorithm=y.algorithm,r}var H=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[v,a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,I)]);return H},d.decryptPrivateKeyInfo=function(E,u){var y=null,C={},m=[];if(!a.validate(E,S,C,m)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=m,s}var p=a.derToOid(C.encryptionOid),v=d.pbe.getCipher(p,C.encryptionParams,u),I=n.util.createBuffer(C.encryptedData);return v.update(I),v.finish()&&(y=a.fromDer(v.output)),y},d.encryptedPrivateKeyToPem=function(E,u){var y={type:"ENCRYPTED PRIVATE KEY",body:a.toDer(E).getBytes()};return n.pem.encode(y,{maxline:u})},d.encryptedPrivateKeyFromPem=function(E){var u=n.pem.decode(E)[0];if(u.type!=="ENCRYPTED PRIVATE KEY"){var y=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw y.headerType=u.type,y}if(u.procType&&u.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return a.fromDer(u.body)},d.encryptRsaPrivateKey=function(E,u,y){if(y=y||{},!y.legacy){var C=d.wrapRsaPrivateKey(d.privateKeyToAsn1(E));return C=d.encryptPrivateKeyInfo(C,u,y),d.encryptedPrivateKeyToPem(C)}var m,s,p,v;switch(y.algorithm){case"aes128":m="AES-128-CBC",p=16,s=n.random.getBytesSync(16),v=n.aes.createEncryptionCipher;break;case"aes192":m="AES-192-CBC",p=24,s=n.random.getBytesSync(16),v=n.aes.createEncryptionCipher;break;case"aes256":m="AES-256-CBC",p=32,s=n.random.getBytesSync(16),v=n.aes.createEncryptionCipher;break;case"3des":m="DES-EDE3-CBC",p=24,s=n.random.getBytesSync(8),v=n.des.createEncryptionCipher;break;case"des":m="DES-CBC",p=8,s=n.random.getBytesSync(8),v=n.des.createEncryptionCipher;break;default:var I=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+y.algorithm+'".');throw I.algorithm=y.algorithm,I}var R=n.pbe.opensslDeriveBytes(u,s.substr(0,8),p),c=v(R);c.start(s),c.update(a.toDer(d.privateKeyToAsn1(E))),c.finish();var i={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:m,parameters:n.util.bytesToHex(s).toUpperCase()},body:c.output.getBytes()};return n.pem.encode(i)},d.decryptRsaPrivateKey=function(E,u){var y=null,C=n.pem.decode(E)[0];if(C.type!=="ENCRYPTED PRIVATE KEY"&&C.type!=="PRIVATE KEY"&&C.type!=="RSA PRIVATE KEY"){var m=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw m.headerType=m,m}if(C.procType&&C.procType.type==="ENCRYPTED"){var s,p;switch(C.dekInfo.algorithm){case"DES-CBC":s=8,p=n.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,p=n.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,p=n.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,p=n.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,p=n.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,p=function(i){return n.rc2.createDecryptionCipher(i,40)};break;case"RC2-64-CBC":s=8,p=function(i){return n.rc2.createDecryptionCipher(i,64)};break;case"RC2-128-CBC":s=16,p=function(i){return n.rc2.createDecryptionCipher(i,128)};break;default:var m=new Error('Could not decrypt private key; unsupported encryption algorithm "'+C.dekInfo.algorithm+'".');throw m.algorithm=C.dekInfo.algorithm,m}var v=n.util.hexToBytes(C.dekInfo.parameters),I=n.pbe.opensslDeriveBytes(u,v.substr(0,8),s),R=p(I);if(R.start(v),R.update(n.util.createBuffer(C.body)),R.finish())y=R.output.getBytes();else return y}else y=C.body;return C.type==="ENCRYPTED PRIVATE KEY"?y=d.decryptPrivateKeyInfo(a.fromDer(y),u):y=a.fromDer(y),y!==null&&(y=d.privateKeyFromAsn1(y)),y},d.pbe.generatePkcs12Key=function(E,u,y,C,m,s){var p,v;if(typeof s>"u"||s===null){if(!("sha1"in n.md))throw new Error('"sha1" hash algorithm unavailable.');s=n.md.sha1.create()}var I=s.digestLength,R=s.blockLength,c=new n.util.ByteBuffer,i=new n.util.ByteBuffer;if(E!=null){for(v=0;v<E.length;v++)i.putInt16(E.charCodeAt(v));i.putInt16(0)}var r=i.length(),B=u.length(),D=new n.util.ByteBuffer;D.fillWithByte(y,R);var V=R*Math.ceil(B/R),L=new n.util.ByteBuffer;for(v=0;v<V;v++)L.putByte(u.at(v%B));var O=R*Math.ceil(r/R),q=new n.util.ByteBuffer;for(v=0;v<O;v++)q.putByte(i.at(v%r));var M=L;M.putBuffer(q);for(var H=Math.ceil(m/I),Y=1;Y<=H;Y++){var W=new n.util.ByteBuffer;W.putBytes(D.bytes()),W.putBytes(M.bytes());for(var Z=0;Z<C;Z++)s.start(),s.update(W.getBytes()),W=s.digest();var ne=new n.util.ByteBuffer;for(v=0;v<R;v++)ne.putByte(W.at(v%I));var se=Math.ceil(B/R)+Math.ceil(r/R),he=new n.util.ByteBuffer;for(p=0;p<se;p++){var ge=new n.util.ByteBuffer(M.getBytes(R)),j=511;for(v=ne.length()-1;v>=0;v--)j=j>>8,j+=ne.at(v)+ge.at(v),ge.setAt(v,j&255);he.putBuffer(ge)}M=he,c.putBuffer(W)}return c.truncate(c.length()-m),c},d.pbe.getCipher=function(E,u,y){switch(E){case d.oids.pkcs5PBES2:return d.pbe.getCipherForPBES2(E,u,y);case d.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case d.oids["pbewithSHAAnd40BitRC2-CBC"]:return d.pbe.getCipherForPKCS12PBE(E,u,y);default:var C=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw C.oid=E,C.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],C}},d.pbe.getCipherForPBES2=function(E,u,y){var C={},m=[];if(!a.validate(u,h,C,m)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=m,s}if(E=a.derToOid(C.kdfOid),E!==d.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=E,s.supportedOids=["pkcs5PBKDF2"],s}if(E=a.derToOid(C.encOid),E!==d.oids["aes128-CBC"]&&E!==d.oids["aes192-CBC"]&&E!==d.oids["aes256-CBC"]&&E!==d.oids["des-EDE3-CBC"]&&E!==d.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=E,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var p=C.kdfSalt,v=n.util.createBuffer(C.kdfIterationCount);v=v.getInt(v.length()<<3);var I,R;switch(d.oids[E]){case"aes128-CBC":I=16,R=n.aes.createDecryptionCipher;break;case"aes192-CBC":I=24,R=n.aes.createDecryptionCipher;break;case"aes256-CBC":I=32,R=n.aes.createDecryptionCipher;break;case"des-EDE3-CBC":I=24,R=n.des.createDecryptionCipher;break;case"desCBC":I=8,R=n.des.createDecryptionCipher;break}var c=l(C.prfOid),i=n.pkcs5.pbkdf2(y,p,v,I,c),r=C.encIv,B=R(i);return B.start(r),B},d.pbe.getCipherForPKCS12PBE=function(E,u,y){var C={},m=[];if(!a.validate(u,t,C,m)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=m,s}var p=n.util.createBuffer(C.salt),v=n.util.createBuffer(C.iterations);v=v.getInt(v.length()<<3);var I,R,c;switch(E){case d.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:I=24,R=8,c=n.des.startDecrypting;break;case d.oids["pbewithSHAAnd40BitRC2-CBC"]:I=5,R=8,c=function(V,L){var O=n.rc2.createDecryptionCipher(V,40);return O.start(L,null),O};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=E,s}var i=l(C.prfOid),r=d.pbe.generatePkcs12Key(y,p,1,v,I,i);i.start();var B=d.pbe.generatePkcs12Key(y,p,2,v,R,i);return c(r,B)},d.pbe.opensslDeriveBytes=function(E,u,y,C){if(typeof C>"u"||C===null){if(!("md5"in n.md))throw new Error('"md5" hash algorithm unavailable.');C=n.md.md5.create()}u===null&&(u="");for(var m=[g(C,E+u)],s=16,p=1;s<y;++p,s+=16)m.push(g(C,m[p-1]+E+u));return m.join("").substr(0,y)};function g(E,u){return E.start().update(u).digest().getBytes()}function l(E){var u;if(!E)u="hmacWithSHA1";else if(u=d.oids[a.derToOid(E)],!u){var y=new Error("Unsupported PRF OID.");throw y.oid=E,y.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],y}return x(u)}function x(E){var u=n.md;switch(E){case"hmacWithSHA224":u=n.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":E=E.substr(8).toLowerCase();break;default:var y=new Error("Unsupported PRF algorithm.");throw y.algorithm=E,y.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],y}if(!u||!(E in u))throw new Error("Unknown hash algorithm: "+E);return u[E].create()}function k(E,u,y,C){var m=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,E),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,u.getBytes())]);return C!=="hmacWithSHA1"&&m.value.push(a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,n.util.hexToBytes(y.toString(16))),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(d.oids[C]).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,"")])),m}return Jt}var er={exports:{}},tr={exports:{}},Yr;function ma(){if(Yr)return tr.exports;Yr=1;var n=fe();tt(),pe();var e=n.asn1,a=tr.exports=n.pkcs7asn1=n.pkcs7asn1||{};n.pkcs7=n.pkcs7||{},n.pkcs7.asn1=a;var d={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};a.contentInfoValidator=d;var _={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};a.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(_)},a.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(_)};var S={name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};return a.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},d,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[S]}]},a.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]},tr.exports}var rr={exports:{}},ar={exports:{}},Xr;function Ca(){if(Xr)return ar.exports;Xr=1;var n=fe();pe(),n.mgf=n.mgf||{};var e=ar.exports=n.mgf.mgf1=n.mgf1=n.mgf1||{};return e.create=function(a){var d={generate:function(_,S){for(var h=new n.util.ByteBuffer,t=Math.ceil(S/a.digestLength),g=0;g<t;g++){var l=new n.util.ByteBuffer;l.putInt32(g),a.start(),a.update(_+l.getBytes()),h.putBuffer(a.digest())}return h.truncate(h.length()-S),h.getBytes()}};return d},ar.exports}var nr,Wr;function za(){if(Wr)return nr;Wr=1;var n=fe();return Ca(),nr=n.mgf=n.mgf||{},n.mgf.mgf1=n.mgf1,nr}var ir={exports:{}},jr;function xr(){if(jr)return ir.exports;jr=1;var n=fe();Je(),pe();var e=ir.exports=n.pss=n.pss||{};return e.create=function(a){arguments.length===3&&(a={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var d=a.md,_=a.mgf,S=d.digestLength,h=a.salt||null;typeof h=="string"&&(h=n.util.createBuffer(h));var t;if("saltLength"in a)t=a.saltLength;else if(h!==null)t=h.length();else throw new Error("Salt length not specified or specific salt not given.");if(h!==null&&h.length()!==t)throw new Error("Given salt length does not match length of given salt.");var g=a.prng||n.random,l={};return l.encode=function(x,k){var E,u=k-1,y=Math.ceil(u/8),C=x.digest().getBytes();if(y<S+t+2)throw new Error("Message is too long to encrypt.");var m;h===null?m=g.getBytesSync(t):m=h.bytes();var s=new n.util.ByteBuffer;s.fillWithByte(0,8),s.putBytes(C),s.putBytes(m),d.start(),d.update(s.getBytes());var p=d.digest().getBytes(),v=new n.util.ByteBuffer;v.fillWithByte(0,y-t-S-2),v.putByte(1),v.putBytes(m);var I=v.getBytes(),R=y-S-1,c=_.generate(p,R),i="";for(E=0;E<R;E++)i+=String.fromCharCode(I.charCodeAt(E)^c.charCodeAt(E));var r=65280>>8*y-u&255;return i=String.fromCharCode(i.charCodeAt(0)&~r)+i.substr(1),i+p+"¼"},l.verify=function(x,k,E){var u,y=E-1,C=Math.ceil(y/8);if(k=k.substr(-C),C<S+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(k.charCodeAt(C-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var m=C-S-1,s=k.substr(0,m),p=k.substr(m,S),v=65280>>8*C-y&255;if(s.charCodeAt(0)&v)throw new Error("Bits beyond keysize not zero as expected.");var I=_.generate(p,m),R="";for(u=0;u<m;u++)R+=String.fromCharCode(s.charCodeAt(u)^I.charCodeAt(u));R=String.fromCharCode(R.charCodeAt(0)&~v)+R.substr(1);var c=C-S-t-2;for(u=0;u<c;u++)if(R.charCodeAt(u)!==0)throw new Error("Leftmost octets not zero as expected");if(R.charCodeAt(c)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var i=R.substr(-t),r=new n.util.ByteBuffer;r.fillWithByte(0,8),r.putBytes(x),r.putBytes(i),d.start(),d.update(r.getBytes());var B=d.digest().getBytes();return p===B},l},ir.exports}var $r;function Sr(){if($r)return rr.exports;$r=1;var n=fe();ht(),tt(),Bt(),ot(),za(),pt(),yt(),xr(),_t(),pe();var e=n.asn1,a=rr.exports=n.pki=n.pki||{},d=a.oids,_={};_.CN=d.commonName,_.commonName="CN",_.C=d.countryName,_.countryName="C",_.L=d.localityName,_.localityName="L",_.ST=d.stateOrProvinceName,_.stateOrProvinceName="ST",_.O=d.organizationName,_.organizationName="O",_.OU=d.organizationalUnitName,_.organizationalUnitName="OU",_.E=d.emailAddress,_.emailAddress="E";var S=n.pki.rsa.publicKeyValidator,h={name:"Certificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},S,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},t={name:"rsapss",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},g={name:"CertificationRequestInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},S,{name:"CertificationRequestInfo.attributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0}]}]}]},l={name:"CertificationRequest",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[g,{name:"CertificationRequest.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};a.RDNAttributesAsArray=function(c,i){for(var r=[],B,D,V,L=0;L<c.value.length;++L){B=c.value[L];for(var O=0;O<B.value.length;++O)V={},D=B.value[O],V.type=e.derToOid(D.value[0].value),V.value=D.value[1].value,V.valueTagClass=D.value[1].type,V.type in d&&(V.name=d[V.type],V.name in _&&(V.shortName=_[V.name])),i&&(i.update(V.type),i.update(V.value)),r.push(V)}return r},a.CRIAttributesAsArray=function(c){for(var i=[],r=0;r<c.length;++r)for(var B=c[r],D=e.derToOid(B.value[0].value),V=B.value[1].value,L=0;L<V.length;++L){var O={};if(O.type=D,O.value=V[L].value,O.valueTagClass=V[L].type,O.type in d&&(O.name=d[O.type],O.name in _&&(O.shortName=_[O.name])),O.type===d.extensionRequest){O.extensions=[];for(var q=0;q<O.value.length;++q)O.extensions.push(a.certificateExtensionFromAsn1(O.value[q]))}i.push(O)}return i};function x(c,i){typeof i=="string"&&(i={shortName:i});for(var r=null,B,D=0;r===null&&D<c.attributes.length;++D)B=c.attributes[D],(i.type&&i.type===B.type||i.name&&i.name===B.name||i.shortName&&i.shortName===B.shortName)&&(r=B);return r}var k=function(c,i,r){var B={};if(c!==d["RSASSA-PSS"])return B;r&&(B={hash:{algorithmOid:d.sha1},mgf:{algorithmOid:d.mgf1,hash:{algorithmOid:d.sha1}},saltLength:20});var D={},V=[];if(!e.validate(i,t,D,V)){var L=new Error("Cannot read RSASSA-PSS parameter block.");throw L.errors=V,L}return D.hashOid!==void 0&&(B.hash=B.hash||{},B.hash.algorithmOid=e.derToOid(D.hashOid)),D.maskGenOid!==void 0&&(B.mgf=B.mgf||{},B.mgf.algorithmOid=e.derToOid(D.maskGenOid),B.mgf.hash=B.mgf.hash||{},B.mgf.hash.algorithmOid=e.derToOid(D.maskGenHashOid)),D.saltLength!==void 0&&(B.saltLength=D.saltLength.charCodeAt(0)),B},E=function(c){switch(d[c.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return n.md.sha1.create();case"md5WithRSAEncryption":return n.md.md5.create();case"sha256WithRSAEncryption":return n.md.sha256.create();case"sha384WithRSAEncryption":return n.md.sha384.create();case"sha512WithRSAEncryption":return n.md.sha512.create();case"RSASSA-PSS":return n.md.sha256.create();default:var i=new Error("Could not compute "+c.type+" digest. Unknown signature OID.");throw i.signatureOid=c.signatureOid,i}},u=function(c){var i=c.certificate,r;switch(i.signatureOid){case d.sha1WithRSAEncryption:case d.sha1WithRSASignature:break;case d["RSASSA-PSS"]:var B,D;if(B=d[i.signatureParameters.mgf.hash.algorithmOid],B===void 0||n.md[B]===void 0){var V=new Error("Unsupported MGF hash function.");throw V.oid=i.signatureParameters.mgf.hash.algorithmOid,V.name=B,V}if(D=d[i.signatureParameters.mgf.algorithmOid],D===void 0||n.mgf[D]===void 0){var V=new Error("Unsupported MGF function.");throw V.oid=i.signatureParameters.mgf.algorithmOid,V.name=D,V}if(D=n.mgf[D].create(n.md[B].create()),B=d[i.signatureParameters.hash.algorithmOid],B===void 0||n.md[B]===void 0){var V=new Error("Unsupported RSASSA-PSS hash function.");throw V.oid=i.signatureParameters.hash.algorithmOid,V.name=B,V}r=n.pss.create(n.md[B].create(),D,i.signatureParameters.saltLength);break}return i.publicKey.verify(c.md.digest().getBytes(),c.signature,r)};a.certificateFromPem=function(c,i,r){var B=n.pem.decode(c)[0];if(B.type!=="CERTIFICATE"&&B.type!=="X509 CERTIFICATE"&&B.type!=="TRUSTED CERTIFICATE"){var D=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw D.headerType=B.type,D}if(B.procType&&B.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var V=e.fromDer(B.body,r);return a.certificateFromAsn1(V,i)},a.certificateToPem=function(c,i){var r={type:"CERTIFICATE",body:e.toDer(a.certificateToAsn1(c)).getBytes()};return n.pem.encode(r,{maxline:i})},a.publicKeyFromPem=function(c){var i=n.pem.decode(c)[0];if(i.type!=="PUBLIC KEY"&&i.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=i.type,r}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var B=e.fromDer(i.body);return a.publicKeyFromAsn1(B)},a.publicKeyToPem=function(c,i){var r={type:"PUBLIC KEY",body:e.toDer(a.publicKeyToAsn1(c)).getBytes()};return n.pem.encode(r,{maxline:i})},a.publicKeyToRSAPublicKeyPem=function(c,i){var r={type:"RSA PUBLIC KEY",body:e.toDer(a.publicKeyToRSAPublicKey(c)).getBytes()};return n.pem.encode(r,{maxline:i})},a.getPublicKeyFingerprint=function(c,i){i=i||{};var r=i.md||n.md.sha1.create(),B=i.type||"RSAPublicKey",D;switch(B){case"RSAPublicKey":D=e.toDer(a.publicKeyToRSAPublicKey(c)).getBytes();break;case"SubjectPublicKeyInfo":D=e.toDer(a.publicKeyToAsn1(c)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+i.type+'".')}r.start(),r.update(D);var V=r.digest();if(i.encoding==="hex"){var L=V.toHex();return i.delimiter?L.match(/.{2}/g).join(i.delimiter):L}else{if(i.encoding==="binary")return V.getBytes();if(i.encoding)throw new Error('Unknown encoding "'+i.encoding+'".')}return V},a.certificationRequestFromPem=function(c,i,r){var B=n.pem.decode(c)[0];if(B.type!=="CERTIFICATE REQUEST"){var D=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw D.headerType=B.type,D}if(B.procType&&B.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var V=e.fromDer(B.body,r);return a.certificationRequestFromAsn1(V,i)},a.certificationRequestToPem=function(c,i){var r={type:"CERTIFICATE REQUEST",body:e.toDer(a.certificationRequestToAsn1(c)).getBytes()};return n.pem.encode(r,{maxline:i})},a.createCertificate=function(){var c={};return c.version=2,c.serialNumber="00",c.signatureOid=null,c.signature=null,c.siginfo={},c.siginfo.algorithmOid=null,c.validity={},c.validity.notBefore=new Date,c.validity.notAfter=new Date,c.issuer={},c.issuer.getField=function(i){return x(c.issuer,i)},c.issuer.addField=function(i){C([i]),c.issuer.attributes.push(i)},c.issuer.attributes=[],c.issuer.hash=null,c.subject={},c.subject.getField=function(i){return x(c.subject,i)},c.subject.addField=function(i){C([i]),c.subject.attributes.push(i)},c.subject.attributes=[],c.subject.hash=null,c.extensions=[],c.publicKey=null,c.md=null,c.setSubject=function(i,r){C(i),c.subject.attributes=i,delete c.subject.uniqueId,r&&(c.subject.uniqueId=r),c.subject.hash=null},c.setIssuer=function(i,r){C(i),c.issuer.attributes=i,delete c.issuer.uniqueId,r&&(c.issuer.uniqueId=r),c.issuer.hash=null},c.setExtensions=function(i){for(var r=0;r<i.length;++r)m(i[r],{cert:c});c.extensions=i},c.getExtension=function(i){typeof i=="string"&&(i={name:i});for(var r=null,B,D=0;r===null&&D<c.extensions.length;++D)B=c.extensions[D],(i.id&&B.id===i.id||i.name&&B.name===i.name)&&(r=B);return r},c.sign=function(i,r){c.md=r||n.md.sha1.create();var B=d[c.md.algorithm+"WithRSAEncryption"];if(!B){var D=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw D.algorithm=c.md.algorithm,D}c.signatureOid=c.siginfo.algorithmOid=B,c.tbsCertificate=a.getTBSCertificate(c);var V=e.toDer(c.tbsCertificate);c.md.update(V.getBytes()),c.signature=i.sign(c.md)},c.verify=function(i){var r=!1;if(!c.issued(i)){var B=i.issuer,D=c.subject,V=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw V.expectedIssuer=D.attributes,V.actualIssuer=B.attributes,V}var L=i.md;if(L===null){L=E({signatureOid:i.signatureOid,type:"certificate"});var O=i.tbsCertificate||a.getTBSCertificate(i),q=e.toDer(O);L.update(q.getBytes())}return L!==null&&(r=u({certificate:c,md:L,signature:i.signature})),r},c.isIssuer=function(i){var r=!1,B=c.issuer,D=i.subject;if(B.hash&&D.hash)r=B.hash===D.hash;else if(B.attributes.length===D.attributes.length){r=!0;for(var V,L,O=0;r&&O<B.attributes.length;++O)V=B.attributes[O],L=D.attributes[O],(V.type!==L.type||V.value!==L.value)&&(r=!1)}return r},c.issued=function(i){return i.isIssuer(c)},c.generateSubjectKeyIdentifier=function(){return a.getPublicKeyFingerprint(c.publicKey,{type:"RSAPublicKey"})},c.verifySubjectKeyIdentifier=function(){for(var i=d.subjectKeyIdentifier,r=0;r<c.extensions.length;++r){var B=c.extensions[r];if(B.id===i){var D=c.generateSubjectKeyIdentifier().getBytes();return n.util.hexToBytes(B.subjectKeyIdentifier)===D}}return!1},c},a.certificateFromAsn1=function(c,i){var r={},B=[];if(!e.validate(c,h,r,B)){var D=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw D.errors=B,D}var V=e.derToOid(r.publicKeyOid);if(V!==a.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var L=a.createCertificate();L.version=r.certVersion?r.certVersion.charCodeAt(0):0;var O=n.util.createBuffer(r.certSerialNumber);L.serialNumber=O.toHex(),L.signatureOid=n.asn1.derToOid(r.certSignatureOid),L.signatureParameters=k(L.signatureOid,r.certSignatureParams,!0),L.siginfo.algorithmOid=n.asn1.derToOid(r.certinfoSignatureOid),L.siginfo.parameters=k(L.siginfo.algorithmOid,r.certinfoSignatureParams,!1),L.signature=r.certSignature;var q=[];if(r.certValidity1UTCTime!==void 0&&q.push(e.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&q.push(e.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&q.push(e.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&q.push(e.generalizedTimeToDate(r.certValidity4GeneralizedTime)),q.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(q.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(L.validity.notBefore=q[0],L.validity.notAfter=q[1],L.tbsCertificate=r.tbsCertificate,i){L.md=E({signatureOid:L.signatureOid,type:"certificate"});var M=e.toDer(L.tbsCertificate);L.md.update(M.getBytes())}var H=n.md.sha1.create(),Y=e.toDer(r.certIssuer);H.update(Y.getBytes()),L.issuer.getField=function(ne){return x(L.issuer,ne)},L.issuer.addField=function(ne){C([ne]),L.issuer.attributes.push(ne)},L.issuer.attributes=a.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(L.issuer.uniqueId=r.certIssuerUniqueId),L.issuer.hash=H.digest().toHex();var W=n.md.sha1.create(),Z=e.toDer(r.certSubject);return W.update(Z.getBytes()),L.subject.getField=function(ne){return x(L.subject,ne)},L.subject.addField=function(ne){C([ne]),L.subject.attributes.push(ne)},L.subject.attributes=a.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(L.subject.uniqueId=r.certSubjectUniqueId),L.subject.hash=W.digest().toHex(),r.certExtensions?L.extensions=a.certificateExtensionsFromAsn1(r.certExtensions):L.extensions=[],L.publicKey=a.publicKeyFromAsn1(r.subjectPublicKeyInfo),L},a.certificateExtensionsFromAsn1=function(c){for(var i=[],r=0;r<c.value.length;++r)for(var B=c.value[r],D=0;D<B.value.length;++D)i.push(a.certificateExtensionFromAsn1(B.value[D]));return i},a.certificateExtensionFromAsn1=function(c){var i={};if(i.id=e.derToOid(c.value[0].value),i.critical=!1,c.value[1].type===e.Type.BOOLEAN?(i.critical=c.value[1].value.charCodeAt(0)!==0,i.value=c.value[2].value):i.value=c.value[1].value,i.id in d){if(i.name=d[i.id],i.name==="keyUsage"){var r=e.fromDer(i.value),B=0,D=0;r.value.length>1&&(B=r.value.charCodeAt(1),D=r.value.length>2?r.value.charCodeAt(2):0),i.digitalSignature=(B&128)===128,i.nonRepudiation=(B&64)===64,i.keyEncipherment=(B&32)===32,i.dataEncipherment=(B&16)===16,i.keyAgreement=(B&8)===8,i.keyCertSign=(B&4)===4,i.cRLSign=(B&2)===2,i.encipherOnly=(B&1)===1,i.decipherOnly=(D&128)===128}else if(i.name==="basicConstraints"){var r=e.fromDer(i.value);r.value.length>0&&r.value[0].type===e.Type.BOOLEAN?i.cA=r.value[0].value.charCodeAt(0)!==0:i.cA=!1;var V=null;r.value.length>0&&r.value[0].type===e.Type.INTEGER?V=r.value[0].value:r.value.length>1&&(V=r.value[1].value),V!==null&&(i.pathLenConstraint=e.derToInteger(V))}else if(i.name==="extKeyUsage")for(var r=e.fromDer(i.value),L=0;L<r.value.length;++L){var O=e.derToOid(r.value[L].value);O in d?i[d[O]]=!0:i[O]=!0}else if(i.name==="nsCertType"){var r=e.fromDer(i.value),B=0;r.value.length>1&&(B=r.value.charCodeAt(1)),i.client=(B&128)===128,i.server=(B&64)===64,i.email=(B&32)===32,i.objsign=(B&16)===16,i.reserved=(B&8)===8,i.sslCA=(B&4)===4,i.emailCA=(B&2)===2,i.objCA=(B&1)===1}else if(i.name==="subjectAltName"||i.name==="issuerAltName"){i.altNames=[];for(var q,r=e.fromDer(i.value),M=0;M<r.value.length;++M){q=r.value[M];var H={type:q.type,value:q.value};switch(i.altNames.push(H),q.type){case 1:case 2:case 6:break;case 7:H.ip=n.util.bytesToIP(q.value);break;case 8:H.oid=e.derToOid(q.value);break}}}else if(i.name==="subjectKeyIdentifier"){var r=e.fromDer(i.value);i.subjectKeyIdentifier=n.util.bytesToHex(r.value)}}return i},a.certificationRequestFromAsn1=function(c,i){var r={},B=[];if(!e.validate(c,l,r,B)){var D=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw D.errors=B,D}var V=e.derToOid(r.publicKeyOid);if(V!==a.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var L=a.createCertificationRequest();if(L.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,L.signatureOid=n.asn1.derToOid(r.csrSignatureOid),L.signatureParameters=k(L.signatureOid,r.csrSignatureParams,!0),L.siginfo.algorithmOid=n.asn1.derToOid(r.csrSignatureOid),L.siginfo.parameters=k(L.siginfo.algorithmOid,r.csrSignatureParams,!1),L.signature=r.csrSignature,L.certificationRequestInfo=r.certificationRequestInfo,i){L.md=E({signatureOid:L.signatureOid,type:"certification request"});var O=e.toDer(L.certificationRequestInfo);L.md.update(O.getBytes())}var q=n.md.sha1.create();return L.subject.getField=function(M){return x(L.subject,M)},L.subject.addField=function(M){C([M]),L.subject.attributes.push(M)},L.subject.attributes=a.RDNAttributesAsArray(r.certificationRequestInfoSubject,q),L.subject.hash=q.digest().toHex(),L.publicKey=a.publicKeyFromAsn1(r.subjectPublicKeyInfo),L.getAttribute=function(M){return x(L,M)},L.addAttribute=function(M){C([M]),L.attributes.push(M)},L.attributes=a.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),L},a.createCertificationRequest=function(){var c={};return c.version=0,c.signatureOid=null,c.signature=null,c.siginfo={},c.siginfo.algorithmOid=null,c.subject={},c.subject.getField=function(i){return x(c.subject,i)},c.subject.addField=function(i){C([i]),c.subject.attributes.push(i)},c.subject.attributes=[],c.subject.hash=null,c.publicKey=null,c.attributes=[],c.getAttribute=function(i){return x(c,i)},c.addAttribute=function(i){C([i]),c.attributes.push(i)},c.md=null,c.setSubject=function(i){C(i),c.subject.attributes=i,c.subject.hash=null},c.setAttributes=function(i){C(i),c.attributes=i},c.sign=function(i,r){c.md=r||n.md.sha1.create();var B=d[c.md.algorithm+"WithRSAEncryption"];if(!B){var D=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw D.algorithm=c.md.algorithm,D}c.signatureOid=c.siginfo.algorithmOid=B,c.certificationRequestInfo=a.getCertificationRequestInfo(c);var V=e.toDer(c.certificationRequestInfo);c.md.update(V.getBytes()),c.signature=i.sign(c.md)},c.verify=function(){var i=!1,r=c.md;if(r===null){r=E({signatureOid:c.signatureOid,type:"certification request"});var B=c.certificationRequestInfo||a.getCertificationRequestInfo(c),D=e.toDer(B);r.update(D.getBytes())}return r!==null&&(i=u({certificate:c,md:r,signature:c.signature})),i},c};function y(c){for(var i=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),r,B,D=c.attributes,V=0;V<D.length;++V){r=D[V];var L=r.value,O=e.Type.PRINTABLESTRING;"valueTagClass"in r&&(O=r.valueTagClass,O===e.Type.UTF8&&(L=n.util.encodeUtf8(L))),B=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.type).getBytes()),e.create(e.Class.UNIVERSAL,O,!1,L)])]),i.value.push(B)}return i}function C(c){for(var i,r=0;r<c.length;++r){if(i=c[r],typeof i.name>"u"&&(i.type&&i.type in a.oids?i.name=a.oids[i.type]:i.shortName&&i.shortName in _&&(i.name=a.oids[_[i.shortName]])),typeof i.type>"u")if(i.name&&i.name in a.oids)i.type=a.oids[i.name];else{var B=new Error("Attribute type not specified.");throw B.attribute=i,B}if(typeof i.shortName>"u"&&i.name&&i.name in _&&(i.shortName=_[i.name]),i.type===d.extensionRequest&&(i.valueConstructed=!0,i.valueTagClass=e.Type.SEQUENCE,!i.value&&i.extensions)){i.value=[];for(var D=0;D<i.extensions.length;++D)i.value.push(a.certificateExtensionToAsn1(m(i.extensions[D])))}if(typeof i.value>"u"){var B=new Error("Attribute value not specified.");throw B.attribute=i,B}}}function m(c,i){if(i=i||{},typeof c.name>"u"&&c.id&&c.id in a.oids&&(c.name=a.oids[c.id]),typeof c.id>"u")if(c.name&&c.name in a.oids)c.id=a.oids[c.name];else{var r=new Error("Extension ID not specified.");throw r.extension=c,r}if(typeof c.value<"u")return c;if(c.name==="keyUsage"){var B=0,D=0,V=0;c.digitalSignature&&(D|=128,B=7),c.nonRepudiation&&(D|=64,B=6),c.keyEncipherment&&(D|=32,B=5),c.dataEncipherment&&(D|=16,B=4),c.keyAgreement&&(D|=8,B=3),c.keyCertSign&&(D|=4,B=2),c.cRLSign&&(D|=2,B=1),c.encipherOnly&&(D|=1,B=0),c.decipherOnly&&(V|=128,B=7);var L=String.fromCharCode(B);V!==0?L+=String.fromCharCode(D)+String.fromCharCode(V):D!==0&&(L+=String.fromCharCode(D)),c.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,L)}else if(c.name==="basicConstraints")c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),c.cA&&c.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"ÿ")),"pathLenConstraint"in c&&c.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(c.pathLenConstraint).getBytes()));else if(c.name==="extKeyUsage"){c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var O=c.value.value;for(var q in c)c[q]===!0&&(q in d?O.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(d[q]).getBytes())):q.indexOf(".")!==-1&&O.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(q).getBytes())))}else if(c.name==="nsCertType"){var B=0,D=0;c.client&&(D|=128,B=7),c.server&&(D|=64,B=6),c.email&&(D|=32,B=5),c.objsign&&(D|=16,B=4),c.reserved&&(D|=8,B=3),c.sslCA&&(D|=4,B=2),c.emailCA&&(D|=2,B=1),c.objCA&&(D|=1,B=0);var L=String.fromCharCode(B);D!==0&&(L+=String.fromCharCode(D)),c.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,L)}else if(c.name==="subjectAltName"||c.name==="issuerAltName"){c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var M,H=0;H<c.altNames.length;++H){M=c.altNames[H];var L=M.value;if(M.type===7&&M.ip){if(L=n.util.bytesFromIP(M.ip),L===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=c,r}}else M.type===8&&(M.oid?L=e.oidToDer(e.oidToDer(M.oid)):L=e.oidToDer(L));c.value.value.push(e.create(e.Class.CONTEXT_SPECIFIC,M.type,!1,L))}}else if(c.name==="nsComment"&&i.cert){if(!/^[\x00-\x7F]*$/.test(c.comment)||c.comment.length<1||c.comment.length>128)throw new Error('Invalid "nsComment" content.');c.value=e.create(e.Class.UNIVERSAL,e.Type.IA5STRING,!1,c.comment)}else if(c.name==="subjectKeyIdentifier"&&i.cert){var Y=i.cert.generateSubjectKeyIdentifier();c.subjectKeyIdentifier=Y.toHex(),c.value=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,Y.getBytes())}else if(c.name==="authorityKeyIdentifier"&&i.cert){c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var O=c.value.value;if(c.keyIdentifier){var W=c.keyIdentifier===!0?i.cert.generateSubjectKeyIdentifier().getBytes():c.keyIdentifier;O.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!1,W))}if(c.authorityCertIssuer){var Z=[e.create(e.Class.CONTEXT_SPECIFIC,4,!0,[y(c.authorityCertIssuer===!0?i.cert.issuer:c.authorityCertIssuer)])];O.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,Z))}if(c.serialNumber){var ne=n.util.hexToBytes(c.serialNumber===!0?i.cert.serialNumber:c.serialNumber);O.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!1,ne))}}else if(c.name==="cRLDistributionPoints"){c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var O=c.value.value,se=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),he=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]),M,H=0;H<c.altNames.length;++H){M=c.altNames[H];var L=M.value;if(M.type===7&&M.ip){if(L=n.util.bytesFromIP(M.ip),L===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=c,r}}else M.type===8&&(M.oid?L=e.oidToDer(e.oidToDer(M.oid)):L=e.oidToDer(L));he.value.push(e.create(e.Class.CONTEXT_SPECIFIC,M.type,!1,L))}se.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[he])),O.push(se)}if(typeof c.value>"u"){var r=new Error("Extension value not specified.");throw r.extension=c,r}return c}function s(c,i){switch(c){case d["RSASSA-PSS"]:var r=[];return i.hash.algorithmOid!==void 0&&r.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])),i.mgf.algorithmOid!==void 0&&r.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.mgf.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.mgf.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])])),i.saltLength!==void 0&&r.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(i.saltLength).getBytes())])),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,r);default:return e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")}}function p(c){var i=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);if(c.attributes.length===0)return i;for(var r=c.attributes,B=0;B<r.length;++B){var D=r[B],V=D.value,L=e.Type.UTF8;"valueTagClass"in D&&(L=D.valueTagClass),L===e.Type.UTF8&&(V=n.util.encodeUtf8(V));var O=!1;"valueConstructed"in D&&(O=D.valueConstructed);var q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(D.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,L,O,V)])]);i.value.push(q)}return i}var v=new Date("1950-01-01T00:00:00Z"),I=new Date("2050-01-01T00:00:00Z");function R(c){return c>=v&&c<I?e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(c)):e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(c))}return a.getTBSCertificate=function(c){var i=R(c.validity.notBefore),r=R(c.validity.notAfter),B=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(c.version).getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,n.util.hexToBytes(c.serialNumber)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.siginfo.algorithmOid).getBytes()),s(c.siginfo.algorithmOid,c.siginfo.parameters)]),y(c.issuer),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[i,r]),y(c.subject),a.publicKeyToAsn1(c.publicKey)]);return c.issuer.uniqueId&&B.value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+c.issuer.uniqueId)])),c.subject.uniqueId&&B.value.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+c.subject.uniqueId)])),c.extensions.length>0&&B.value.push(a.certificateExtensionsToAsn1(c.extensions)),B},a.getCertificationRequestInfo=function(c){var i=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(c.version).getBytes()),y(c.subject),a.publicKeyToAsn1(c.publicKey),p(c)]);return i},a.distinguishedNameToAsn1=function(c){return y(c)},a.certificateToAsn1=function(c){var i=c.tbsCertificate||a.getTBSCertificate(c);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[i,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.signatureOid).getBytes()),s(c.signatureOid,c.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+c.signature)])},a.certificateExtensionsToAsn1=function(c){var i=e.create(e.Class.CONTEXT_SPECIFIC,3,!0,[]),r=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);i.value.push(r);for(var B=0;B<c.length;++B)r.value.push(a.certificateExtensionToAsn1(c[B]));return i},a.certificateExtensionToAsn1=function(c){var i=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);i.value.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.id).getBytes())),c.critical&&i.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"ÿ"));var r=c.value;return typeof c.value!="string"&&(r=e.toDer(r).getBytes()),i.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,r)),i},a.certificationRequestToAsn1=function(c){var i=c.certificationRequestInfo||a.getCertificationRequestInfo(c);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[i,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.signatureOid).getBytes()),s(c.signatureOid,c.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+c.signature)])},a.createCaStore=function(c){var i={certs:{}};i.getIssuer=function(L){var O=r(L.issuer);return O},i.addCertificate=function(L){if(typeof L=="string"&&(L=n.pki.certificateFromPem(L)),B(L.subject),!i.hasCertificate(L))if(L.subject.hash in i.certs){var O=i.certs[L.subject.hash];n.util.isArray(O)||(O=[O]),O.push(L),i.certs[L.subject.hash]=O}else i.certs[L.subject.hash]=L},i.hasCertificate=function(L){typeof L=="string"&&(L=n.pki.certificateFromPem(L));var O=r(L.subject);if(!O)return!1;n.util.isArray(O)||(O=[O]);for(var q=e.toDer(a.certificateToAsn1(L)).getBytes(),M=0;M<O.length;++M){var H=e.toDer(a.certificateToAsn1(O[M])).getBytes();if(q===H)return!0}return!1},i.listAllCertificates=function(){var L=[];for(var O in i.certs)if(i.certs.hasOwnProperty(O)){var q=i.certs[O];if(!n.util.isArray(q))L.push(q);else for(var M=0;M<q.length;++M)L.push(q[M])}return L},i.removeCertificate=function(L){var O;if(typeof L=="string"&&(L=n.pki.certificateFromPem(L)),B(L.subject),!i.hasCertificate(L))return null;var q=r(L.subject);if(!n.util.isArray(q))return O=i.certs[L.subject.hash],delete i.certs[L.subject.hash],O;for(var M=e.toDer(a.certificateToAsn1(L)).getBytes(),H=0;H<q.length;++H){var Y=e.toDer(a.certificateToAsn1(q[H])).getBytes();M===Y&&(O=q[H],q.splice(H,1))}return q.length===0&&delete i.certs[L.subject.hash],O};function r(L){return B(L),i.certs[L.hash]||null}function B(L){if(!L.hash){var O=n.md.sha1.create();L.attributes=a.RDNAttributesAsArray(y(L),O),L.hash=O.digest().toHex()}}if(c)for(var D=0;D<c.length;++D){var V=c[D];i.addCertificate(V)}return i},a.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},a.verifyCertificateChain=function(c,i,r){typeof r=="function"&&(r={verify:r}),r=r||{},i=i.slice(0);var B=i.slice(0),D=r.validityCheckDate;typeof D>"u"&&(D=new Date);var V=!0,L=null,O=0;do{var q=i.shift(),M=null,H=!1;if(D&&(D<q.validity.notBefore||D>q.validity.notAfter)&&(L={message:"Certificate is not valid yet or has expired.",error:a.certificateError.certificate_expired,notBefore:q.validity.notBefore,notAfter:q.validity.notAfter,now:D}),L===null){if(M=i[0]||c.getIssuer(q),M===null&&q.isIssuer(q)&&(H=!0,M=q),M){var Y=M;n.util.isArray(Y)||(Y=[Y]);for(var W=!1;!W&&Y.length>0;){M=Y.shift();try{W=M.verify(q)}catch{}}W||(L={message:"Certificate signature is invalid.",error:a.certificateError.bad_certificate})}L===null&&(!M||H)&&!c.hasCertificate(q)&&(L={message:"Certificate is not trusted.",error:a.certificateError.unknown_ca})}if(L===null&&M&&!q.isIssuer(M)&&(L={message:"Certificate issuer is invalid.",error:a.certificateError.bad_certificate}),L===null)for(var Z={keyUsage:!0,basicConstraints:!0},ne=0;L===null&&ne<q.extensions.length;++ne){var se=q.extensions[ne];se.critical&&!(se.name in Z)&&(L={message:"Certificate has an unsupported critical extension.",error:a.certificateError.unsupported_certificate})}if(L===null&&(!V||i.length===0&&(!M||H))){var he=q.getExtension("basicConstraints"),ge=q.getExtension("keyUsage");if(ge!==null&&(!ge.keyCertSign||he===null)&&(L={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:a.certificateError.bad_certificate}),L===null&&he!==null&&!he.cA&&(L={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:a.certificateError.bad_certificate}),L===null&&ge!==null&&"pathLenConstraint"in he){var j=O-1;j>he.pathLenConstraint&&(L={message:"Certificate basicConstraints pathLenConstraint violated.",error:a.certificateError.bad_certificate})}}var ue=L===null?!0:L.error,$=r.verify?r.verify(ue,O,B):ue;if($===!0)L=null;else throw ue===!0&&(L={message:"The application rejected the certificate.",error:a.certificateError.bad_certificate}),($||$===0)&&(typeof $=="object"&&!n.util.isArray($)?($.message&&(L.message=$.message),$.error&&(L.error=$.error)):typeof $=="string"&&(L.error=$)),L;V=!1,++O}while(i.length>0);return!0},rr.exports}var Zr;function Ea(){if(Zr)return er.exports;Zr=1;var n=fe();tt(),mt(),pt(),ma(),ga(),Je(),_t(),Ct(),pe(),Sr();var e=n.asn1,a=n.pki,d=er.exports=n.pkcs12=n.pkcs12||{},_={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},S={name:"PFX",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},_,{name:"PFX.macData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},h={name:"SafeBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},t={name:"Attribute",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,capture:"values"}]},g={name:"CertBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:e.Class.UNIVERSAL,type:e.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function l(C,m,s,p){for(var v=[],I=0;I<C.length;I++)for(var R=0;R<C[I].safeBags.length;R++){var c=C[I].safeBags[R];if(!(p!==void 0&&c.type!==p)){if(m===null){v.push(c);continue}c.attributes[m]!==void 0&&c.attributes[m].indexOf(s)>=0&&v.push(c)}}return v}d.pkcs12FromAsn1=function(C,m,s){typeof m=="string"?(s=m,m=!0):m===void 0&&(m=!0);var p={},v=[];if(!e.validate(C,S,p,v)){var I=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw I.errors=I,I}var R={version:p.version.charCodeAt(0),safeContents:[],getBags:function(M){var H={},Y;return"localKeyId"in M?Y=M.localKeyId:"localKeyIdHex"in M&&(Y=n.util.hexToBytes(M.localKeyIdHex)),Y===void 0&&!("friendlyName"in M)&&"bagType"in M&&(H[M.bagType]=l(R.safeContents,null,null,M.bagType)),Y!==void 0&&(H.localKeyId=l(R.safeContents,"localKeyId",Y,M.bagType)),"friendlyName"in M&&(H.friendlyName=l(R.safeContents,"friendlyName",M.friendlyName,M.bagType)),H},getBagsByFriendlyName:function(M,H){return l(R.safeContents,"friendlyName",M,H)},getBagsByLocalKeyId:function(M,H){return l(R.safeContents,"localKeyId",M,H)}};if(p.version.charCodeAt(0)!==3){var I=new Error("PKCS#12 PFX of version other than 3 not supported.");throw I.version=p.version.charCodeAt(0),I}if(e.derToOid(p.contentType)!==a.oids.data){var I=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw I.oid=e.derToOid(p.contentType),I}var c=p.content.value[0];if(c.tagClass!==e.Class.UNIVERSAL||c.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(c=x(c),p.mac){var i=null,r=0,B=e.derToOid(p.macAlgorithm);switch(B){case a.oids.sha1:i=n.md.sha1.create(),r=20;break;case a.oids.sha256:i=n.md.sha256.create(),r=32;break;case a.oids.sha384:i=n.md.sha384.create(),r=48;break;case a.oids.sha512:i=n.md.sha512.create(),r=64;break;case a.oids.md5:i=n.md.md5.create(),r=16;break}if(i===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+B);var D=new n.util.ByteBuffer(p.macSalt),V="macIterations"in p?parseInt(n.util.bytesToHex(p.macIterations),16):1,L=d.generateKey(s,D,3,V,r,i),O=n.hmac.create();O.start(i,L),O.update(c.value);var q=O.getMac();if(q.getBytes()!==p.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return k(R,c.value,m,s),R};function x(C){if(C.composed||C.constructed){for(var m=n.util.createBuffer(),s=0;s<C.value.length;++s)m.putBytes(C.value[s].value);C.composed=C.constructed=!1,C.value=m.getBytes()}return C}function k(C,m,s,p){if(m=e.fromDer(m,s),m.tagClass!==e.Class.UNIVERSAL||m.type!==e.Type.SEQUENCE||m.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var v=0;v<m.value.length;v++){var I=m.value[v],R={},c=[];if(!e.validate(I,_,R,c)){var i=new Error("Cannot read ContentInfo.");throw i.errors=c,i}var r={encrypted:!1},B=null,D=R.content.value[0];switch(e.derToOid(R.contentType)){case a.oids.data:if(D.tagClass!==e.Class.UNIVERSAL||D.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");B=x(D).value;break;case a.oids.encryptedData:B=E(D,p),r.encrypted=!0;break;default:var i=new Error("Unsupported PKCS#12 contentType.");throw i.contentType=e.derToOid(R.contentType),i}r.safeBags=u(B,s,p),C.safeContents.push(r)}}function E(C,m){var s={},p=[];if(!e.validate(C,n.pkcs7.asn1.encryptedDataValidator,s,p)){var v=new Error("Cannot read EncryptedContentInfo.");throw v.errors=p,v}var I=e.derToOid(s.contentType);if(I!==a.oids.data){var v=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw v.oid=I,v}I=e.derToOid(s.encAlgorithm);var R=a.pbe.getCipher(I,s.encParameter,m),c=x(s.encryptedContentAsn1),i=n.util.createBuffer(c.value);if(R.update(i),!R.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return R.output.getBytes()}function u(C,m,s){if(!m&&C.length===0)return[];if(C=e.fromDer(C,m),C.tagClass!==e.Class.UNIVERSAL||C.type!==e.Type.SEQUENCE||C.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var p=[],v=0;v<C.value.length;v++){var I=C.value[v],R={},c=[];if(!e.validate(I,h,R,c)){var i=new Error("Cannot read SafeBag.");throw i.errors=c,i}var r={type:e.derToOid(R.bagId),attributes:y(R.bagAttributes)};p.push(r);var B,D,V=R.bagValue.value[0];switch(r.type){case a.oids.pkcs8ShroudedKeyBag:if(V=a.decryptPrivateKeyInfo(V,s),V===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case a.oids.keyBag:try{r.key=a.privateKeyFromAsn1(V)}catch{r.key=null,r.asn1=V}continue;case a.oids.certBag:B=g,D=function(){if(e.derToOid(R.certId)!==a.oids.x509Certificate){var O=new Error("Unsupported certificate type, only X.509 supported.");throw O.oid=e.derToOid(R.certId),O}var q=e.fromDer(R.cert,m);try{r.cert=a.certificateFromAsn1(q,!0)}catch{r.cert=null,r.asn1=q}};break;default:var i=new Error("Unsupported PKCS#12 SafeBag type.");throw i.oid=r.type,i}if(B!==void 0&&!e.validate(V,B,R,c)){var i=new Error("Cannot read PKCS#12 "+B.name);throw i.errors=c,i}D()}return p}function y(C){var m={};if(C!==void 0)for(var s=0;s<C.length;++s){var p={},v=[];if(!e.validate(C[s],t,p,v)){var I=new Error("Cannot read PKCS#12 BagAttribute.");throw I.errors=v,I}var R=e.derToOid(p.oid);if(a.oids[R]!==void 0){m[a.oids[R]]=[];for(var c=0;c<p.values.length;++c)m[a.oids[R]].push(p.values[c].value)}}return m}return d.toPkcs12Asn1=function(C,m,s,p){p=p||{},p.saltSize=p.saltSize||8,p.count=p.count||2048,p.algorithm=p.algorithm||p.encAlgorithm||"aes128","useMac"in p||(p.useMac=!0),"localKeyId"in p||(p.localKeyId=null),"generateLocalKeyId"in p||(p.generateLocalKeyId=!0);var v=p.localKeyId,I;if(v!==null)v=n.util.hexToBytes(v);else if(p.generateLocalKeyId)if(m){var R=n.util.isArray(m)?m[0]:m;typeof R=="string"&&(R=a.certificateFromPem(R));var c=n.md.sha1.create();c.update(e.toDer(a.certificateToAsn1(R)).getBytes()),v=c.digest().getBytes()}else v=n.random.getBytes(20);var i=[];v!==null&&i.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.localKeyId).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,v)])])),"friendlyName"in p&&i.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.friendlyName).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.BMPSTRING,!1,p.friendlyName)])])),i.length>0&&(I=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,i));var r=[],B=[];m!==null&&(n.util.isArray(m)?B=m:B=[m]);for(var D=[],V=0;V<B.length;++V){m=B[V],typeof m=="string"&&(m=a.certificateFromPem(m));var L=V===0?I:void 0,O=a.certificateToAsn1(m),q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.certBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.x509Certificate).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(O).getBytes())])])]),L]);D.push(q)}if(D.length>0){var M=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,D),H=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(M).getBytes())])]);r.push(H)}var Y=null;if(C!==null){var W=a.wrapRsaPrivateKey(a.privateKeyToAsn1(C));s===null?Y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.keyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[W]),I]):Y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.pkcs8ShroudedKeyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[a.encryptPrivateKeyInfo(W,s,p)]),I]);var Z=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[Y]),ne=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(Z).getBytes())])]);r.push(ne)}var se=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,r),he;if(p.useMac){var c=n.md.sha1.create(),ge=new n.util.ByteBuffer(n.random.getBytes(p.saltSize)),j=p.count,C=d.generateKey(s,ge,3,j,20),ue=n.hmac.create();ue.start(c,C),ue.update(e.toDer(se).getBytes());var $=ue.getMac();he=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.sha1).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,$.getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,ge.getBytes()),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(j).getBytes())])}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(3).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(se).getBytes())])]),he])},d.generateKey=n.pbe.generatePkcs12Key,er.exports}var Jr;function xa(){if(Jr)return Ht.exports;Jr=1;var n=fe();tt(),pt(),ga(),yt(),Er(),Ea(),xr(),_t(),pe(),Sr();var e=n.asn1,a=Ht.exports=n.pki=n.pki||{};return a.pemToDer=function(d){var _=n.pem.decode(d)[0];if(_.procType&&_.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return n.util.createBuffer(_.body)},a.privateKeyFromPem=function(d){var _=n.pem.decode(d)[0];if(_.type!=="PRIVATE KEY"&&_.type!=="RSA PRIVATE KEY"){var S=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw S.headerType=_.type,S}if(_.procType&&_.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var h=e.fromDer(_.body);return a.privateKeyFromAsn1(h)},a.privateKeyToPem=function(d,_){var S={type:"RSA PRIVATE KEY",body:e.toDer(a.privateKeyToAsn1(d)).getBytes()};return n.pem.encode(S,{maxline:_})},a.privateKeyInfoToPem=function(d,_){var S={type:"PRIVATE KEY",body:e.toDer(d).getBytes()};return n.pem.encode(S,{maxline:_})},Ht.exports}var sr,ea;function Sa(){if(ea)return sr;ea=1;var n=fe();tt(),mt(),mr(),yt(),xa(),Je(),Ct(),pe();var e=function(f,w,N,o){var A=n.util.createBuffer(),F=f.length>>1,P=F+(f.length&1),z=f.substr(0,P),ee=f.substr(F,P),ae=n.util.createBuffer(),G=n.hmac.create();N=w+N;var te=Math.ceil(o/16),ie=Math.ceil(o/20);G.start("MD5",z);var ce=n.util.createBuffer();ae.putBytes(N);for(var oe=0;oe<te;++oe)G.start(null,null),G.update(ae.getBytes()),ae.putBuffer(G.digest()),G.start(null,null),G.update(ae.bytes()+N),ce.putBuffer(G.digest());G.start("SHA1",ee);var me=n.util.createBuffer();ae.clear(),ae.putBytes(N);for(var oe=0;oe<ie;++oe)G.start(null,null),G.update(ae.getBytes()),ae.putBuffer(G.digest()),G.start(null,null),G.update(ae.bytes()+N),me.putBuffer(G.digest());return A.putBytes(n.util.xorBytes(ce.getBytes(),me.getBytes(),o)),A},a=function(f,w,N){var o=n.hmac.create();o.start("SHA1",f);var A=n.util.createBuffer();return A.putInt32(w[0]),A.putInt32(w[1]),A.putByte(N.type),A.putByte(N.version.major),A.putByte(N.version.minor),A.putInt16(N.length),A.putBytes(N.fragment.bytes()),o.update(A.getBytes()),o.digest().getBytes()},d=function(f,w,N){var o=!1;try{var A=f.deflate(w.fragment.getBytes());w.fragment=n.util.createBuffer(A),w.length=A.length,o=!0}catch{}return o},_=function(f,w,N){var o=!1;try{var A=f.inflate(w.fragment.getBytes());w.fragment=n.util.createBuffer(A),w.length=A.length,o=!0}catch{}return o},S=function(f,w){var N=0;switch(w){case 1:N=f.getByte();break;case 2:N=f.getInt16();break;case 3:N=f.getInt24();break;case 4:N=f.getInt32();break}return n.util.createBuffer(f.getBytes(N))},h=function(f,w,N){f.putInt(N.length(),w<<3),f.putBuffer(N)},t={};t.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},t.SupportedVersions=[t.Versions.TLS_1_1,t.Versions.TLS_1_0],t.Version=t.SupportedVersions[0],t.MaxFragment=15360,t.ConnectionEnd={server:0,client:1},t.PRFAlgorithm={tls_prf_sha256:0},t.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},t.CipherType={stream:0,block:1,aead:2},t.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},t.CompressionMethod={none:0,deflate:1},t.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},t.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},t.Alert={},t.Alert.Level={warning:1,fatal:2},t.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},t.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},t.CipherSuites={},t.getCipherSuite=function(f){var w=null;for(var N in t.CipherSuites){var o=t.CipherSuites[N];if(o.id[0]===f.charCodeAt(0)&&o.id[1]===f.charCodeAt(1)){w=o;break}}return w},t.handleUnexpected=function(f,w){var N=!f.open&&f.entity===t.ConnectionEnd.client;N||f.error(f,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.unexpected_message}})},t.handleHelloRequest=function(f,w,N){!f.handshaking&&f.handshakes>0&&(t.queue(f,t.createAlert(f,{level:t.Alert.Level.warning,description:t.Alert.Description.no_renegotiation})),t.flush(f)),f.process()},t.parseHelloMessage=function(f,w,N){var o=null,A=f.entity===t.ConnectionEnd.client;if(N<38)f.error(f,{message:A?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});else{var F=w.fragment,P=F.length();if(o={version:{major:F.getByte(),minor:F.getByte()},random:n.util.createBuffer(F.getBytes(32)),session_id:S(F,1),extensions:[]},A?(o.cipher_suite=F.getBytes(2),o.compression_method=F.getByte()):(o.cipher_suites=S(F,2),o.compression_methods=S(F,1)),P=N-(P-F.length()),P>0){for(var z=S(F,2);z.length()>0;)o.extensions.push({type:[z.getByte(),z.getByte()],data:S(z,2)});if(!A)for(var ee=0;ee<o.extensions.length;++ee){var ae=o.extensions[ee];if(ae.type[0]===0&&ae.type[1]===0)for(var G=S(ae.data,2);G.length()>0;){var te=G.getByte();if(te!==0)break;f.session.extensions.server_name.serverNameList.push(S(G,2).getBytes())}}}if(f.session.version&&(o.version.major!==f.session.version.major||o.version.minor!==f.session.version.minor))return f.error(f,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.protocol_version}});if(A)f.session.cipherSuite=t.getCipherSuite(o.cipher_suite);else for(var ie=n.util.createBuffer(o.cipher_suites.bytes());ie.length()>0&&(f.session.cipherSuite=t.getCipherSuite(ie.getBytes(2)),f.session.cipherSuite===null););if(f.session.cipherSuite===null)return f.error(f,{message:"No cipher suites in common.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.handshake_failure},cipherSuite:n.util.bytesToHex(o.cipher_suite)});A?f.session.compressionMethod=o.compression_method:f.session.compressionMethod=t.CompressionMethod.none}return o},t.createSecurityParameters=function(f,w){var N=f.entity===t.ConnectionEnd.client,o=w.random.bytes(),A=N?f.session.sp.client_random:o,F=N?o:t.createRandom().getBytes();f.session.sp={entity:f.entity,prf_algorithm:t.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:f.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:A,server_random:F}},t.handleServerHello=function(f,w,N){var o=t.parseHelloMessage(f,w,N);if(!f.fail){if(o.version.minor<=f.version.minor)f.version.minor=o.version.minor;else return f.error(f,{message:"Incompatible TLS version.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.protocol_version}});f.session.version=f.version;var A=o.session_id.bytes();A.length>0&&A===f.session.id?(f.expect=u,f.session.resuming=!0,f.session.sp.server_random=o.random.bytes()):(f.expect=l,f.session.resuming=!1,t.createSecurityParameters(f,o)),f.session.id=A,f.process()}},t.handleClientHello=function(f,w,N){var o=t.parseHelloMessage(f,w,N);if(!f.fail){var A=o.session_id.bytes(),F=null;if(f.sessionCache&&(F=f.sessionCache.getSession(A),F===null?A="":(F.version.major!==o.version.major||F.version.minor>o.version.minor)&&(F=null,A="")),A.length===0&&(A=n.random.getBytes(32)),f.session.id=A,f.session.clientHelloVersion=o.version,f.session.sp={},F)f.version=f.session.version=F.version,f.session.sp=F.sp;else{for(var P,z=1;z<t.SupportedVersions.length&&(P=t.SupportedVersions[z],!(P.minor<=o.version.minor));++z);f.version={major:P.major,minor:P.minor},f.session.version=f.version}F!==null?(f.expect=R,f.session.resuming=!0,f.session.sp.client_random=o.random.bytes()):(f.expect=f.verifyClient!==!1?p:v,f.session.resuming=!1,t.createSecurityParameters(f,o)),f.open=!0,t.queue(f,t.createRecord(f,{type:t.ContentType.handshake,data:t.createServerHello(f)})),f.session.resuming?(t.queue(f,t.createRecord(f,{type:t.ContentType.change_cipher_spec,data:t.createChangeCipherSpec()})),f.state.pending=t.createConnectionState(f),f.state.current.write=f.state.pending.write,t.queue(f,t.createRecord(f,{type:t.ContentType.handshake,data:t.createFinished(f)}))):(t.queue(f,t.createRecord(f,{type:t.ContentType.handshake,data:t.createCertificate(f)})),f.fail||(t.queue(f,t.createRecord(f,{type:t.ContentType.handshake,data:t.createServerKeyExchange(f)})),f.verifyClient!==!1&&t.queue(f,t.createRecord(f,{type:t.ContentType.handshake,data:t.createCertificateRequest(f)})),t.queue(f,t.createRecord(f,{type:t.ContentType.handshake,data:t.createServerHelloDone(f)})))),t.flush(f),f.process()}},t.handleCertificate=function(f,w,N){if(N<3)return f.error(f,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});var o=w.fragment,A={certificate_list:S(o,3)},F,P,z=[];try{for(;A.certificate_list.length()>0;)F=S(A.certificate_list,3),P=n.asn1.fromDer(F),F=n.pki.certificateFromAsn1(P,!0),z.push(F)}catch(ae){return f.error(f,{message:"Could not parse certificate list.",cause:ae,send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.bad_certificate}})}var ee=f.entity===t.ConnectionEnd.client;(ee||f.verifyClient===!0)&&z.length===0?f.error(f,{message:ee?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}}):z.length===0?f.expect=ee?x:v:(ee?f.session.serverCertificate=z[0]:f.session.clientCertificate=z[0],t.verifyCertificateChain(f,z)&&(f.expect=ee?x:v)),f.process()},t.handleServerKeyExchange=function(f,w,N){if(N>0)return f.error(f,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.unsupported_certificate}});f.expect=k,f.process()},t.handleClientKeyExchange=function(f,w,N){if(N<48)return f.error(f,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.unsupported_certificate}});var o=w.fragment,A={enc_pre_master_secret:S(o,2).getBytes()},F=null;if(f.getPrivateKey)try{F=f.getPrivateKey(f,f.session.serverCertificate),F=n.pki.privateKeyFromPem(F)}catch(ee){f.error(f,{message:"Could not get private key.",cause:ee,send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}})}if(F===null)return f.error(f,{message:"No private key set.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}});try{var P=f.session.sp;P.pre_master_secret=F.decrypt(A.enc_pre_master_secret);var z=f.session.clientHelloVersion;if(z.major!==P.pre_master_secret.charCodeAt(0)||z.minor!==P.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{P.pre_master_secret=n.random.getBytes(48)}f.expect=R,f.session.clientCertificate!==null&&(f.expect=I),f.process()},t.handleCertificateRequest=function(f,w,N){if(N<3)return f.error(f,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});var o=w.fragment,A={certificate_types:S(o,1),certificate_authorities:S(o,2)};f.session.certificateRequest=A,f.expect=E,f.process()},t.handleCertificateVerify=function(f,w,N){if(N<2)return f.error(f,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});var o=w.fragment;o.read-=4;var A=o.bytes();o.read+=4;var F={signature:S(o,2).getBytes()},P=n.util.createBuffer();P.putBuffer(f.session.md5.digest()),P.putBuffer(f.session.sha1.digest()),P=P.getBytes();try{var z=f.session.clientCertificate;if(!z.publicKey.verify(P,F.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");f.session.md5.update(A),f.session.sha1.update(A)}catch{return f.error(f,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.handshake_failure}})}f.expect=R,f.process()},t.handleServerHelloDone=function(f,w,N){if(N>0)return f.error(f,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.record_overflow}});if(f.serverCertificate===null){var o={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.insufficient_security}},A=0,F=f.verify(f,o.alert.description,A,[]);if(F!==!0)return(F||F===0)&&(typeof F=="object"&&!n.util.isArray(F)?(F.message&&(o.message=F.message),F.alert&&(o.alert.description=F.alert)):typeof F=="number"&&(o.alert.description=F)),f.error(f,o)}f.session.certificateRequest!==null&&(w=t.createRecord(f,{type:t.ContentType.handshake,data:t.createCertificate(f)}),t.queue(f,w)),w=t.createRecord(f,{type:t.ContentType.handshake,data:t.createClientKeyExchange(f)}),t.queue(f,w),f.expect=m;var P=function(z,ee){z.session.certificateRequest!==null&&z.session.clientCertificate!==null&&t.queue(z,t.createRecord(z,{type:t.ContentType.handshake,data:t.createCertificateVerify(z,ee)})),t.queue(z,t.createRecord(z,{type:t.ContentType.change_cipher_spec,data:t.createChangeCipherSpec()})),z.state.pending=t.createConnectionState(z),z.state.current.write=z.state.pending.write,t.queue(z,t.createRecord(z,{type:t.ContentType.handshake,data:t.createFinished(z)})),z.expect=u,t.flush(z),z.process()};if(f.session.certificateRequest===null||f.session.clientCertificate===null)return P(f,null);t.getClientSignature(f,P)},t.handleChangeCipherSpec=function(f,w){if(w.fragment.getByte()!==1)return f.error(f,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});var N=f.entity===t.ConnectionEnd.client;(f.session.resuming&&N||!f.session.resuming&&!N)&&(f.state.pending=t.createConnectionState(f)),f.state.current.read=f.state.pending.read,(!f.session.resuming&&N||f.session.resuming&&!N)&&(f.state.pending=null),f.expect=N?y:c,f.process()},t.handleFinished=function(f,w,N){var o=w.fragment;o.read-=4;var A=o.bytes();o.read+=4;var F=w.fragment.getBytes();o=n.util.createBuffer(),o.putBuffer(f.session.md5.digest()),o.putBuffer(f.session.sha1.digest());var P=f.entity===t.ConnectionEnd.client,z=P?"server finished":"client finished",ee=f.session.sp,ae=12,G=e;if(o=G(ee.master_secret,z,o.getBytes(),ae),o.getBytes()!==F)return f.error(f,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.decrypt_error}});f.session.md5.update(A),f.session.sha1.update(A),(f.session.resuming&&P||!f.session.resuming&&!P)&&(t.queue(f,t.createRecord(f,{type:t.ContentType.change_cipher_spec,data:t.createChangeCipherSpec()})),f.state.current.write=f.state.pending.write,f.state.pending=null,t.queue(f,t.createRecord(f,{type:t.ContentType.handshake,data:t.createFinished(f)}))),f.expect=P?C:i,f.handshaking=!1,++f.handshakes,f.peerCertificate=P?f.session.serverCertificate:f.session.clientCertificate,t.flush(f),f.isConnected=!0,f.connected(f),f.process()},t.handleAlert=function(f,w){var N=w.fragment,o={level:N.getByte(),description:N.getByte()},A;switch(o.description){case t.Alert.Description.close_notify:A="Connection closed.";break;case t.Alert.Description.unexpected_message:A="Unexpected message.";break;case t.Alert.Description.bad_record_mac:A="Bad record MAC.";break;case t.Alert.Description.decryption_failed:A="Decryption failed.";break;case t.Alert.Description.record_overflow:A="Record overflow.";break;case t.Alert.Description.decompression_failure:A="Decompression failed.";break;case t.Alert.Description.handshake_failure:A="Handshake failure.";break;case t.Alert.Description.bad_certificate:A="Bad certificate.";break;case t.Alert.Description.unsupported_certificate:A="Unsupported certificate.";break;case t.Alert.Description.certificate_revoked:A="Certificate revoked.";break;case t.Alert.Description.certificate_expired:A="Certificate expired.";break;case t.Alert.Description.certificate_unknown:A="Certificate unknown.";break;case t.Alert.Description.illegal_parameter:A="Illegal parameter.";break;case t.Alert.Description.unknown_ca:A="Unknown certificate authority.";break;case t.Alert.Description.access_denied:A="Access denied.";break;case t.Alert.Description.decode_error:A="Decode error.";break;case t.Alert.Description.decrypt_error:A="Decrypt error.";break;case t.Alert.Description.export_restriction:A="Export restriction.";break;case t.Alert.Description.protocol_version:A="Unsupported protocol version.";break;case t.Alert.Description.insufficient_security:A="Insufficient security.";break;case t.Alert.Description.internal_error:A="Internal error.";break;case t.Alert.Description.user_canceled:A="User canceled.";break;case t.Alert.Description.no_renegotiation:A="Renegotiation not supported.";break;default:A="Unknown error.";break}if(o.description===t.Alert.Description.close_notify)return f.close();f.error(f,{message:A,send:!1,origin:f.entity===t.ConnectionEnd.client?"server":"client",alert:o}),f.process()},t.handleHandshake=function(f,w){var N=w.fragment,o=N.getByte(),A=N.getInt24();if(A>N.length())return f.fragmented=w,w.fragment=n.util.createBuffer(),N.read-=4,f.process();f.fragmented=null,N.read-=4;var F=N.bytes(A+4);N.read+=4,o in he[f.entity][f.expect]?(f.entity===t.ConnectionEnd.server&&!f.open&&!f.fail&&(f.handshaking=!0,f.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:n.md.md5.create(),sha1:n.md.sha1.create()}),o!==t.HandshakeType.hello_request&&o!==t.HandshakeType.certificate_verify&&o!==t.HandshakeType.finished&&(f.session.md5.update(F),f.session.sha1.update(F)),he[f.entity][f.expect][o](f,w,A)):t.handleUnexpected(f,w)},t.handleApplicationData=function(f,w){f.data.putBuffer(w.fragment),f.dataReady(f),f.process()},t.handleHeartbeat=function(f,w){var N=w.fragment,o=N.getByte(),A=N.getInt16(),F=N.getBytes(A);if(o===t.HeartbeatMessageType.heartbeat_request){if(f.handshaking||A>F.length)return f.process();t.queue(f,t.createRecord(f,{type:t.ContentType.heartbeat,data:t.createHeartbeat(t.HeartbeatMessageType.heartbeat_response,F)})),t.flush(f)}else if(o===t.HeartbeatMessageType.heartbeat_response){if(F!==f.expectedHeartbeatPayload)return f.process();f.heartbeatReceived&&f.heartbeatReceived(f,n.util.createBuffer(F))}f.process()};var g=0,l=1,x=2,k=3,E=4,u=5,y=6,C=7,m=8,s=0,p=1,v=2,I=3,R=4,c=5,i=6,r=t.handleUnexpected,B=t.handleChangeCipherSpec,D=t.handleAlert,V=t.handleHandshake,L=t.handleApplicationData,O=t.handleHeartbeat,q=[];q[t.ConnectionEnd.client]=[[r,D,V,r,O],[r,D,V,r,O],[r,D,V,r,O],[r,D,V,r,O],[r,D,V,r,O],[B,D,r,r,O],[r,D,V,r,O],[r,D,V,L,O],[r,D,V,r,O]],q[t.ConnectionEnd.server]=[[r,D,V,r,O],[r,D,V,r,O],[r,D,V,r,O],[r,D,V,r,O],[B,D,r,r,O],[r,D,V,r,O],[r,D,V,L,O],[r,D,V,r,O]];var M=t.handleHelloRequest,H=t.handleServerHello,Y=t.handleCertificate,W=t.handleServerKeyExchange,Z=t.handleCertificateRequest,ne=t.handleServerHelloDone,se=t.handleFinished,he=[];he[t.ConnectionEnd.client]=[[r,r,H,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,Y,W,Z,ne,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,r,W,Z,ne,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,r,r,Z,ne,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,r,r,r,ne,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,se],[M,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r]];var ge=t.handleClientHello,j=t.handleClientKeyExchange,ue=t.handleCertificateVerify;he[t.ConnectionEnd.server]=[[r,ge,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,Y,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,j,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,ue,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,se],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r]],t.generateKeys=function(f,w){var N=e,o=w.client_random+w.server_random;f.session.resuming||(w.master_secret=N(w.pre_master_secret,"master secret",o,48).bytes(),w.pre_master_secret=null),o=w.server_random+w.client_random;var A=2*w.mac_key_length+2*w.enc_key_length,F=f.version.major===t.Versions.TLS_1_0.major&&f.version.minor===t.Versions.TLS_1_0.minor;F&&(A+=2*w.fixed_iv_length);var P=N(w.master_secret,"key expansion",o,A),z={client_write_MAC_key:P.getBytes(w.mac_key_length),server_write_MAC_key:P.getBytes(w.mac_key_length),client_write_key:P.getBytes(w.enc_key_length),server_write_key:P.getBytes(w.enc_key_length)};return F&&(z.client_write_IV=P.getBytes(w.fixed_iv_length),z.server_write_IV=P.getBytes(w.fixed_iv_length)),z},t.createConnectionState=function(f){var w=f.entity===t.ConnectionEnd.client,N=function(){var F={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(P){return!0},compressionState:null,compressFunction:function(P){return!0},updateSequenceNumber:function(){F.sequenceNumber[1]===4294967295?(F.sequenceNumber[1]=0,++F.sequenceNumber[0]):++F.sequenceNumber[1]}};return F},o={read:N(),write:N()};if(o.read.update=function(F,P){return o.read.cipherFunction(P,o.read)?o.read.compressFunction(F,P,o.read)||F.error(F,{message:"Could not decompress record.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.decompression_failure}}):F.error(F,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.bad_record_mac}}),!F.fail},o.write.update=function(F,P){return o.write.compressFunction(F,P,o.write)?o.write.cipherFunction(P,o.write)||F.error(F,{message:"Could not encrypt record.",send:!1,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}}):F.error(F,{message:"Could not compress record.",send:!1,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}}),!F.fail},f.session){var A=f.session.sp;switch(f.session.cipherSuite.initSecurityParameters(A),A.keys=t.generateKeys(f,A),o.read.macKey=w?A.keys.server_write_MAC_key:A.keys.client_write_MAC_key,o.write.macKey=w?A.keys.client_write_MAC_key:A.keys.server_write_MAC_key,f.session.cipherSuite.initConnectionState(o,f,A),A.compression_algorithm){case t.CompressionMethod.none:break;case t.CompressionMethod.deflate:o.read.compressFunction=_,o.write.compressFunction=d;break;default:throw new Error("Unsupported compression algorithm.")}}return o},t.createRandom=function(){var f=new Date,w=+f+f.getTimezoneOffset()*6e4,N=n.util.createBuffer();return N.putInt32(w),N.putBytes(n.random.getBytes(28)),N},t.createRecord=function(f,w){if(!w.data)return null;var N={type:w.type,version:{major:f.version.major,minor:f.version.minor},length:w.data.length(),fragment:w.data};return N},t.createAlert=function(f,w){var N=n.util.createBuffer();return N.putByte(w.level),N.putByte(w.description),t.createRecord(f,{type:t.ContentType.alert,data:N})},t.createClientHello=function(f){f.session.clientHelloVersion={major:f.version.major,minor:f.version.minor};for(var w=n.util.createBuffer(),N=0;N<f.cipherSuites.length;++N){var o=f.cipherSuites[N];w.putByte(o.id[0]),w.putByte(o.id[1])}var A=w.length(),F=n.util.createBuffer();F.putByte(t.CompressionMethod.none);var P=F.length(),z=n.util.createBuffer();if(f.virtualHost){var ee=n.util.createBuffer();ee.putByte(0),ee.putByte(0);var ae=n.util.createBuffer();ae.putByte(0),h(ae,2,n.util.createBuffer(f.virtualHost));var G=n.util.createBuffer();h(G,2,ae),h(ee,2,G),z.putBuffer(ee)}var te=z.length();te>0&&(te+=2);var ie=f.session.id,ce=ie.length+1+2+4+28+2+A+1+P+te,oe=n.util.createBuffer();return oe.putByte(t.HandshakeType.client_hello),oe.putInt24(ce),oe.putByte(f.version.major),oe.putByte(f.version.minor),oe.putBytes(f.session.sp.client_random),h(oe,1,n.util.createBuffer(ie)),h(oe,2,w),h(oe,1,F),te>0&&h(oe,2,z),oe},t.createServerHello=function(f){var w=f.session.id,N=w.length+1+2+4+28+2+1,o=n.util.createBuffer();return o.putByte(t.HandshakeType.server_hello),o.putInt24(N),o.putByte(f.version.major),o.putByte(f.version.minor),o.putBytes(f.session.sp.server_random),h(o,1,n.util.createBuffer(w)),o.putByte(f.session.cipherSuite.id[0]),o.putByte(f.session.cipherSuite.id[1]),o.putByte(f.session.compressionMethod),o},t.createCertificate=function(f){var w=f.entity===t.ConnectionEnd.client,N=null;if(f.getCertificate){var o;w?o=f.session.certificateRequest:o=f.session.extensions.server_name.serverNameList,N=f.getCertificate(f,o)}var A=n.util.createBuffer();if(N!==null)try{n.util.isArray(N)||(N=[N]);for(var F=null,P=0;P<N.length;++P){var z=n.pem.decode(N[P])[0];if(z.type!=="CERTIFICATE"&&z.type!=="X509 CERTIFICATE"&&z.type!=="TRUSTED CERTIFICATE"){var ee=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw ee.headerType=z.type,ee}if(z.procType&&z.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var ae=n.util.createBuffer(z.body);F===null&&(F=n.asn1.fromDer(ae.bytes(),!1));var G=n.util.createBuffer();h(G,3,ae),A.putBuffer(G)}N=n.pki.certificateFromAsn1(F),w?f.session.clientCertificate=N:f.session.serverCertificate=N}catch(ce){return f.error(f,{message:"Could not send certificate list.",cause:ce,send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.bad_certificate}})}var te=3+A.length(),ie=n.util.createBuffer();return ie.putByte(t.HandshakeType.certificate),ie.putInt24(te),h(ie,3,A),ie},t.createClientKeyExchange=function(f){var w=n.util.createBuffer();w.putByte(f.session.clientHelloVersion.major),w.putByte(f.session.clientHelloVersion.minor),w.putBytes(n.random.getBytes(46));var N=f.session.sp;N.pre_master_secret=w.getBytes();var o=f.session.serverCertificate.publicKey;w=o.encrypt(N.pre_master_secret);var A=w.length+2,F=n.util.createBuffer();return F.putByte(t.HandshakeType.client_key_exchange),F.putInt24(A),F.putInt16(w.length),F.putBytes(w),F},t.createServerKeyExchange=function(f){var w=n.util.createBuffer();return w},t.getClientSignature=function(f,w){var N=n.util.createBuffer();N.putBuffer(f.session.md5.digest()),N.putBuffer(f.session.sha1.digest()),N=N.getBytes(),f.getSignature=f.getSignature||function(o,A,F){var P=null;if(o.getPrivateKey)try{P=o.getPrivateKey(o,o.session.clientCertificate),P=n.pki.privateKeyFromPem(P)}catch(z){o.error(o,{message:"Could not get private key.",cause:z,send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}})}P===null?o.error(o,{message:"No private key set.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}}):A=P.sign(A,null),F(o,A)},f.getSignature(f,N,w)},t.createCertificateVerify=function(f,w){var N=w.length+2,o=n.util.createBuffer();return o.putByte(t.HandshakeType.certificate_verify),o.putInt24(N),o.putInt16(w.length),o.putBytes(w),o},t.createCertificateRequest=function(f){var w=n.util.createBuffer();w.putByte(1);var N=n.util.createBuffer();for(var o in f.caStore.certs){var A=f.caStore.certs[o],F=n.pki.distinguishedNameToAsn1(A.subject),P=n.asn1.toDer(F);N.putInt16(P.length()),N.putBuffer(P)}var z=1+w.length()+2+N.length(),ee=n.util.createBuffer();return ee.putByte(t.HandshakeType.certificate_request),ee.putInt24(z),h(ee,1,w),h(ee,2,N),ee},t.createServerHelloDone=function(f){var w=n.util.createBuffer();return w.putByte(t.HandshakeType.server_hello_done),w.putInt24(0),w},t.createChangeCipherSpec=function(){var f=n.util.createBuffer();return f.putByte(1),f},t.createFinished=function(f){var w=n.util.createBuffer();w.putBuffer(f.session.md5.digest()),w.putBuffer(f.session.sha1.digest());var N=f.entity===t.ConnectionEnd.client,o=f.session.sp,A=12,F=e,P=N?"client finished":"server finished";w=F(o.master_secret,P,w.getBytes(),A);var z=n.util.createBuffer();return z.putByte(t.HandshakeType.finished),z.putInt24(w.length()),z.putBuffer(w),z},t.createHeartbeat=function(f,w,N){typeof N>"u"&&(N=w.length);var o=n.util.createBuffer();o.putByte(f),o.putInt16(N),o.putBytes(w);var A=o.length(),F=Math.max(16,A-N-3);return o.putBytes(n.random.getBytes(F)),o},t.queue=function(f,w){if(w&&!(w.fragment.length()===0&&(w.type===t.ContentType.handshake||w.type===t.ContentType.alert||w.type===t.ContentType.change_cipher_spec))){if(w.type===t.ContentType.handshake){var N=w.fragment.bytes();f.session.md5.update(N),f.session.sha1.update(N),N=null}var o;if(w.fragment.length()<=t.MaxFragment)o=[w];else{o=[];for(var A=w.fragment.bytes();A.length>t.MaxFragment;)o.push(t.createRecord(f,{type:w.type,data:n.util.createBuffer(A.slice(0,t.MaxFragment))})),A=A.slice(t.MaxFragment);A.length>0&&o.push(t.createRecord(f,{type:w.type,data:n.util.createBuffer(A)}))}for(var F=0;F<o.length&&!f.fail;++F){var P=o[F],z=f.state.current.write;z.update(f,P)&&f.records.push(P)}}},t.flush=function(f){for(var w=0;w<f.records.length;++w){var N=f.records[w];f.tlsData.putByte(N.type),f.tlsData.putByte(N.version.major),f.tlsData.putByte(N.version.minor),f.tlsData.putInt16(N.fragment.length()),f.tlsData.putBuffer(f.records[w].fragment)}return f.records=[],f.tlsDataReady(f)};var $=function(f){switch(f){case!0:return!0;case n.pki.certificateError.bad_certificate:return t.Alert.Description.bad_certificate;case n.pki.certificateError.unsupported_certificate:return t.Alert.Description.unsupported_certificate;case n.pki.certificateError.certificate_revoked:return t.Alert.Description.certificate_revoked;case n.pki.certificateError.certificate_expired:return t.Alert.Description.certificate_expired;case n.pki.certificateError.certificate_unknown:return t.Alert.Description.certificate_unknown;case n.pki.certificateError.unknown_ca:return t.Alert.Description.unknown_ca;default:return t.Alert.Description.bad_certificate}},qe=function(f){switch(f){case!0:return!0;case t.Alert.Description.bad_certificate:return n.pki.certificateError.bad_certificate;case t.Alert.Description.unsupported_certificate:return n.pki.certificateError.unsupported_certificate;case t.Alert.Description.certificate_revoked:return n.pki.certificateError.certificate_revoked;case t.Alert.Description.certificate_expired:return n.pki.certificateError.certificate_expired;case t.Alert.Description.certificate_unknown:return n.pki.certificateError.certificate_unknown;case t.Alert.Description.unknown_ca:return n.pki.certificateError.unknown_ca;default:return n.pki.certificateError.bad_certificate}};t.verifyCertificateChain=function(f,w){try{var N={};for(var o in f.verifyOptions)N[o]=f.verifyOptions[o];N.verify=function(F,P,z){var ee=$(F),ae=f.verify(f,F,P,z);if(ae!==!0){if(typeof ae=="object"&&!n.util.isArray(ae)){var G=new Error("The application rejected the certificate.");throw G.send=!0,G.alert={level:t.Alert.Level.fatal,description:t.Alert.Description.bad_certificate},ae.message&&(G.message=ae.message),ae.alert&&(G.alert.description=ae.alert),G}ae!==F&&(ae=qe(ae))}return ae},n.pki.verifyCertificateChain(f.caStore,w,N)}catch(F){var A=F;(typeof A!="object"||n.util.isArray(A))&&(A={send:!0,alert:{level:t.Alert.Level.fatal,description:$(F)}}),"send"in A||(A.send=!0),"alert"in A||(A.alert={level:t.Alert.Level.fatal,description:$(A.error)}),f.error(f,A)}return!f.fail},t.createSessionCache=function(f,w){var N=null;if(f&&f.getSession&&f.setSession&&f.order)N=f;else{N={},N.cache=f||{},N.capacity=Math.max(w||100,1),N.order=[];for(var o in f)N.order.length<=w?N.order.push(o):delete f[o];N.getSession=function(A){var F=null,P=null;if(A?P=n.util.bytesToHex(A):N.order.length>0&&(P=N.order[0]),P!==null&&P in N.cache){F=N.cache[P],delete N.cache[P];for(var z in N.order)if(N.order[z]===P){N.order.splice(z,1);break}}return F},N.setSession=function(A,F){if(N.order.length===N.capacity){var P=N.order.shift();delete N.cache[P]}var P=n.util.bytesToHex(A);N.order.push(P),N.cache[P]=F}}return N},t.createConnection=function(f){var w=null;f.caStore?n.util.isArray(f.caStore)?w=n.pki.createCaStore(f.caStore):w=f.caStore:w=n.pki.createCaStore();var N=f.cipherSuites||null;if(N===null){N=[];for(var o in t.CipherSuites)N.push(t.CipherSuites[o])}var A=f.server?t.ConnectionEnd.server:t.ConnectionEnd.client,F=f.sessionCache?t.createSessionCache(f.sessionCache):null,P={version:{major:t.Version.major,minor:t.Version.minor},entity:A,sessionId:f.sessionId,caStore:w,sessionCache:F,cipherSuites:N,connected:f.connected,virtualHost:f.virtualHost||null,verifyClient:f.verifyClient||!1,verify:f.verify||function(G,te,ie,ce){return te},verifyOptions:f.verifyOptions||{},getCertificate:f.getCertificate||null,getPrivateKey:f.getPrivateKey||null,getSignature:f.getSignature||null,input:n.util.createBuffer(),tlsData:n.util.createBuffer(),data:n.util.createBuffer(),tlsDataReady:f.tlsDataReady,dataReady:f.dataReady,heartbeatReceived:f.heartbeatReceived,closed:f.closed,error:function(G,te){te.origin=te.origin||(G.entity===t.ConnectionEnd.client?"client":"server"),te.send&&(t.queue(G,t.createAlert(G,te.alert)),t.flush(G));var ie=te.fatal!==!1;ie&&(G.fail=!0),f.error(G,te),ie&&G.close(!1)},deflate:f.deflate||null,inflate:f.inflate||null};P.reset=function(G){P.version={major:t.Version.major,minor:t.Version.minor},P.record=null,P.session=null,P.peerCertificate=null,P.state={pending:null,current:null},P.expect=P.entity===t.ConnectionEnd.client?g:s,P.fragmented=null,P.records=[],P.open=!1,P.handshakes=0,P.handshaking=!1,P.isConnected=!1,P.fail=!(G||typeof G>"u"),P.input.clear(),P.tlsData.clear(),P.data.clear(),P.state.current=t.createConnectionState(P)},P.reset();var z=function(G,te){var ie=te.type-t.ContentType.change_cipher_spec,ce=q[G.entity][G.expect];ie in ce?ce[ie](G,te):t.handleUnexpected(G,te)},ee=function(G){var te=0,ie=G.input,ce=ie.length();if(ce<5)te=5-ce;else{G.record={type:ie.getByte(),version:{major:ie.getByte(),minor:ie.getByte()},length:ie.getInt16(),fragment:n.util.createBuffer(),ready:!1};var oe=G.record.version.major===G.version.major;oe&&G.session&&G.session.version&&(oe=G.record.version.minor===G.version.minor),oe||G.error(G,{message:"Incompatible TLS version.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.protocol_version}})}return te},ae=function(G){var te=0,ie=G.input,ce=ie.length();if(ce<G.record.length)te=G.record.length-ce;else{G.record.fragment.putBytes(ie.getBytes(G.record.length)),ie.compact();var oe=G.state.current.read;oe.update(G,G.record)&&(G.fragmented!==null&&(G.fragmented.type===G.record.type?(G.fragmented.fragment.putBuffer(G.record.fragment),G.record=G.fragmented):G.error(G,{message:"Invalid fragmented record.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.unexpected_message}})),G.record.ready=!0)}return te};return P.handshake=function(G){if(P.entity!==t.ConnectionEnd.client)P.error(P,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(P.handshaking)P.error(P,{message:"Handshake already in progress.",fatal:!1});else{P.fail&&!P.open&&P.handshakes===0&&(P.fail=!1),P.handshaking=!0,G=G||"";var te=null;G.length>0&&(P.sessionCache&&(te=P.sessionCache.getSession(G)),te===null&&(G="")),G.length===0&&P.sessionCache&&(te=P.sessionCache.getSession(),te!==null&&(G=te.id)),P.session={id:G,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:n.md.md5.create(),sha1:n.md.sha1.create()},te&&(P.version=te.version,P.session.sp=te.sp),P.session.sp.client_random=t.createRandom().getBytes(),P.open=!0,t.queue(P,t.createRecord(P,{type:t.ContentType.handshake,data:t.createClientHello(P)})),t.flush(P)}},P.process=function(G){var te=0;return G&&P.input.putBytes(G),P.fail||(P.record!==null&&P.record.ready&&P.record.fragment.isEmpty()&&(P.record=null),P.record===null&&(te=ee(P)),!P.fail&&P.record!==null&&!P.record.ready&&(te=ae(P)),!P.fail&&P.record!==null&&P.record.ready&&z(P,P.record)),te},P.prepare=function(G){return t.queue(P,t.createRecord(P,{type:t.ContentType.application_data,data:n.util.createBuffer(G)})),t.flush(P)},P.prepareHeartbeatRequest=function(G,te){return G instanceof n.util.ByteBuffer&&(G=G.bytes()),typeof te>"u"&&(te=G.length),P.expectedHeartbeatPayload=G,t.queue(P,t.createRecord(P,{type:t.ContentType.heartbeat,data:t.createHeartbeat(t.HeartbeatMessageType.heartbeat_request,G,te)})),t.flush(P)},P.close=function(G){if(!P.fail&&P.sessionCache&&P.session){var te={id:P.session.id,version:P.session.version,sp:P.session.sp};te.sp.keys=null,P.sessionCache.setSession(te.id,te)}P.open&&(P.open=!1,P.input.clear(),(P.isConnected||P.handshaking)&&(P.isConnected=P.handshaking=!1,t.queue(P,t.createAlert(P,{level:t.Alert.Level.warning,description:t.Alert.Description.close_notify})),t.flush(P)),P.closed(P)),P.reset(G)},P},sr=n.tls=n.tls||{};for(var le in t)typeof t[le]!="function"&&(n.tls[le]=t[le]);return n.tls.prf_tls1=e,n.tls.hmac_sha1=a,n.tls.createSessionCache=t.createSessionCache,n.tls.createConnection=t.createConnection,sr}var ta;function Ya(){if(ta)return Pt.exports;ta=1;var n=fe();ht(),Sa();var e=Pt.exports=n.tls;e.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(g){g.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,g.cipher_type=e.CipherType.block,g.enc_key_length=16,g.block_length=16,g.fixed_iv_length=16,g.record_iv_length=16,g.mac_algorithm=e.MACAlgorithm.hmac_sha1,g.mac_length=20,g.mac_key_length=20},initConnectionState:a},e.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(g){g.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,g.cipher_type=e.CipherType.block,g.enc_key_length=32,g.block_length=16,g.fixed_iv_length=16,g.record_iv_length=16,g.mac_algorithm=e.MACAlgorithm.hmac_sha1,g.mac_length=20,g.mac_key_length=20},initConnectionState:a};function a(g,l,x){var k=l.entity===n.tls.ConnectionEnd.client;g.read.cipherState={init:!1,cipher:n.cipher.createDecipher("AES-CBC",k?x.keys.server_write_key:x.keys.client_write_key),iv:k?x.keys.server_write_IV:x.keys.client_write_IV},g.write.cipherState={init:!1,cipher:n.cipher.createCipher("AES-CBC",k?x.keys.client_write_key:x.keys.server_write_key),iv:k?x.keys.client_write_IV:x.keys.server_write_IV},g.read.cipherFunction=h,g.write.cipherFunction=d,g.read.macLength=g.write.macLength=x.mac_length,g.read.macFunction=g.write.macFunction=e.hmac_sha1}function d(g,l){var x=!1,k=l.macFunction(l.macKey,l.sequenceNumber,g);g.fragment.putBytes(k),l.updateSequenceNumber();var E;g.version.minor===e.Versions.TLS_1_0.minor?E=l.cipherState.init?null:l.cipherState.iv:E=n.random.getBytesSync(16),l.cipherState.init=!0;var u=l.cipherState.cipher;return u.start({iv:E}),g.version.minor>=e.Versions.TLS_1_1.minor&&u.output.putBytes(E),u.update(g.fragment),u.finish(_)&&(g.fragment=u.output,g.length=g.fragment.length(),x=!0),x}function _(g,l,x){if(!x){var k=g-l.length()%g;l.fillWithByte(k-1,k)}return!0}function S(g,l,x){var k=!0;if(x){for(var E=l.length(),u=l.last(),y=E-1-u;y<E-1;++y)k=k&&l.at(y)==u;k&&l.truncate(u+1)}return k}function h(g,l){var x=!1,k;g.version.minor===e.Versions.TLS_1_0.minor?k=l.cipherState.init?null:l.cipherState.iv:k=g.fragment.getBytes(16),l.cipherState.init=!0;var E=l.cipherState.cipher;E.start({iv:k}),E.update(g.fragment),x=E.finish(S);var u=l.macLength,y=n.random.getBytesSync(u),C=E.output.length();C>=u?(g.fragment=E.output.getBytes(C-u),y=E.output.getBytes(u)):g.fragment=E.output.getBytes(),g.fragment=n.util.createBuffer(g.fragment),g.length=g.fragment.length();var m=l.macFunction(l.macKey,l.sequenceNumber,g);return l.updateSequenceNumber(),x=t(l.macKey,y,m)&&x,x}function t(g,l,x){var k=n.hmac.create();return k.start("SHA1",g),k.update(l),l=k.digest().getBytes(),k.start(null,null),k.update(x),x=k.digest().getBytes(),l===x}return Pt.exports}var or={exports:{}},ra;function Ta(){if(ra)return or.exports;ra=1;var n=fe();ot(),pe();var e=or.exports=n.sha512=n.sha512||{};n.md.sha512=n.md.algorithms.sha512=e;var a=n.sha384=n.sha512.sha384=n.sha512.sha384||{};a.create=function(){return e.create("SHA-384")},n.md.sha384=n.md.algorithms.sha384=a,n.sha512.sha256=n.sha512.sha256||{create:function(){return e.create("SHA-512/256")}},n.md["sha512/256"]=n.md.algorithms["sha512/256"]=n.sha512.sha256,n.sha512.sha224=n.sha512.sha224||{create:function(){return e.create("SHA-512/224")}},n.md["sha512/224"]=n.md.algorithms["sha512/224"]=n.sha512.sha224,e.create=function(l){if(_||t(),typeof l>"u"&&(l="SHA-512"),!(l in h))throw new Error("Invalid SHA-512 algorithm: "+l);for(var x=h[l],k=null,E=n.util.createBuffer(),u=new Array(80),y=0;y<80;++y)u[y]=new Array(2);var C=64;switch(l){case"SHA-384":C=48;break;case"SHA-512/256":C=32;break;case"SHA-512/224":C=28;break}var m={algorithm:l.replace("-","").toLowerCase(),blockLength:128,digestLength:C,messageLength:0,fullMessageLength:null,messageLengthSize:16};return m.start=function(){m.messageLength=0,m.fullMessageLength=m.messageLength128=[];for(var s=m.messageLengthSize/4,p=0;p<s;++p)m.fullMessageLength.push(0);E=n.util.createBuffer(),k=new Array(x.length);for(var p=0;p<x.length;++p)k[p]=x[p].slice(0);return m},m.start(),m.update=function(s,p){p==="utf8"&&(s=n.util.encodeUtf8(s));var v=s.length;m.messageLength+=v,v=[v/4294967296>>>0,v>>>0];for(var I=m.fullMessageLength.length-1;I>=0;--I)m.fullMessageLength[I]+=v[1],v[1]=v[0]+(m.fullMessageLength[I]/4294967296>>>0),m.fullMessageLength[I]=m.fullMessageLength[I]>>>0,v[0]=v[1]/4294967296>>>0;return E.putBytes(s),g(k,u,E),(E.read>2048||E.length()===0)&&E.compact(),m},m.digest=function(){var s=n.util.createBuffer();s.putBytes(E.bytes());var p=m.fullMessageLength[m.fullMessageLength.length-1]+m.messageLengthSize,v=p&m.blockLength-1;s.putBytes(d.substr(0,m.blockLength-v));for(var I,R,c=m.fullMessageLength[0]*8,i=0;i<m.fullMessageLength.length-1;++i)I=m.fullMessageLength[i+1]*8,R=I/4294967296>>>0,c+=R,s.putInt32(c>>>0),c=I>>>0;s.putInt32(c);for(var r=new Array(k.length),i=0;i<k.length;++i)r[i]=k[i].slice(0);g(r,u,s);var B=n.util.createBuffer(),D;l==="SHA-512"?D=r.length:l==="SHA-384"?D=r.length-2:D=r.length-4;for(var i=0;i<D;++i)B.putInt32(r[i][0]),(i!==D-1||l!=="SHA-512/224")&&B.putInt32(r[i][1]);return B},m};var d=null,_=!1,S=null,h=null;function t(){d="",d+=n.util.fillString("\0",128),S=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],h={},h["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],h["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],h["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],h["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],_=!0}function g(l,x,k){for(var E,u,y,C,m,s,p,v,I,R,c,i,r,B,D,V,L,O,q,M,H,Y,W,Z,ne,se,he,ge,j,ue,$,qe,le,f,w,N=k.length();N>=128;){for(j=0;j<16;++j)x[j][0]=k.getInt32()>>>0,x[j][1]=k.getInt32()>>>0;for(;j<80;++j)qe=x[j-2],ue=qe[0],$=qe[1],E=((ue>>>19|$<<13)^($>>>29|ue<<3)^ue>>>6)>>>0,u=((ue<<13|$>>>19)^($<<3|ue>>>29)^(ue<<26|$>>>6))>>>0,f=x[j-15],ue=f[0],$=f[1],y=((ue>>>1|$<<31)^(ue>>>8|$<<24)^ue>>>7)>>>0,C=((ue<<31|$>>>1)^(ue<<24|$>>>8)^(ue<<25|$>>>7))>>>0,le=x[j-7],w=x[j-16],$=u+le[1]+C+w[1],x[j][0]=E+le[0]+y+w[0]+($/4294967296>>>0)>>>0,x[j][1]=$>>>0;for(r=l[0][0],B=l[0][1],D=l[1][0],V=l[1][1],L=l[2][0],O=l[2][1],q=l[3][0],M=l[3][1],H=l[4][0],Y=l[4][1],W=l[5][0],Z=l[5][1],ne=l[6][0],se=l[6][1],he=l[7][0],ge=l[7][1],j=0;j<80;++j)p=((H>>>14|Y<<18)^(H>>>18|Y<<14)^(Y>>>9|H<<23))>>>0,v=((H<<18|Y>>>14)^(H<<14|Y>>>18)^(Y<<23|H>>>9))>>>0,I=(ne^H&(W^ne))>>>0,R=(se^Y&(Z^se))>>>0,m=((r>>>28|B<<4)^(B>>>2|r<<30)^(B>>>7|r<<25))>>>0,s=((r<<4|B>>>28)^(B<<30|r>>>2)^(B<<25|r>>>7))>>>0,c=(r&D|L&(r^D))>>>0,i=(B&V|O&(B^V))>>>0,$=ge+v+R+S[j][1]+x[j][1],E=he+p+I+S[j][0]+x[j][0]+($/4294967296>>>0)>>>0,u=$>>>0,$=s+i,y=m+c+($/4294967296>>>0)>>>0,C=$>>>0,he=ne,ge=se,ne=W,se=Z,W=H,Z=Y,$=M+u,H=q+E+($/4294967296>>>0)>>>0,Y=$>>>0,q=L,M=O,L=D,O=V,D=r,V=B,$=u+C,r=E+y+($/4294967296>>>0)>>>0,B=$>>>0;$=l[0][1]+B,l[0][0]=l[0][0]+r+($/4294967296>>>0)>>>0,l[0][1]=$>>>0,$=l[1][1]+V,l[1][0]=l[1][0]+D+($/4294967296>>>0)>>>0,l[1][1]=$>>>0,$=l[2][1]+O,l[2][0]=l[2][0]+L+($/4294967296>>>0)>>>0,l[2][1]=$>>>0,$=l[3][1]+M,l[3][0]=l[3][0]+q+($/4294967296>>>0)>>>0,l[3][1]=$>>>0,$=l[4][1]+Y,l[4][0]=l[4][0]+H+($/4294967296>>>0)>>>0,l[4][1]=$>>>0,$=l[5][1]+Z,l[5][0]=l[5][0]+W+($/4294967296>>>0)>>>0,l[5][1]=$>>>0,$=l[6][1]+se,l[6][0]=l[6][0]+ne+($/4294967296>>>0)>>>0,l[6][1]=$>>>0,$=l[7][1]+ge,l[7][0]=l[7][0]+he+($/4294967296>>>0)>>>0,l[7][1]=$>>>0,N-=128}}return or.exports}var At={},aa;function Xa(){if(aa)return At;aa=1;var n=fe();tt();var e=n.asn1;return At.privateKeyValidator={name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},At.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]},At}var ur,na;function Wa(){if(na)return ur;na=1;var n=fe();bt(),Je(),Ta(),pe();var e=Xa(),a=e.publicKeyValidator,d=e.privateKeyValidator;if(typeof _>"u")var _=n.jsbn.BigInteger;var S=n.util.ByteBuffer,h=typeof Buffer>"u"?Uint8Array:Buffer;n.pki=n.pki||{},ur=n.pki.ed25519=n.ed25519=n.ed25519||{};var t=n.ed25519;t.constants={},t.constants.PUBLIC_KEY_BYTE_LENGTH=32,t.constants.PRIVATE_KEY_BYTE_LENGTH=64,t.constants.SEED_BYTE_LENGTH=32,t.constants.SIGN_BYTE_LENGTH=64,t.constants.HASH_BYTE_LENGTH=64,t.generateKeyPair=function(f){f=f||{};var w=f.seed;if(w===void 0)w=n.random.getBytesSync(t.constants.SEED_BYTE_LENGTH);else if(typeof w=="string"){if(w.length!==t.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+t.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(w instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');w=g({message:w,encoding:"binary"});for(var N=new h(t.constants.PUBLIC_KEY_BYTE_LENGTH),o=new h(t.constants.PRIVATE_KEY_BYTE_LENGTH),A=0;A<32;++A)o[A]=w[A];return p(N,o),{publicKey:N,privateKey:o}},t.privateKeyFromAsn1=function(f){var w={},N=[],o=n.asn1.validate(f,d,w,N);if(!o){var A=new Error("Invalid Key.");throw A.errors=N,A}var F=n.asn1.derToOid(w.privateKeyOid),P=n.oids.EdDSA25519;if(F!==P)throw new Error('Invalid OID "'+F+'"; OID must be "'+P+'".');var z=w.privateKey,ee=g({message:n.asn1.fromDer(z).value,encoding:"binary"});return{privateKeyBytes:ee}},t.publicKeyFromAsn1=function(f){var w={},N=[],o=n.asn1.validate(f,a,w,N);if(!o){var A=new Error("Invalid Key.");throw A.errors=N,A}var F=n.asn1.derToOid(w.publicKeyOid),P=n.oids.EdDSA25519;if(F!==P)throw new Error('Invalid OID "'+F+'"; OID must be "'+P+'".');var z=w.ed25519PublicKey;if(z.length!==t.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return g({message:z,encoding:"binary"})},t.publicKeyFromPrivateKey=function(f){f=f||{};var w=g({message:f.privateKey,encoding:"binary"});if(w.length!==t.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+t.constants.PRIVATE_KEY_BYTE_LENGTH);for(var N=new h(t.constants.PUBLIC_KEY_BYTE_LENGTH),o=0;o<N.length;++o)N[o]=w[32+o];return N},t.sign=function(f){f=f||{};var w=g(f),N=g({message:f.privateKey,encoding:"binary"});if(N.length===t.constants.SEED_BYTE_LENGTH){var o=t.generateKeyPair({seed:N});N=o.privateKey}else if(N.length!==t.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+t.constants.SEED_BYTE_LENGTH+" or "+t.constants.PRIVATE_KEY_BYTE_LENGTH);var A=new h(t.constants.SIGN_BYTE_LENGTH+w.length);v(A,w,w.length,N);for(var F=new h(t.constants.SIGN_BYTE_LENGTH),P=0;P<F.length;++P)F[P]=A[P];return F},t.verify=function(f){f=f||{};var w=g(f);if(f.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var N=g({message:f.signature,encoding:"binary"});if(N.length!==t.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+t.constants.SIGN_BYTE_LENGTH);var o=g({message:f.publicKey,encoding:"binary"});if(o.length!==t.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+t.constants.PUBLIC_KEY_BYTE_LENGTH);var A=new h(t.constants.SIGN_BYTE_LENGTH+w.length),F=new h(t.constants.SIGN_BYTE_LENGTH+w.length),P;for(P=0;P<t.constants.SIGN_BYTE_LENGTH;++P)A[P]=N[P];for(P=0;P<w.length;++P)A[P+t.constants.SIGN_BYTE_LENGTH]=w[P];return I(F,A,A.length,o)>=0};function g(f){var w=f.message;if(w instanceof Uint8Array||w instanceof h)return w;var N=f.encoding;if(w===void 0)if(f.md)w=f.md.digest().getBytes(),N="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof w=="string"&&!N)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof w=="string"){if(typeof Buffer<"u")return Buffer.from(w,N);w=new S(w,N)}else if(!(w instanceof S))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var o=new h(w.length()),A=0;A<o.length;++A)o[A]=w.at(A);return o}var l=j(),x=j([1]),k=j([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),E=j([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),u=j([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),y=j([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),C=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),m=j([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function s(f,w){var N=n.md.sha512.create(),o=new S(f);N.update(o.getBytes(w),"binary");var A=N.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(A,"binary");for(var F=new h(t.constants.HASH_BYTE_LENGTH),P=0;P<64;++P)F[P]=A.charCodeAt(P);return F}function p(f,w){var N=[j(),j(),j(),j()],o,A=s(w,32);for(A[0]&=248,A[31]&=127,A[31]|=64,Z(N,A),B(f,N),o=0;o<32;++o)w[o+32]=f[o];return 0}function v(f,w,N,o){var A,F,P=new Float64Array(64),z=[j(),j(),j(),j()],ee=s(o,32);ee[0]&=248,ee[31]&=127,ee[31]|=64;var ae=N+64;for(A=0;A<N;++A)f[64+A]=w[A];for(A=0;A<32;++A)f[32+A]=ee[32+A];var G=s(f.subarray(32),N+32);for(c(G),Z(z,G),B(f,z),A=32;A<64;++A)f[A]=o[A];var te=s(f,N+64);for(c(te),A=32;A<64;++A)P[A]=0;for(A=0;A<32;++A)P[A]=G[A];for(A=0;A<32;++A)for(F=0;F<32;F++)P[A+F]+=te[A]*ee[F];return R(f.subarray(32),P),ae}function I(f,w,N,o){var A,F,P=new h(32),z=[j(),j(),j(),j()],ee=[j(),j(),j(),j()];if(F=-1,N<64||V(ee,o))return-1;for(A=0;A<N;++A)f[A]=w[A];for(A=0;A<32;++A)f[A+32]=o[A];var ae=s(f,N);if(c(ae),W(z,ee,ae),Z(ee,w.subarray(32)),i(z,ee),B(P,z),N-=64,M(w,0,P,0)){for(A=0;A<N;++A)f[A]=0;return-1}for(A=0;A<N;++A)f[A]=w[A+64];return F=N,F}function R(f,w){var N,o,A,F;for(o=63;o>=32;--o){for(N=0,A=o-32,F=o-12;A<F;++A)w[A]+=N-16*w[o]*C[A-(o-32)],N=w[A]+128>>8,w[A]-=N*256;w[A]+=N,w[o]=0}for(N=0,A=0;A<32;++A)w[A]+=N-(w[31]>>4)*C[A],N=w[A]>>8,w[A]&=255;for(A=0;A<32;++A)w[A]-=N*C[A];for(o=0;o<32;++o)w[o+1]+=w[o]>>8,f[o]=w[o]&255}function c(f){for(var w=new Float64Array(64),N=0;N<64;++N)w[N]=f[N],f[N]=0;R(f,w)}function i(f,w){var N=j(),o=j(),A=j(),F=j(),P=j(),z=j(),ee=j(),ae=j(),G=j();$(N,f[1],f[0]),$(G,w[1],w[0]),le(N,N,G),ue(o,f[0],f[1]),ue(G,w[0],w[1]),le(o,o,G),le(A,f[3],w[3]),le(A,A,E),le(F,f[2],w[2]),ue(F,F,F),$(P,o,N),$(z,F,A),ue(ee,F,A),ue(ae,o,N),le(f[0],P,z),le(f[1],ae,ee),le(f[2],ee,z),le(f[3],P,ae)}function r(f,w,N){for(var o=0;o<4;++o)ge(f[o],w[o],N)}function B(f,w){var N=j(),o=j(),A=j();se(A,w[2]),le(N,w[0],A),le(o,w[1],A),D(f,o),f[31]^=Y(N)<<7}function D(f,w){var N,o,A,F=j(),P=j();for(N=0;N<16;++N)P[N]=w[N];for(he(P),he(P),he(P),o=0;o<2;++o){for(F[0]=P[0]-65517,N=1;N<15;++N)F[N]=P[N]-65535-(F[N-1]>>16&1),F[N-1]&=65535;F[15]=P[15]-32767-(F[14]>>16&1),A=F[15]>>16&1,F[14]&=65535,ge(P,F,1-A)}for(N=0;N<16;N++)f[2*N]=P[N]&255,f[2*N+1]=P[N]>>8}function V(f,w){var N=j(),o=j(),A=j(),F=j(),P=j(),z=j(),ee=j();return ne(f[2],x),L(f[1],w),qe(A,f[1]),le(F,A,k),$(A,A,f[2]),ue(F,f[2],F),qe(P,F),qe(z,P),le(ee,z,P),le(N,ee,A),le(N,N,F),O(N,N),le(N,N,A),le(N,N,F),le(N,N,F),le(f[0],N,F),qe(o,f[0]),le(o,o,F),q(o,A)&&le(f[0],f[0],m),qe(o,f[0]),le(o,o,F),q(o,A)?-1:(Y(f[0])===w[31]>>7&&$(f[0],l,f[0]),le(f[3],f[0],f[1]),0)}function L(f,w){var N;for(N=0;N<16;++N)f[N]=w[2*N]+(w[2*N+1]<<8);f[15]&=32767}function O(f,w){var N=j(),o;for(o=0;o<16;++o)N[o]=w[o];for(o=250;o>=0;--o)qe(N,N),o!==1&&le(N,N,w);for(o=0;o<16;++o)f[o]=N[o]}function q(f,w){var N=new h(32),o=new h(32);return D(N,f),D(o,w),M(N,0,o,0)}function M(f,w,N,o){return H(f,w,N,o,32)}function H(f,w,N,o,A){var F,P=0;for(F=0;F<A;++F)P|=f[w+F]^N[o+F];return(1&P-1>>>8)-1}function Y(f){var w=new h(32);return D(w,f),w[0]&1}function W(f,w,N){var o,A;for(ne(f[0],l),ne(f[1],x),ne(f[2],x),ne(f[3],l),A=255;A>=0;--A)o=N[A/8|0]>>(A&7)&1,r(f,w,o),i(w,f),i(f,f),r(f,w,o)}function Z(f,w){var N=[j(),j(),j(),j()];ne(N[0],u),ne(N[1],y),ne(N[2],x),le(N[3],u,y),W(f,N,w)}function ne(f,w){var N;for(N=0;N<16;N++)f[N]=w[N]|0}function se(f,w){var N=j(),o;for(o=0;o<16;++o)N[o]=w[o];for(o=253;o>=0;--o)qe(N,N),o!==2&&o!==4&&le(N,N,w);for(o=0;o<16;++o)f[o]=N[o]}function he(f){var w,N,o=1;for(w=0;w<16;++w)N=f[w]+o+65535,o=Math.floor(N/65536),f[w]=N-o*65536;f[0]+=o-1+37*(o-1)}function ge(f,w,N){for(var o,A=~(N-1),F=0;F<16;++F)o=A&(f[F]^w[F]),f[F]^=o,w[F]^=o}function j(f){var w,N=new Float64Array(16);if(f)for(w=0;w<f.length;++w)N[w]=f[w];return N}function ue(f,w,N){for(var o=0;o<16;++o)f[o]=w[o]+N[o]}function $(f,w,N){for(var o=0;o<16;++o)f[o]=w[o]-N[o]}function qe(f,w){le(f,w,w)}function le(f,w,N){var o,A,F=0,P=0,z=0,ee=0,ae=0,G=0,te=0,ie=0,ce=0,oe=0,me=0,Se=0,xe=0,Ce=0,ve=0,ye=0,Te=0,Ke=0,Me=0,He=0,Ge=0,Qe=0,Ye=0,We=0,et=0,rt=0,ut=0,ct=0,dt=0,gt=0,Et=0,Ae=N[0],Be=N[1],be=N[2],_e=N[3],Ne=N[4],Re=N[5],we=N[6],Le=N[7],De=N[8],ke=N[9],Ue=N[10],Pe=N[11],Ee=N[12],Ie=N[13],Ve=N[14],Oe=N[15];o=w[0],F+=o*Ae,P+=o*Be,z+=o*be,ee+=o*_e,ae+=o*Ne,G+=o*Re,te+=o*we,ie+=o*Le,ce+=o*De,oe+=o*ke,me+=o*Ue,Se+=o*Pe,xe+=o*Ee,Ce+=o*Ie,ve+=o*Ve,ye+=o*Oe,o=w[1],P+=o*Ae,z+=o*Be,ee+=o*be,ae+=o*_e,G+=o*Ne,te+=o*Re,ie+=o*we,ce+=o*Le,oe+=o*De,me+=o*ke,Se+=o*Ue,xe+=o*Pe,Ce+=o*Ee,ve+=o*Ie,ye+=o*Ve,Te+=o*Oe,o=w[2],z+=o*Ae,ee+=o*Be,ae+=o*be,G+=o*_e,te+=o*Ne,ie+=o*Re,ce+=o*we,oe+=o*Le,me+=o*De,Se+=o*ke,xe+=o*Ue,Ce+=o*Pe,ve+=o*Ee,ye+=o*Ie,Te+=o*Ve,Ke+=o*Oe,o=w[3],ee+=o*Ae,ae+=o*Be,G+=o*be,te+=o*_e,ie+=o*Ne,ce+=o*Re,oe+=o*we,me+=o*Le,Se+=o*De,xe+=o*ke,Ce+=o*Ue,ve+=o*Pe,ye+=o*Ee,Te+=o*Ie,Ke+=o*Ve,Me+=o*Oe,o=w[4],ae+=o*Ae,G+=o*Be,te+=o*be,ie+=o*_e,ce+=o*Ne,oe+=o*Re,me+=o*we,Se+=o*Le,xe+=o*De,Ce+=o*ke,ve+=o*Ue,ye+=o*Pe,Te+=o*Ee,Ke+=o*Ie,Me+=o*Ve,He+=o*Oe,o=w[5],G+=o*Ae,te+=o*Be,ie+=o*be,ce+=o*_e,oe+=o*Ne,me+=o*Re,Se+=o*we,xe+=o*Le,Ce+=o*De,ve+=o*ke,ye+=o*Ue,Te+=o*Pe,Ke+=o*Ee,Me+=o*Ie,He+=o*Ve,Ge+=o*Oe,o=w[6],te+=o*Ae,ie+=o*Be,ce+=o*be,oe+=o*_e,me+=o*Ne,Se+=o*Re,xe+=o*we,Ce+=o*Le,ve+=o*De,ye+=o*ke,Te+=o*Ue,Ke+=o*Pe,Me+=o*Ee,He+=o*Ie,Ge+=o*Ve,Qe+=o*Oe,o=w[7],ie+=o*Ae,ce+=o*Be,oe+=o*be,me+=o*_e,Se+=o*Ne,xe+=o*Re,Ce+=o*we,ve+=o*Le,ye+=o*De,Te+=o*ke,Ke+=o*Ue,Me+=o*Pe,He+=o*Ee,Ge+=o*Ie,Qe+=o*Ve,Ye+=o*Oe,o=w[8],ce+=o*Ae,oe+=o*Be,me+=o*be,Se+=o*_e,xe+=o*Ne,Ce+=o*Re,ve+=o*we,ye+=o*Le,Te+=o*De,Ke+=o*ke,Me+=o*Ue,He+=o*Pe,Ge+=o*Ee,Qe+=o*Ie,Ye+=o*Ve,We+=o*Oe,o=w[9],oe+=o*Ae,me+=o*Be,Se+=o*be,xe+=o*_e,Ce+=o*Ne,ve+=o*Re,ye+=o*we,Te+=o*Le,Ke+=o*De,Me+=o*ke,He+=o*Ue,Ge+=o*Pe,Qe+=o*Ee,Ye+=o*Ie,We+=o*Ve,et+=o*Oe,o=w[10],me+=o*Ae,Se+=o*Be,xe+=o*be,Ce+=o*_e,ve+=o*Ne,ye+=o*Re,Te+=o*we,Ke+=o*Le,Me+=o*De,He+=o*ke,Ge+=o*Ue,Qe+=o*Pe,Ye+=o*Ee,We+=o*Ie,et+=o*Ve,rt+=o*Oe,o=w[11],Se+=o*Ae,xe+=o*Be,Ce+=o*be,ve+=o*_e,ye+=o*Ne,Te+=o*Re,Ke+=o*we,Me+=o*Le,He+=o*De,Ge+=o*ke,Qe+=o*Ue,Ye+=o*Pe,We+=o*Ee,et+=o*Ie,rt+=o*Ve,ut+=o*Oe,o=w[12],xe+=o*Ae,Ce+=o*Be,ve+=o*be,ye+=o*_e,Te+=o*Ne,Ke+=o*Re,Me+=o*we,He+=o*Le,Ge+=o*De,Qe+=o*ke,Ye+=o*Ue,We+=o*Pe,et+=o*Ee,rt+=o*Ie,ut+=o*Ve,ct+=o*Oe,o=w[13],Ce+=o*Ae,ve+=o*Be,ye+=o*be,Te+=o*_e,Ke+=o*Ne,Me+=o*Re,He+=o*we,Ge+=o*Le,Qe+=o*De,Ye+=o*ke,We+=o*Ue,et+=o*Pe,rt+=o*Ee,ut+=o*Ie,ct+=o*Ve,dt+=o*Oe,o=w[14],ve+=o*Ae,ye+=o*Be,Te+=o*be,Ke+=o*_e,Me+=o*Ne,He+=o*Re,Ge+=o*we,Qe+=o*Le,Ye+=o*De,We+=o*ke,et+=o*Ue,rt+=o*Pe,ut+=o*Ee,ct+=o*Ie,dt+=o*Ve,gt+=o*Oe,o=w[15],ye+=o*Ae,Te+=o*Be,Ke+=o*be,Me+=o*_e,He+=o*Ne,Ge+=o*Re,Qe+=o*we,Ye+=o*Le,We+=o*De,et+=o*ke,rt+=o*Ue,ut+=o*Pe,ct+=o*Ee,dt+=o*Ie,gt+=o*Ve,Et+=o*Oe,F+=38*Te,P+=38*Ke,z+=38*Me,ee+=38*He,ae+=38*Ge,G+=38*Qe,te+=38*Ye,ie+=38*We,ce+=38*et,oe+=38*rt,me+=38*ut,Se+=38*ct,xe+=38*dt,Ce+=38*gt,ve+=38*Et,A=1,o=F+A+65535,A=Math.floor(o/65536),F=o-A*65536,o=P+A+65535,A=Math.floor(o/65536),P=o-A*65536,o=z+A+65535,A=Math.floor(o/65536),z=o-A*65536,o=ee+A+65535,A=Math.floor(o/65536),ee=o-A*65536,o=ae+A+65535,A=Math.floor(o/65536),ae=o-A*65536,o=G+A+65535,A=Math.floor(o/65536),G=o-A*65536,o=te+A+65535,A=Math.floor(o/65536),te=o-A*65536,o=ie+A+65535,A=Math.floor(o/65536),ie=o-A*65536,o=ce+A+65535,A=Math.floor(o/65536),ce=o-A*65536,o=oe+A+65535,A=Math.floor(o/65536),oe=o-A*65536,o=me+A+65535,A=Math.floor(o/65536),me=o-A*65536,o=Se+A+65535,A=Math.floor(o/65536),Se=o-A*65536,o=xe+A+65535,A=Math.floor(o/65536),xe=o-A*65536,o=Ce+A+65535,A=Math.floor(o/65536),Ce=o-A*65536,o=ve+A+65535,A=Math.floor(o/65536),ve=o-A*65536,o=ye+A+65535,A=Math.floor(o/65536),ye=o-A*65536,F+=A-1+37*(A-1),A=1,o=F+A+65535,A=Math.floor(o/65536),F=o-A*65536,o=P+A+65535,A=Math.floor(o/65536),P=o-A*65536,o=z+A+65535,A=Math.floor(o/65536),z=o-A*65536,o=ee+A+65535,A=Math.floor(o/65536),ee=o-A*65536,o=ae+A+65535,A=Math.floor(o/65536),ae=o-A*65536,o=G+A+65535,A=Math.floor(o/65536),G=o-A*65536,o=te+A+65535,A=Math.floor(o/65536),te=o-A*65536,o=ie+A+65535,A=Math.floor(o/65536),ie=o-A*65536,o=ce+A+65535,A=Math.floor(o/65536),ce=o-A*65536,o=oe+A+65535,A=Math.floor(o/65536),oe=o-A*65536,o=me+A+65535,A=Math.floor(o/65536),me=o-A*65536,o=Se+A+65535,A=Math.floor(o/65536),Se=o-A*65536,o=xe+A+65535,A=Math.floor(o/65536),xe=o-A*65536,o=Ce+A+65535,A=Math.floor(o/65536),Ce=o-A*65536,o=ve+A+65535,A=Math.floor(o/65536),ve=o-A*65536,o=ye+A+65535,A=Math.floor(o/65536),ye=o-A*65536,F+=A-1+37*(A-1),f[0]=F,f[1]=P,f[2]=z,f[3]=ee,f[4]=ae,f[5]=G,f[6]=te,f[7]=ie,f[8]=ce,f[9]=oe,f[10]=me,f[11]=Se,f[12]=xe,f[13]=Ce,f[14]=ve,f[15]=ye}return ur}var fr,ia;function ja(){if(ia)return fr;ia=1;var n=fe();pe(),Je(),bt(),fr=n.kem=n.kem||{};var e=n.jsbn.BigInteger;n.kem.rsa={},n.kem.rsa.create=function(d,_){_=_||{};var S=_.prng||n.random,h={};return h.encrypt=function(t,g){var l=Math.ceil(t.n.bitLength()/8),x;do x=new e(n.util.bytesToHex(S.getBytesSync(l)),16).mod(t.n);while(x.compareTo(e.ONE)<=0);x=n.util.hexToBytes(x.toString(16));var k=l-x.length;k>0&&(x=n.util.fillString("\0",k)+x);var E=t.encrypt(x,"NONE"),u=d.generate(x,g);return{encapsulation:E,key:u}},h.decrypt=function(t,g,l){var x=t.decrypt(g,"NONE");return d.generate(x,l)},h},n.kem.kdf1=function(d,_){a(this,d,0,_||d.digestLength)},n.kem.kdf2=function(d,_){a(this,d,1,_||d.digestLength)};function a(d,_,S,h){d.generate=function(t,g){for(var l=new n.util.ByteBuffer,x=Math.ceil(g/h)+S,k=new n.util.ByteBuffer,E=S;E<x;++E){k.putInt32(E),_.start(),_.update(t+k.getBytes());var u=_.digest();l.putBytes(u.getBytes(h))}return l.truncate(l.length()-g),l.getBytes()}}return fr}var lr,sa;function $a(){if(sa)return lr;sa=1;var n=fe();pe(),lr=n.log=n.log||{},n.log.levels=["none","error","warning","info","debug","verbose","max"];var e={},a=[],d=null;n.log.LEVEL_LOCKED=2,n.log.NO_LEVEL_CHECK=4,n.log.INTERPOLATE=8;for(var _=0;_<n.log.levels.length;++_){var S=n.log.levels[_];e[S]={index:_,name:S.toUpperCase()}}n.log.logMessage=function(E){for(var u=e[E.level].index,y=0;y<a.length;++y){var C=a[y];if(C.flags&n.log.NO_LEVEL_CHECK)C.f(E);else{var m=e[C.level].index;u<=m&&C.f(C,E)}}},n.log.prepareStandard=function(E){"standard"in E||(E.standard=e[E.level].name+" ["+E.category+"] "+E.message)},n.log.prepareFull=function(E){if(!("full"in E)){var u=[E.message];u=u.concat([]),E.full=n.util.format.apply(this,u)}},n.log.prepareStandardFull=function(E){"standardFull"in E||(n.log.prepareStandard(E),E.standardFull=E.standard)};for(var h=["error","warning","info","debug","verbose"],_=0;_<h.length;++_)(function(u){n.log[u]=function(y,C){var m=Array.prototype.slice.call(arguments).slice(2),s={timestamp:new Date,level:u,category:y,message:C,arguments:m};n.log.logMessage(s)}})(h[_]);if(n.log.makeLogger=function(E){var u={flags:0,f:E};return n.log.setLevel(u,"none"),u},n.log.setLevel=function(E,u){var y=!1;if(E&&!(E.flags&n.log.LEVEL_LOCKED))for(var C=0;C<n.log.levels.length;++C){var m=n.log.levels[C];if(u==m){E.level=u,y=!0;break}}return y},n.log.lock=function(E,u){typeof u>"u"||u?E.flags|=n.log.LEVEL_LOCKED:E.flags&=~n.log.LEVEL_LOCKED},n.log.addLogger=function(E){a.push(E)},typeof console<"u"&&"log"in console){var t;if(console.error&&console.warn&&console.info&&console.debug){var g={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},l=function(E,u){n.log.prepareStandard(u);var y=g[u.level],C=[u.standard];C=C.concat(u.arguments.slice()),y.apply(console,C)};t=n.log.makeLogger(l)}else{var l=function(u,y){n.log.prepareStandardFull(y),console.log(y.standardFull)};t=n.log.makeLogger(l)}n.log.setLevel(t,"debug"),n.log.addLogger(t),d=t}else console={log:function(){}};if(d!==null&&typeof window<"u"&&window.location){var x=new URL(window.location.href).searchParams;if(x.has("console.level")&&n.log.setLevel(d,x.get("console.level").slice(-1)[0]),x.has("console.lock")){var k=x.get("console.lock").slice(-1)[0];k=="true"&&n.log.lock(d)}}return n.log.consoleLogger=d,lr}var cr,oa;function Za(){return oa||(oa=1,cr=ot(),mr(),Ct(),ha(),Ta()),cr}var hr={exports:{}},ua;function Ja(){if(ua)return hr.exports;ua=1;var n=fe();ht(),tt(),Bt(),pt(),yt(),ma(),Je(),pe(),Sr();var e=n.asn1,a=hr.exports=n.pkcs7=n.pkcs7||{};a.messageFromPem=function(u){var y=n.pem.decode(u)[0];if(y.type!=="PKCS7"){var C=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw C.headerType=y.type,C}if(y.procType&&y.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var m=e.fromDer(y.body);return a.messageFromAsn1(m)},a.messageToPem=function(u,y){var C={type:"PKCS7",body:e.toDer(u.toAsn1()).getBytes()};return n.pem.encode(C,{maxline:y})},a.messageFromAsn1=function(u){var y={},C=[];if(!e.validate(u,a.asn1.contentInfoValidator,y,C)){var m=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw m.errors=C,m}var s=e.derToOid(y.contentType),p;switch(s){case n.pki.oids.envelopedData:p=a.createEnvelopedData();break;case n.pki.oids.encryptedData:p=a.createEncryptedData();break;case n.pki.oids.signedData:p=a.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+s+" is not (yet) supported.")}return p.fromAsn1(y.content.value[0]),p},a.createSignedData=function(){var u=null;return u={type:n.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(m){if(k(u,m,a.asn1.signedDataValidator),u.certificates=[],u.crls=[],u.digestAlgorithmIdentifiers=[],u.contentInfo=null,u.signerInfos=[],u.rawCapture.certificates)for(var s=u.rawCapture.certificates.value,p=0;p<s.length;++p)u.certificates.push(n.pki.certificateFromAsn1(s[p]))},toAsn1:function(){u.contentInfo||u.sign();for(var m=[],s=0;s<u.certificates.length;++s)m.push(n.pki.certificateToAsn1(u.certificates[s]));var p=[],v=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,u.digestAlgorithmIdentifiers),u.contentInfo])]);return m.length>0&&v.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,m)),p.length>0&&v.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,p)),v.value[0].value.push(e.create(e.Class.UNIVERSAL,e.Type.SET,!0,u.signerInfos)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.type).getBytes()),v])},addSigner:function(m){var s=m.issuer,p=m.serialNumber;if(m.certificate){var v=m.certificate;typeof v=="string"&&(v=n.pki.certificateFromPem(v)),s=v.issuer.attributes,p=v.serialNumber}var I=m.key;if(!I)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof I=="string"&&(I=n.pki.privateKeyFromPem(I));var R=m.digestAlgorithm||n.pki.oids.sha1;switch(R){case n.pki.oids.sha1:case n.pki.oids.sha256:case n.pki.oids.sha384:case n.pki.oids.sha512:case n.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+R)}var c=m.authenticatedAttributes||[];if(c.length>0){for(var i=!1,r=!1,B=0;B<c.length;++B){var D=c[B];if(!i&&D.type===n.pki.oids.contentType){if(i=!0,r)break;continue}if(!r&&D.type===n.pki.oids.messageDigest){if(r=!0,i)break;continue}}if(!i||!r)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}u.signers.push({key:I,version:1,issuer:s,serialNumber:p,digestAlgorithm:R,signatureAlgorithm:n.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:c,unauthenticatedAttributes:[]})},sign:function(m){if(m=m||{},(typeof u.content!="object"||u.contentInfo===null)&&(u.contentInfo=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.pki.oids.data).getBytes())]),"content"in u)){var s;u.content instanceof n.util.ByteBuffer?s=u.content.bytes():typeof u.content=="string"&&(s=n.util.encodeUtf8(u.content)),m.detached?u.detachedContent=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,s):u.contentInfo.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,s)]))}if(u.signers.length!==0){var p=y();C(p)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(m){typeof m=="string"&&(m=n.pki.certificateFromPem(m)),u.certificates.push(m)},addCertificateRevokationList:function(m){throw new Error("PKCS#7 CRL support not yet implemented.")}},u;function y(){for(var m={},s=0;s<u.signers.length;++s){var p=u.signers[s],v=p.digestAlgorithm;v in m||(m[v]=n.md[n.pki.oids[v]].create()),p.authenticatedAttributes.length===0?p.md=m[v]:p.md=n.md[n.pki.oids[v]].create()}u.digestAlgorithmIdentifiers=[];for(var v in m)u.digestAlgorithmIdentifiers.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(v).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]));return m}function C(m){var s;if(u.detachedContent?s=u.detachedContent:(s=u.contentInfo.value[1],s=s.value[0]),!s)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var p=e.derToOid(u.contentInfo.value[0].value),v=e.toDer(s);v.getByte(),e.getBerValueLength(v),v=v.getBytes();for(var I in m)m[I].start().update(v);for(var R=new Date,c=0;c<u.signers.length;++c){var i=u.signers[c];if(i.authenticatedAttributes.length===0){if(p!==n.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{i.authenticatedAttributesAsn1=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var r=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[]),B=0;B<i.authenticatedAttributes.length;++B){var D=i.authenticatedAttributes[B];D.type===n.pki.oids.messageDigest?D.value=m[i.digestAlgorithm].digest():D.type===n.pki.oids.signingTime&&(D.value||(D.value=R)),r.value.push(l(D)),i.authenticatedAttributesAsn1.value.push(l(D))}v=e.toDer(r).getBytes(),i.md.start().update(v)}i.signature=i.key.sign(i.md,"RSASSA-PKCS1-V1_5")}u.signerInfos=g(u.signers)}},a.createEncryptedData=function(){var u=null;return u={type:n.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(y){k(u,y,a.asn1.encryptedDataValidator)},decrypt:function(y){y!==void 0&&(u.encryptedContent.key=y),E(u)}},u},a.createEnvelopedData=function(){var u=null;return u={type:n.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(y){var C=k(u,y,a.asn1.envelopedDataValidator);u.recipients=S(C.recipientInfos.value)},toAsn1:function(){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.type).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,h(u.recipients)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,x(u.encryptedContent))])])])},findRecipient:function(y){for(var C=y.issuer.attributes,m=0;m<u.recipients.length;++m){var s=u.recipients[m],p=s.issuer;if(s.serialNumber===y.serialNumber&&p.length===C.length){for(var v=!0,I=0;I<C.length;++I)if(p[I].type!==C[I].type||p[I].value!==C[I].value){v=!1;break}if(v)return s}}return null},decrypt:function(y,C){if(u.encryptedContent.key===void 0&&y!==void 0&&C!==void 0)switch(y.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:case n.pki.oids.desCBC:var m=C.decrypt(y.encryptedContent.content);u.encryptedContent.key=n.util.createBuffer(m);break;default:throw new Error("Unsupported asymmetric cipher, OID "+y.encryptedContent.algorithm)}E(u)},addRecipient:function(y){u.recipients.push({version:0,issuer:y.issuer.attributes,serialNumber:y.serialNumber,encryptedContent:{algorithm:n.pki.oids.rsaEncryption,key:y.publicKey}})},encrypt:function(y,C){if(u.encryptedContent.content===void 0){C=C||u.encryptedContent.algorithm,y=y||u.encryptedContent.key;var m,s,p;switch(C){case n.pki.oids["aes128-CBC"]:m=16,s=16,p=n.aes.createEncryptionCipher;break;case n.pki.oids["aes192-CBC"]:m=24,s=16,p=n.aes.createEncryptionCipher;break;case n.pki.oids["aes256-CBC"]:m=32,s=16,p=n.aes.createEncryptionCipher;break;case n.pki.oids["des-EDE3-CBC"]:m=24,s=8,p=n.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+C)}if(y===void 0)y=n.util.createBuffer(n.random.getBytes(m));else if(y.length()!=m)throw new Error("Symmetric key has wrong length; got "+y.length()+" bytes, expected "+m+".");u.encryptedContent.algorithm=C,u.encryptedContent.key=y,u.encryptedContent.parameter=n.util.createBuffer(n.random.getBytes(s));var v=p(y);if(v.start(u.encryptedContent.parameter.copy()),v.update(u.content),!v.finish())throw new Error("Symmetric encryption failed.");u.encryptedContent.content=v.output}for(var I=0;I<u.recipients.length;++I){var R=u.recipients[I];if(R.encryptedContent.content===void 0)switch(R.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:R.encryptedContent.content=R.encryptedContent.key.encrypt(u.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+R.encryptedContent.algorithm)}}}},u};function d(u){var y={},C=[];if(!e.validate(u,a.asn1.recipientInfoValidator,y,C)){var m=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw m.errors=C,m}return{version:y.version.charCodeAt(0),issuer:n.pki.RDNAttributesAsArray(y.issuer),serialNumber:n.util.createBuffer(y.serial).toHex(),encryptedContent:{algorithm:e.derToOid(y.encAlgorithm),parameter:y.encParameter?y.encParameter.value:void 0,content:y.encKey}}}function _(u){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:u.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,n.util.hexToBytes(u.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.encryptedContent.algorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.encryptedContent.content)])}function S(u){for(var y=[],C=0;C<u.length;++C)y.push(d(u[C]));return y}function h(u){for(var y=[],C=0;C<u.length;++C)y.push(_(u[C]));return y}function t(u){var y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:u.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,n.util.hexToBytes(u.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.digestAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])]);if(u.authenticatedAttributesAsn1&&y.value.push(u.authenticatedAttributesAsn1),y.value.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.signatureAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])),y.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.signature)),u.unauthenticatedAttributes.length>0){for(var C=e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[]),m=0;m<u.unauthenticatedAttributes.length;++m){var s=u.unauthenticatedAttributes[m];C.values.push(l(s))}y.value.push(C)}return y}function g(u){for(var y=[],C=0;C<u.length;++C)y.push(t(u[C]));return y}function l(u){var y;if(u.type===n.pki.oids.contentType)y=e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.value).getBytes());else if(u.type===n.pki.oids.messageDigest)y=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.value.bytes());else if(u.type===n.pki.oids.signingTime){var C=new Date("1950-01-01T00:00:00Z"),m=new Date("2050-01-01T00:00:00Z"),s=u.value;if(typeof s=="string"){var p=Date.parse(s);isNaN(p)?s.length===13?s=e.utcTimeToDate(s):s=e.generalizedTimeToDate(s):s=new Date(p)}s>=C&&s<m?y=e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(s)):y=e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(s))}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[y])])}function x(u){return[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.pki.oids.data).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.algorithm).getBytes()),u.parameter?e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.parameter.getBytes()):void 0]),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.content.getBytes())])]}function k(u,y,C){var m={},s=[];if(!e.validate(y,C,m,s)){var p=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw p.errors=p,p}var v=e.derToOid(m.contentType);if(v!==n.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(m.encryptedContent){var I="";if(n.util.isArray(m.encryptedContent))for(var R=0;R<m.encryptedContent.length;++R){if(m.encryptedContent[R].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");I+=m.encryptedContent[R].value}else I=m.encryptedContent;u.encryptedContent={algorithm:e.derToOid(m.encAlgorithm),parameter:n.util.createBuffer(m.encParameter.value),content:n.util.createBuffer(I)}}if(m.content){var I="";if(n.util.isArray(m.content))for(var R=0;R<m.content.length;++R){if(m.content[R].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");I+=m.content[R].value}else I=m.content;u.content=n.util.createBuffer(I)}return u.version=m.version.charCodeAt(0),u.rawCapture=m,m}function E(u){if(u.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(u.content===void 0){var y;switch(u.encryptedContent.algorithm){case n.pki.oids["aes128-CBC"]:case n.pki.oids["aes192-CBC"]:case n.pki.oids["aes256-CBC"]:y=n.aes.createDecryptionCipher(u.encryptedContent.key);break;case n.pki.oids.desCBC:case n.pki.oids["des-EDE3-CBC"]:y=n.des.createDecryptionCipher(u.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+u.encryptedContent.algorithm)}if(y.start(u.encryptedContent.parameter),y.update(u.encryptedContent.content),!y.finish())throw new Error("Symmetric decryption failed.");u.content=y.output}}return hr.exports}var pr={exports:{}},fa;function en(){if(fa)return pr.exports;fa=1;var n=fe();ht(),mt(),mr(),Ct(),pe();var e=pr.exports=n.ssh=n.ssh||{};e.privateKeyToPutty=function(S,h,t){t=t||"",h=h||"";var g="ssh-rsa",l=h===""?"none":"aes256-cbc",x="PuTTY-User-Key-File-2: "+g+`\r
`;x+="Encryption: "+l+`\r
`,x+="Comment: "+t+`\r
`;var k=n.util.createBuffer();d(k,g),a(k,S.e),a(k,S.n);var E=n.util.encode64(k.bytes(),64),u=Math.floor(E.length/66)+1;x+="Public-Lines: "+u+`\r
`,x+=E;var y=n.util.createBuffer();a(y,S.d),a(y,S.p),a(y,S.q),a(y,S.qInv);var C;if(!h)C=n.util.encode64(y.bytes(),64);else{var m=y.length()+16-1;m-=m%16;var s=_(y.bytes());s.truncate(s.length()-m+y.length()),y.putBuffer(s);var p=n.util.createBuffer();p.putBuffer(_("\0\0\0\0",h)),p.putBuffer(_("\0\0\0",h));var v=n.aes.createEncryptionCipher(p.truncate(8),"CBC");v.start(n.util.createBuffer().fillWithByte(0,16)),v.update(y.copy()),v.finish();var I=v.output;I.truncate(16),C=n.util.encode64(I.bytes(),64)}u=Math.floor(C.length/66)+1,x+=`\r
Private-Lines: `+u+`\r
`,x+=C;var R=_("putty-private-key-file-mac-key",h),c=n.util.createBuffer();d(c,g),d(c,l),d(c,t),c.putInt32(k.length()),c.putBuffer(k),c.putInt32(y.length()),c.putBuffer(y);var i=n.hmac.create();return i.start("sha1",R),i.update(c.bytes()),x+=`\r
Private-MAC: `+i.digest().toHex()+`\r
`,x},e.publicKeyToOpenSSH=function(S,h){var t="ssh-rsa";h=h||"";var g=n.util.createBuffer();return d(g,t),a(g,S.e),a(g,S.n),t+" "+n.util.encode64(g.bytes())+" "+h},e.privateKeyToOpenSSH=function(S,h){return h?n.pki.encryptRsaPrivateKey(S,h,{legacy:!0,algorithm:"aes128"}):n.pki.privateKeyToPem(S)},e.getPublicKeyFingerprint=function(S,h){h=h||{};var t=h.md||n.md.md5.create(),g="ssh-rsa",l=n.util.createBuffer();d(l,g),a(l,S.e),a(l,S.n),t.start(),t.update(l.getBytes());var x=t.digest();if(h.encoding==="hex"){var k=x.toHex();return h.delimiter?k.match(/.{2}/g).join(h.delimiter):k}else{if(h.encoding==="binary")return x.getBytes();if(h.encoding)throw new Error('Unknown encoding "'+h.encoding+'".')}return x};function a(S,h){var t=h.toString(16);t[0]>="8"&&(t="00"+t);var g=n.util.hexToBytes(t);S.putInt32(g.length),S.putBytes(g)}function d(S,h){S.putInt32(h.length),S.putString(h)}function _(){for(var S=n.md.sha1.create(),h=arguments.length,t=0;t<h;++t)S.update(arguments[t]);return S.digest()}return pr.exports}var dr,la;function tn(){return la||(la=1,dr=fe(),ht(),Ya(),tt(),gr(),Bt(),Wa(),mt(),ja(),$a(),Za(),Ca(),Er(),yt(),va(),Ea(),Ja(),xa(),ya(),pa(),xr(),Je(),da(),en(),Sa(),pe()),dr}var rn=tn();const vr=qa(rn);let yr=null;const an=async()=>{var n;try{const e=await nt.get(`${it.BASE_URL}${st.FILES.PUBLIC_KEY}`);return yr=e.data,e.data}catch(e){throw console.error("Error fetching public key:",((n=e.response)==null?void 0:n.data)||e.message),e}},lt=async n=>{yr||await an();try{const e=JSON.stringify(n),a=vr.pki.publicKeyFromPem(yr),d=245,_=vr.util.encodeUtf8(e),S=[];for(let h=0;h<_.length;h+=d){const t=_.slice(h,h+d),g=a.encrypt(t,"RSAES-PKCS1-V1_5");S.push(vr.util.encode64(g))}return S.join(".")}catch(e){throw console.error("Encryption error:",e),e}},sn=async n=>{var e;try{const a=await lt(n);return(await nt.post(`${it.BASE_URL}${st.AUTH.REGISTER}`,{payload:a})).data}catch(a){throw((e=a.response)==null?void 0:e.data)||a}},on=async n=>{var e;try{const a=await lt(n);return(await nt.post(`${it.BASE_URL}${st.AUTH.LOGIN}`,{payload:a})).data}catch(a){throw((e=a.response)==null?void 0:e.data)||a}},un=async n=>{var e;try{const a=await lt({email:n});return(await nt.post(`${it.BASE_URL}${st.AUTH.FORGOT_PASSWORD}`,{payload:a})).data}catch(a){throw((e=a.response)==null?void 0:e.data)||a}},fn=async({email:n,baseUrl:e})=>{var a;try{const d=await lt({email:n,baseUrl:e});return(await nt.post(`${it.BASE_URL}${st.AUTH.RESEND_VERIFICATION}`,{payload:d})).data}catch(d){throw((a=d.response)==null?void 0:a.data)||d}},ln=async(n,e)=>{var a;console.log({resetId:n,code:e});try{const d=await lt({resetId:n,code:e});return(await nt.post(`${it.BASE_URL}${st.AUTH.VERIFY_RESET_CODE}`,{payload:d})).data}catch(d){throw((a=d.response)==null?void 0:a.data)||d}},cn=async(n,e)=>{var a;console.log({resetToken:n,newPassword:e});try{const d=await lt({resetToken:n,newPassword:e});return(await nt.post(`${it.BASE_URL}${st.AUTH.RESET_PASSWORD}`,{payload:d})).data}catch(d){throw((a=d.response)==null?void 0:a.data)||d}},hn=async n=>{var e;try{const a=JSON.parse(atob(n.split(".")[1]));console.log({tokenPayload:a});const d={email:a.email,name:a.name,picture:a.picture};console.log({authData:d});const _=await lt({authData:d});return console.log({encryptedData:_}),(await nt.post(`${it.BASE_URL}${st.AUTH.GOOGLE_SIGNUP}`,{payload:n},{headers:{"Content-Type":"application/json",Accept:"application/json"}})).data}catch(a){throw console.error("Google Auth Error:",a),((e=a.response)==null?void 0:e.data)||a}},pn=async n=>{var e;try{const a=JSON.parse(atob(n.split(".")[1]));console.log({tokenPayload:a});const d={email:a.email,name:a.name,picture:a.picture};console.log({authData:d});const _=await lt({authData:d});return console.log({encryptedData:_}),(await nt.post(`${it.BASE_URL}${st.AUTH.GOOGLE_SIGNIN}`,{payload:n},{headers:{"Content-Type":"application/json",Accept:"application/json"}})).data}catch(a){throw console.error("Google Auth Error:",a),((e=a.response)==null?void 0:e.data)||a}};export{an as a,hn as b,cn as c,fn as d,un as f,pn as g,on as l,sn as r,ln as v};
